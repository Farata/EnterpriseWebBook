<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Advanced Introduction to JavaScript</title>
<style>
@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
@import url(http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic);
/* normalize.css v2.1.1 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address styling not present in IE 8/9. */
[hidden] { display: none; }

/* ========================================================================== Base ========================================================================== */
/** 1. Prevent system color scheme's background color being used in Firefox, IE, and Opera. 2. Prevent system color scheme's text color being used in Firefox, IE, and Opera. 3. Set default font family to sans-serif. 4. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { background: #fff; /* 1 */ color: #000; /* 2 */ font-family: sans-serif; /* 3 */ -ms-text-size-adjust: 100%; /* 4 */ -webkit-text-size-adjust: 100%; /* 4 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

a:focus { outline: none; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

/* Grid HTML Classes */
.row { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; }
.row:before, .row:after { content: " "; display: table; }
.row:after { clear: both; }
.row.collapse .column, .row.collapse .columns { position: relative; padding-left: 0; padding-right: 0; float: left; }
.row .row { width: auto; margin-left: -0.9375em; margin-right: -0.9375em; margin-top: 0; margin-bottom: 0; max-width: none; *zoom: 1; }
.row .row:before, .row .row:after { content: " "; display: table; }
.row .row:after { clear: both; }
.row .row.collapse { width: auto; margin: 0; max-width: none; *zoom: 1; }
.row .row.collapse:before, .row .row.collapse:after { content: " "; display: table; }
.row .row.collapse:after { clear: both; }

.column, .columns { position: relative; padding-left: 0.9375em; padding-right: 0.9375em; width: 100%; float: left; }

@media only screen { .column, .columns { position: relative; padding-left: 0.9375em; padding-right: 0.9375em; float: left; }
  .small-1 { position: relative; width: 8.33333%; }
  .small-2 { position: relative; width: 16.66667%; }
  .small-3 { position: relative; width: 25%; }
  .small-4 { position: relative; width: 33.33333%; }
  .small-5 { position: relative; width: 41.66667%; }
  .small-6 { position: relative; width: 50%; }
  .small-7 { position: relative; width: 58.33333%; }
  .small-8 { position: relative; width: 66.66667%; }
  .small-9 { position: relative; width: 75%; }
  .small-10 { position: relative; width: 83.33333%; }
  .small-11 { position: relative; width: 91.66667%; }
  .small-12 { position: relative; width: 100%; }
  .small-offset-0 { position: relative; margin-left: 0%; }
  .small-offset-1 { position: relative; margin-left: 8.33333%; }
  .small-offset-2 { position: relative; margin-left: 16.66667%; }
  .small-offset-3 { position: relative; margin-left: 25%; }
  .small-offset-4 { position: relative; margin-left: 33.33333%; }
  .small-offset-5 { position: relative; margin-left: 41.66667%; }
  .small-offset-6 { position: relative; margin-left: 50%; }
  .small-offset-7 { position: relative; margin-left: 58.33333%; }
  .small-offset-8 { position: relative; margin-left: 66.66667%; }
  .small-offset-9 { position: relative; margin-left: 75%; }
  .small-offset-10 { position: relative; margin-left: 83.33333%; }
  [class*="column"] + [class*="column"]:last-child { float: right; }
  [class*="column"] + [class*="column"].end { float: left; }
  .column.small-centered, .columns.small-centered { position: relative; margin-left: auto; margin-right: auto; float: none !important; } }
/* Styles for screens that are atleast 768px; */
@media only screen and (min-width: 768px) { .large-1 { position: relative; width: 8.33333%; }
  .large-2 { position: relative; width: 16.66667%; }
  .large-3 { position: relative; width: 25%; }
  .large-4 { position: relative; width: 33.33333%; }
  .large-5 { position: relative; width: 41.66667%; }
  .large-6 { position: relative; width: 50%; }
  .large-7 { position: relative; width: 58.33333%; }
  .large-8 { position: relative; width: 66.66667%; }
  .large-9 { position: relative; width: 75%; }
  .large-10 { position: relative; width: 83.33333%; }
  .large-11 { position: relative; width: 91.66667%; }
  .large-12 { position: relative; width: 100%; }
  .row .large-offset-0 { position: relative; margin-left: 0%; }
  .row .large-offset-1 { position: relative; margin-left: 8.33333%; }
  .row .large-offset-2 { position: relative; margin-left: 16.66667%; }
  .row .large-offset-3 { position: relative; margin-left: 25%; }
  .row .large-offset-4 { position: relative; margin-left: 33.33333%; }
  .row .large-offset-5 { position: relative; margin-left: 41.66667%; }
  .row .large-offset-6 { position: relative; margin-left: 50%; }
  .row .large-offset-7 { position: relative; margin-left: 58.33333%; }
  .row .large-offset-8 { position: relative; margin-left: 66.66667%; }
  .row .large-offset-9 { position: relative; margin-left: 75%; }
  .row .large-offset-10 { position: relative; margin-left: 83.33333%; }
  .row .large-offset-11 { position: relative; margin-left: 91.66667%; }
  .push-1 { position: relative; left: 8.33333%; right: auto; }
  .pull-1 { position: relative; right: 8.33333%; left: auto; }
  .push-2 { position: relative; left: 16.66667%; right: auto; }
  .pull-2 { position: relative; right: 16.66667%; left: auto; }
  .push-3 { position: relative; left: 25%; right: auto; }
  .pull-3 { position: relative; right: 25%; left: auto; }
  .push-4 { position: relative; left: 33.33333%; right: auto; }
  .pull-4 { position: relative; right: 33.33333%; left: auto; }
  .push-5 { position: relative; left: 41.66667%; right: auto; }
  .pull-5 { position: relative; right: 41.66667%; left: auto; }
  .push-6 { position: relative; left: 50%; right: auto; }
  .pull-6 { position: relative; right: 50%; left: auto; }
  .push-7 { position: relative; left: 58.33333%; right: auto; }
  .pull-7 { position: relative; right: 58.33333%; left: auto; }
  .push-8 { position: relative; left: 66.66667%; right: auto; }
  .pull-8 { position: relative; right: 66.66667%; left: auto; }
  .push-9 { position: relative; left: 75%; right: auto; }
  .pull-9 { position: relative; right: 75%; left: auto; }
  .push-10 { position: relative; left: 83.33333%; right: auto; }
  .pull-10 { position: relative; right: 83.33333%; left: auto; }
  .push-11 { position: relative; left: 91.66667%; right: auto; }
  .pull-11 { position: relative; right: 91.66667%; left: auto; }
  .column.large-centered, .columns.large-centered { position: relative; margin-left: auto; margin-right: auto; float: none !important; }
  .column.large-uncentered, .columns.large-uncentered { margin-left: 0; margin-right: 0; float: left !important; }
  .column.large-uncentered.opposite, .columns.large-uncentered.opposite { float: right !important; } }
/* Image Thumbnails */
.th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); -webkit-transition: all 200ms ease-out; -moz-transition: all 200ms ease-out; transition: all 200ms ease-out; }
.th:hover, .th:focus { -webkit-box-shadow: 0 0 6px 1px rgba(43, 166, 203, 0.5); box-shadow: 0 0 6px 1px rgba(43, 166, 203, 0.5); }
.th.radius { -webkit-border-radius: 3px; border-radius: 3px; }

a.th { display: inline-block; }

button, .button { border-style: solid; border-width: 1px; cursor: pointer; font-family: inherit; font-weight: bold; line-height: 1; margin: 0 0 1.25em; position: relative; text-decoration: none; text-align: center; display: inline-block; padding-top: 0.75em; padding-right: 1.5em; padding-bottom: 0.8125em; padding-left: 1.5em; font-size: 1em; background-color: #2ba6cb; border-color: #2284a1; color: white; }
button:hover, button:focus, .button:hover, .button:focus { background-color: #2284a1; }
button:hover, button:focus, .button:hover, .button:focus { color: white; }
button.secondary, .button.secondary { background-color: #e9e9e9; border-color: #d0d0d0; color: #333333; }
button.secondary:hover, button.secondary:focus, .button.secondary:hover, .button.secondary:focus { background-color: #d0d0d0; }
button.secondary:hover, button.secondary:focus, .button.secondary:hover, .button.secondary:focus { color: #333333; }
button.success, .button.success { background-color: #5da423; border-color: #457a1a; color: white; }
button.success:hover, button.success:focus, .button.success:hover, .button.success:focus { background-color: #457a1a; }
button.success:hover, button.success:focus, .button.success:hover, .button.success:focus { color: white; }
button.alert, .button.alert { background-color: #c60f13; border-color: #970b0e; color: white; }
button.alert:hover, button.alert:focus, .button.alert:hover, .button.alert:focus { background-color: #970b0e; }
button.alert:hover, button.alert:focus, .button.alert:hover, .button.alert:focus { color: white; }
button.large, .button.large { padding-top: 1em; padding-right: 2em; padding-bottom: 1.0625em; padding-left: 2em; font-size: 1.25em; }
button.small, .button.small { padding-top: 0.5625em; padding-right: 1.125em; padding-bottom: 0.625em; padding-left: 1.125em; font-size: 0.8125em; }
button.tiny, .button.tiny { padding-top: 0.4375em; padding-right: 0.875em; padding-bottom: 0.5em; padding-left: 0.875em; font-size: 0.6875em; }
button.expand, .button.expand { padding-right: 0px; padding-left: 0px; width: 100%; }
button.left-align, .button.left-align { text-align: left; text-indent: 0.75em; }
button.right-align, .button.right-align { text-align: right; padding-right: 0.75em; }
button.disabled, button[disabled], .button.disabled, .button[disabled] { background-color: #2ba6cb; border-color: #2284a1; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { background-color: #2284a1; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { color: white; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { background-color: #2ba6cb; }
button.disabled.secondary, button[disabled].secondary, .button.disabled.secondary, .button[disabled].secondary { background-color: #e9e9e9; border-color: #d0d0d0; color: #333333; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { background-color: #d0d0d0; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { color: #333333; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { background-color: #e9e9e9; }
button.disabled.success, button[disabled].success, .button.disabled.success, .button[disabled].success { background-color: #5da423; border-color: #457a1a; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { background-color: #457a1a; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { color: white; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { background-color: #5da423; }
button.disabled.alert, button[disabled].alert, .button.disabled.alert, .button[disabled].alert { background-color: #c60f13; border-color: #970b0e; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { background-color: #970b0e; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { color: white; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { background-color: #c60f13; }

button, .button { padding-top: 0.8125em; padding-bottom: 0.75em; -webkit-appearance: none; }
button.tiny, .button.tiny { padding-top: 0.5em; padding-bottom: 0.4375em; -webkit-appearance: none; }
button.small, .button.small { padding-top: 0.625em; padding-bottom: 0.5625em; -webkit-appearance: none; }
button.large, .button.large { padding-top: 1.03125em; padding-bottom: 1.03125em; -webkit-appearance: none; }

@media only screen { button, .button { -webkit-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset; box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset; -webkit-transition: background-color 300ms ease-out; -moz-transition: background-color 300ms ease-out; transition: background-color 300ms ease-out; }
  button:active, .button:active { -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2) inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2) inset; }
  button.radius, .button.radius { -webkit-border-radius: 3px; border-radius: 3px; }
  button.round, .button.round { -webkit-border-radius: 1000px; border-radius: 1000px; } }
@media only screen and (min-width: 768px) { button, .button { display: inline-block; } }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #003b6b; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #00579e; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-weight: normal; font-style: normal; color: #7b2d00; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #ff6b15; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #003426; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; }

ul, ol { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #e15200; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #e15200; }

blockquote, blockquote p { line-height: 1.6; color: #333333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: -webkit-linear-gradient(top, #add386, #90b66a); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: white; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #edf2f2; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 3px 2px 1px 2px; white-space: nowrap; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.6; color: black; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

kbd.keyseq { color: #333333; }

kbd:not(.keyseq) { display: inline-block; color: black; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: black; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: #7b2d00; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #333333; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #003b6b; }

@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #7b2d00; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #622400; }

.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #333333; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #aaaaaa; box-shadow: 0 1px 8px #aaaaaa; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #003b6b; margin-top: 0; line-height: 1.6; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock > .content pre, .listingblock > .content pre { background: #eeeeee; border-width: 1px; border-style: dashed; border-color: #666666; -webkit-border-radius: 0; border-radius: 0; padding: 1.25em 1.5625em 1.125em 1.5625em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.72em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.81em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 0.75em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #e15200; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

p.tableblock.header { color: white; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.375em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #004985; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #00579e; color: #004176; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }

body { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-size: 16px; color: #111; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #dddddd; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#appendix_a">Appendix A: Advanced Introduction to JavaScript</a>
<ul class="sectlevel2">
<li><a href="#_javascript-a-brief-history">JavaScript: A Brief History</a></li>
<li><a href="#_javascript-variables">JavaScript Variables</a></li>
<li><a href="#_adding-javascript-to-html">Adding JavaScript to HTML</a></li>
<li><a href="#debugging_javascript">Debugging JavaScript in Web Browsers</a></li>
<li><a href="#_javascript-functions-a-gentle-introduction">JavaScript Functions: A Gentle Introduction</a></li>
<li><a href="#_javascript-objects-a-gentle-introduction">JavaScript Objects: A Gentle Introduction</a>
<ul class="sectlevel3">
<li><a href="#_object-literals">Object Literals</a></li>
<li><a href="#_constructor-functions">Constructor Functions</a></li>
</ul>
</li>
<li><a href="#_debugging-javascript-in-firebug">Debugging JavaScript in Firebug</a></li>
<li><a href="#_prototypal-inheritance">Prototypal Inheritance</a>
<ul class="sectlevel3">
<li><a href="#avoiding_declaration_redundancy">Avoiding Declaration Redundancy</a></li>
<li><a href="#_method-overriding">Method Overriding</a></li>
</ul>
</li>
<li><a href="#scope">Scope, or Who&#8217;s This?</a>
<ul class="sectlevel3">
<li><a href="#call_and_apply">Call and Apply</a></li>
<li><a href="#callbacks">Callbacks</a></li>
<li><a href="#_hoisting">Hoisting</a></li>
<li><a href="#_function-properties">Function Properties</a></li>
</ul>
</li>
<li><a href="#closures">Closures</a>
<ul class="sectlevel3">
<li><a href="#_why-do-we-need-closures">Why Do We Need Closures?</a></li>
</ul>
</li>
<li><a href="#_closures-by-example">Closures by Example</a>
<ul class="sectlevel3">
<li><a href="#_closures-as-callbacks">Closures as Callbacks</a></li>
</ul>
</li>
<li><a href="#_mixins">Mixins</a></li>
<li><a href="#_javascript-in-the-web-browser">JavaScript in the Web Browser</a>
<ul class="sectlevel3">
<li><a href="#_the-document-object-model-dom">The Document Object Model (DOM)</a></li>
<li><a href="#_working-with-the-dom">Working with the DOM</a></li>
<li><a href="#dom_events">DOM Events</a></li>
</ul>
</li>
<li><a href="#_summary">Summary</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="appendix_a"><a class="anchor" href="#appendix_a"></a>Appendix A: Advanced Introduction to JavaScript</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Any application that can be written in JavaScript, will eventually be written in JavaScript.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Atwood's Law
</div>
</div>
<div class="paragraph">
<p>This appendix is dedicated to the JavaScript programming language. Although all chapters of this book show how JavaScript frameworks can greatly minimize the amount of JavaScript code that you need to write manually, you still need to understand the language itself. We assume that you have some programming experience, understand HTML syntax, and are familiar with the general principal of communication between web browsers and web servers. We&#8217;ve included the word <em>advanced</em> in the title of this appendix because of these assumptions. We&#8217;ll begin by covering basics of the language, but then quickly progress to such advanced topics as <em>prototypal inheritance</em>, <em>callbacks</em>, and <em>closures</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you&#8217;re an absolute beginner with web development and have no previous exposure to JavaScript, consider reading one of the fundamental tutorials covering each and every detail of JavaScript. We can recommend <emphasis><ulink url="http://shop.oreilly.com/product/9780596805531.do" role="orm:hideurl">JavaScript: The Definitive Guide</ulink></emphasis>, by David Flanagan (O&#8217;Reilly).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Besides the JavaScript coverage, this appendix  includes a section on the tools (IDEs, debuggers, web inspectors, and more) that will make your development process more productive.</p>
</div>
<div class="sect2">
<h3 id="_javascript-a-brief-history"><a class="anchor" href="#_javascript-a-brief-history"></a>JavaScript: A Brief History</h3>
<div class="paragraph">
<p>The JavaScript programming language was designed in 1995 by Brendan Eich, who was working for Netscape Communications Corporation at the time. His goal was to allow developers to create more interactive web pages. Initially the name of this language was Mocha and then LiveScript. Finally, Netscape agreed with Sun Microsystems, the creator of Java, to rename it to JavaScript.</p>
</div>
<div class="paragraph">
<p>A year later, the language was given to the international standards body Ecma, which formalized the language into <em>ECMAScript standard</em> so that other web browser vendors could create their implementation of this standard. JavaScript is not the only language that was created based on the ECMAScript specification; ActionScript is a good example of another popular dialect of ECMAScript.</p>
</div>
<div class="paragraph">
<p>To learn more about the history of JavaScript from the source, watch Brendan Eich’s presentation
<a href="http://www.youtube.com/watch?v=Rj49rmc01Hs">"JavaScript at 17"</a> at O’Reilly’s conference Fluent 2012.</p>
</div>
<div class="paragraph">
<p>The vast majority of today&#8217;s JavaScript code is being executed by web browsers, but there are JavaScript engines that can execute JavaScript code independently. For example, <a href="http://code.google.com/p/v8/">Google’s V8</a> JavaScript engine implements ECMAScript 5 and is used not only in the Chrome browser, but can run in a standalone mode and can be embedded in any C++ application. Using the same programming language on the client and the server is the main selling point of Node.js, which runs on top of V8. Oracle’s Java Development Kit (JDK) 8 will include the JavaScript engine Nashorn that not only can run on both the server and client computers, but also gives you the capability to embed the fragments of JavaScript into Java programs.</p>
</div>
<div class="paragraph">
<p>In the '90s, JavaScript was considered a second-class language, used mainly for making web pages more attractive. In 2005, the techniques known as Ajax (see <a href="#using_ajax_and_json">[using_ajax_and_json]</a>) made a significant impact in the way web pages were built. With Ajax, the specific content inside a web page could be updated without having to make a full page refresh. For example, Google&#8217;s Gmail inserts just one line at the top of your input box whenever a new email arrives&#8212;&#8203;it doesn&#8217;t usually re-retrieve the entire content of your inbox from the server and definitely doesn&#8217;t re-render the web page.</p>
</div>
<div class="paragraph">
<p>Ajax gave a second birth to JavaScript. But the vendors of web browsers were not eager to implement the latest specifications of ECMAScript. Browsers’ incompatibility and lack of good development tools  prevented JavaScript from becoming the language of choice for web applications. Let’s not forget about the ubiquitous Flash Player&#8212;&#8203;a popular VM supported by all desktop web browsers. Rich Internet applications written in ActionScript were compiled into the byte code and executed by Flash Player on the user’s machine, inside the web browser.</p>
</div>
<div class="paragraph">
<p>If Ajax saved JavaScript, rapid proliferation of tablets and smartphones made it really hot. Today&#8217;s mobile devices come equipped with modern web browsers, and in the mobile world, there is no need to make sure that your web application will work in the four-year-old Internet Explorer 8. Adobe&#8217;s decision to stop supporting Flash Player in mobile web browsers is yet another reason to turn to JavaScript if your web application has to be accessed from smartphones or tablets.</p>
</div>
<div class="paragraph">
<p>ECMAScript, 5th Edition, was published in 2009 and is currently supported by all modern web browsers. If you are interested in discovering whether specific features of ECMAScript 5 are supported by a particular web browser, check the latest version of the <a href="http://kangax.github.com/es5-compat-table/#">ECMAScript 5 compatibility table</a>. At the time of this writing, the snapshot of the Chrome Browser v22 looks like <a href="#FIGaa01">ECMAScript 5 compatibility sample chart</a>.</p>
</div>
<div id="FIGaa01" class="imageblock">
<div class="content">
<img src="images/ewdv_aa01.png" alt="ewdv aa01">
</div>
<div class="title">Figure 1. ECMAScript 5 compatibility sample chart</div>
</div>
<div class="paragraph">
<p>JavaScript became the lowest common denominator available on thousands of different devices. Yes, JavaScript engines are not exactly the same on the thousands of devices that people use to log in to Facebook, but they are pretty close, and using some of the JavaScript frameworks spares you from worrying about their incompatibilities.</p>
</div>
<div class="paragraph">
<p>JavaScript is an interpreted language that arrives on the web browser as text. The JavaScript engine optimizes and compiles the code before its execution. The JavaScript engine is a part of the web browser, which loads and executes the JavaScript code embedded or referenced between the HTML tags <code>&lt;script&gt;</code> and <code>&lt;/script&gt;</code>. JavaScript was originally created for web browsers, which were supposed to display whatever content successfully arrived. What if an image doesn&#8217;t arrive from the server? You’ll see a broken image icon. What if erroneous JavaScript code with syntax errors arrives at the browser? Well, the engine will try to execute whatever code arrives. End users might appreciate the browser&#8217;s forgiveness when at least some content is available, but software developers should be ready to spend more time debugging (in multiple browsers) the errors that could have been caught by compilers in other programming languages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_javascript-variables"><a class="anchor" href="#_javascript-variables"></a>JavaScript Variables</h3>
<div class="paragraph">
<p>JavaScript is a weakly typed language, so developers don’t have the luxury of a strong compiler&#8217;s help that Java or C# developers enjoy.  For those unfamiliar with weakly typed languages, let us  explain. Imagine that if in Java or C#, instead of declaring variables of specific data types, everything was of type <code>Object</code>, and you could assign to it any value&#8212;&#8203;a string, a number, or a custom object <code>Person</code>. This would substantially complicate the ability of the compiler to weed out all possible errors. You don’t need to declare variables in JavaScript; just assign a value, and the JavaScript engine will figure out the proper type during the execution of your code. For example, the variable named <code>girlfriend</code> will have a data type of <code>String</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>girlfriendName="Mary";</pre>
</div>
</div>
<div class="paragraph">
<p>Because we haven’t used the keyword <code>var</code> in front of <code>girlfriend</code>, this variable has global scope, which is a big no-no. Creating your global variables in a web application that often includes multiple libraries from different vendors can easily create situations in which the variable&#8217;s value is accidentally replaced by someone else&#8217;s code. Besides, if the application uses concurrent execution (read about web workers in <a href="#appendix_b">[appendix_b]</a>), using a global variable can lead to race conditions. Soon, you&#8217;ll see how to limit the scope of an application&#8217;s variables to avoid polluting global space.</p>
</div>
<div class="paragraph">
<p>Variables declared with the <code>var</code> keyword inside a function have local scope and are not visible from outside that function. Consider the following function declaration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function addPersonalInfo(){
   var address ="123 Main Street";      // local String variable
   age=25;                              // global Number variable
   var isMarried = true;                // local boolean variable
   isMarried = "don't remember";        // now it's of String type
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The variables <code>address</code> and <code>isMarried</code> are visible only within the function <code>addPersonalInfo()</code>. The variable <code>age</code> becomes global because the keyword <code>var</code> was omitted.</p>
</div>
<div class="paragraph">
<p>The variable <code>isMarried</code> changes its type from <code>Boolean</code> to <code>String</code> during the execution of the preceding script, and the JavaScript engine won&#8217;t complain, assuming that the programmer knows what she’s doing. So be ready for the runtime surprises and allocate a lot more time for testing than with programs written in compiled languages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_adding-javascript-to-html"><a class="anchor" href="#_adding-javascript-to-html"></a>Adding JavaScript to HTML</h3>
<div class="paragraph">
<p>Software developers either directly include the  JavaScript code in the HTML document by placing it between the tags <code>&lt;script&gt;</code> and <code>&lt;/script&gt;</code> or include a reference to the external location of the code (for example, a local filename or a URL) in the <code>src</code> attribute of the <code>&lt;script&gt;</code> tag. We usually place the <code>&lt;script&gt;</code> tags at the end of HTML file. The reason is simple: your JavaScript code might be manipulating HTML elements, and you want them to exist by the time the script runs. The other way to ensure that the code will run only after the web page has loaded is by catching a window&#8217;s <code>load</code> event. (You&#8217;ll see an example later in this appendix, in the section <a href="#dom_events">DOM Events</a>.) Some JavaScript frameworks might have their own approach to dealing with HTML content, and in <a href="#developing_in_ext_js">[developing_in_ext_js]</a>, the main HTML file of the web application written with the Ext JS framework has <code>&lt;script&gt;</code> tags followed by empty <code>&lt;body&gt;</code> tags. But let&#8217;s keep things simple for now.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The code samples for this book are available on <a href="https://github.com/Farata/EnterpriseWebBook_sources">GitHub</a>. The authors of this book use the WebStorm IDE from JetBrains (see <a href="#appendix_c">[appendix_c]</a> for details).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create a new project <em>appendix_a</em> in the WebStorm IDE. Then create a new file called <em>new_file.html</em> and add the following fragment between the <code>&lt;/body&gt;</code> and <code>&lt;/body&gt;</code> tags:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;h1&gt;Hello World&lt;/h1&gt;

&lt;script&gt;
   alert("Hello from JavaScript");
&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In WebStorm, right-click <em>new_file.html</em> in WebStorm, select Open in Browser, and you&#8217;ll see the output shown in <a href="#FIGaa02">MyFirstProject with appendix_a</a> in your web browser.</p>
</div>
<div id="FIGaa02" class="imageblock">
<div class="content">
<img src="images/ewdv_aa02.png" alt="ewdv aa02">
</div>
<div class="title">Figure 2. MyFirstProject with appendix_a</div>
</div>
<div class="paragraph">
<p>Note that the <code>Alert</code> pop-up box is shown on top of the web page that already rendered its HTML component <code>&lt;h1&gt;</code>. Now move the preceding code from the <code>&lt;body&gt;</code> up to the end of the <code>&lt;head&gt;</code> section and reopen <em>new_file.html</em>. This time, the picture is different; the alert box is shown before the HTML rendering is complete (see <a href="#FIGaa03">Running HTML with JavaScript in the &lt;head&gt; section</a>).</p>
</div>
<div id="FIGaa03" class="imageblock">
<div class="content">
<img src="images/ewdv_aa03.png" alt="ewdv aa03">
</div>
<div class="title">Figure 3. Running HTML with JavaScript in the &lt;head&gt; section</div>
</div>
<div class="paragraph">
<p>This code sample doesn&#8217;t cause any malfunctioning of the code, but if our JavaScript needs to manipulate the HTML elements, we&#8217;d run into issues of accessing nonexistent components. Beside this simple <code>Alert</code> box, JavaScript has <code>Confirm</code> and <code>Prompt</code> boxes, which give you the means to ask OK/Cancel types of questions or to request input from the user.</p>
</div>
</div>
<div class="sect2">
<h3 id="debugging_javascript"><a class="anchor" href="#debugging_javascript"></a>Debugging JavaScript in Web Browsers</h3>
<div class="paragraph">
<p>The best way to learn any program is to run it step by step through a debugger. Some people appreciate using debuggers offered by the IDE, but we prefer to debug using great tools offered by the major web browsers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Firefox: Firebug add-on</p>
</li>
<li>
<p>Chrome: Developer Tools</p>
</li>
<li>
<p>Internet Explorer: F12 Developer Tools</p>
</li>
<li>
<p>Safari: the menu Develop</p>
</li>
<li>
<p>Opera: Dragonfly</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;ll be doing most of the debugging either in Firebug or Chrome Developer Tools. Both provide valuable information about your code and are easy to use. To get Firebug, go to <a href="http://www.getfirebug.com">www.getfirebug.com</a> and click the red Install Firebug button and then follow the instructions. In Firefox, open the Firebug panel from the View menu (see <a href="#FIGaa04">The FireBug console</a>).</p>
</div>
<div id="FIGaa04" class="imageblock">
<div class="content">
<img src="images/ewdv_aa04.png" alt="ewdv aa04">
</div>
<div class="title">Figure 4. The FireBug console</div>
</div>
<div class="paragraph">
<p>On the Firebug toolbar, select the Console option, <a href="http://getfirebug.com/enable">enable the console</a>, and then enter <strong>alert("Hello from JavaScript")</strong> after the &gt;&gt;&gt; sign. You&#8217;ll see the Alert box appear. To enter multiline JavaScript code, in the lower-right corner, click the little circle with a caret; Firebug will open a panel on the right, in which you can enter and run your JavaScript code.</p>
</div>
<div class="paragraph">
<p>This was probably the last example for which we used the <code>Alert()</code> pop-up box for debugging purposes. All JavaScript debuggers support <code>console.log()</code> for printing debug information. Consider the following example that illustrates the strict equality operator ===. Yes, it&#8217;s three equal signs in a row. This operator evaluates to true if the values are equal and the data types are the same:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var age=25;

var ageStr="25";

if (age==ageStr){
  console.log("The values of age and ageStr are equal");
}

if (age===ageStr){
 console.log("The values of age and ageStr are strictly equal");
} else{
 console.log ("The values of age and ageStr are not strictly equal");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running this code in the Firebug console produces the output shown in <a href="#FIGaa05">Using console.log() for the debug output</a>.</p>
</div>
<div id="FIGaa05" class="imageblock">
<div class="content">
<img src="images/ewdv_aa05.png" alt="ewdv aa05">
</div>
<div class="title">Figure 5. Using console.log() for the debug output</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also use <code>console.info()</code>, <code>console.debug()</code>, and <code>console.error()</code>; thus, the debuggers might highlight the output with different colors or mark it with different icons.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For more information about debugging JavaScript, refer to the code samples illustrated in Figures <xref linkend="FIGaa06" xrefstyle="select: labelnumber"/> and <xref linkend="FIGaa07" xrefstyle="select: labelnumber"/>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_javascript-functions-a-gentle-introduction"><a class="anchor" href="#_javascript-functions-a-gentle-introduction"></a>JavaScript Functions: A Gentle Introduction</h3>
<div class="paragraph">
<p>JavaScript can be called an <em>object-oriented language</em> because an object can inherit existing functionality from another object, and you can encapsulate the data and restrict the data access. You can&#8217;t do it as simply as in classical object-oriented languages, but it is possible.  Now comes the chicken or the egg dilemma of what should be explained first: the syntax of functions or the creation of objects? Understanding objects is needed for some of the function code samples, and vice versa. We&#8217;ll begin with simple function use cases and then switch to objects as needed.</p>
</div>
<div class="paragraph">
<p>Many readers have experience with object-oriented languages such as Java or C#, in which classes can include <em>methods</em> implementing required functionality. Then, these methods can be invoked with or without instantiation of the objects. If a JavaScript object includes functions, they are called <em>methods</em>. But JavaScript functions don&#8217;t have to belong to an object. You can just declare a function and invoke it, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">//Function declaration
function calcTax (income, dependents){
   var tax;
   // Do stuff here
   return tax;
}

//Function invocation
calcTax(50000, 2);
var myTax = calcTax(50000,2);</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The data types of the function parameters <code>income</code> and <code>dependents</code> are not specified. We can only guess that they are numbers based on their names. If a software developer doesn&#8217;t bother giving meaningful names to function parameters, the code becomes difficult to read.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After the function <code>calcTax()</code> is invoked and complete, the variable <code>myTax</code> will have the value returned by the function.</p>
</div>
<div class="paragraph">
<p>Another important thing to notice is that our function has a name, calcTax. But this is not always the case. In JavaScript, functions can be <em>anonymous</em>. You&#8217;ll see an example of anonymous functions in the function expressions that follow (note the absence of a name after the keyword <code>function</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you see a line of code in which the keyword <code>function</code> is preceded by any other character, this is not a function declaration, but a function expression.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Consider the following variation of the tax calculation sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">//Function expression
var doTax=function (income, dependents){
	//do stuff here
   return tax;
}

//Function invocation
var myTax=doTax(50000,2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this code, the <code>function</code> keyword is used in the expression; we assign the anonymous function to the variable <code>doTax</code>. After this assignment, just the text of the function is assigned to the variable doTax—the anonymous function is not invoked just yet. It&#8217;s important to understand that even though the code of this anonymous function ends with <code>return tax;</code>, actually, the tax calculation and return of its value does not happen until <code>doTax()</code> is invoked. Only then is the function evaluated, and the variable <code>myTax</code> will get whatever value this function returns.</p>
</div>
<div class="paragraph">
<p>Yet another example of a function expression is its placement inside the <em>grouping operator</em>—parentheses, as shown in the next code snippet. As in an arithmetic expressions, this means that the content inside the expression has to be evaluated first and then used in the expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">(function calcTax (income, dependents){
   // Do stuff here
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The outermost parentheses hide its internal code from the outside world, creating a scope or a closed ecosystem in which the function&#8217;s code will operate. Try to add a line invoking this function, after the last line in the preceding code sample&#8212;&#8203;for example, calcTax(50000,2)—and you&#8217;ll get an error: calcTax is not defined. There is a way to expose some of the internal content of such a <em>closure</em>, and you&#8217;ll see how to do it later in this appendix.</p>
</div>
<div class="paragraph">
<p>If you take away the outermost parentheses and the closing semicolon, you&#8217;ll get a function declaration, which is subject to <em>hoisting</em> (we&#8217;ll explain this soon). Function expressions are usually part of a larger expression. For example, if you add parentheses to the end of this expression, you&#8217;ll get a <em>self-invoked</em> function. This extra pair of parentheses will cause the function expression located in the first set of parentheses to be executed right away: </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">(function calcTax (income, dependents){
   // Do stuff here
})();</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The topic of function declaration versus function expressions is one of those fuzzy JavaScript areas that can cause unexpected behavior of your code. Angus Croll published <a href="http://javascriptweblog.wordpress.com/2010/07/06/function-declarations-vs-function-expressions/">a well-written article</a> on this subject.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_javascript-objects-a-gentle-introduction"><a class="anchor" href="#_javascript-objects-a-gentle-introduction"></a>JavaScript Objects: A Gentle Introduction</h3>
<div class="paragraph">
<p><em>JavaScript objects</em> are simply unordered collections of properties. You can assign new properties or delete existing properties from objects during runtime whenever you please. In classical object-oriented languages, there are <em>classes</em> and there are <em>objects</em>. However, JavaScript doesn&#8217;t have classes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The ECMAScript 6 specification will include classes, too, but because it&#8217;s a work in progress, we won&#8217;t consider them as something useful in today&#8217;s world. If you&#8217;d like to experiment with the upcoming features of JavaScript, download the <a href="https://tools.google.com/dlpage/chromesxs">Chrome Canary browser</a>, go to <code>chrome:flags</code>, and then enable experimental JavaScript. Chrome Canary should be installed on the computer of any HTML5 developers. You can use today those features that will be officially released in Chrome  Developer Tools in about three months.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In JavaScript, you can create objects by using one of the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using object literals</p>
</li>
<li>
<p>Using new Object() notation</p>
</li>
<li>
<p>Using Object.create()</p>
</li>
<li>
<p>Using <em>constructor functions</em> and a new operator</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Technically, other APIs can implicitly create objects—for example, JSON.parse()—but let&#8217;s keep things simple.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In JavaScript everything is an object. Think of Object as of a root of the hierarchy of all objects used in your program. All your custom objects are descendants of Object.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_object-literals"><a class="anchor" href="#_object-literals"></a>Object Literals</h4>
<div class="paragraph">
<p>The easiest way to create a JavaScript object is by using <em>object literal notation</em>. The following code sample begins with the creation of an empty object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var t = {}             // create an instance of an empty object</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following line of code creates an object with one property, <code>salary</code>, and assigns the value 50000 to it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var a = {salary: 50000}; // an instance with one property</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, the instance of one more object is created, and the variable <code>person</code> points at it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">// Store the data about Julia Roberts
var person = { lastName: "Roberts",
               firstName: "Julia",
                     age: 42
             };</code></pre>
</div>
</div>
<div class="paragraph">
<p>This object has three properties: <code>lastName</code>, <code>firstName</code>, and <code>age</code>. Note that in object literal notation, the values of these properties are specified with a colon. You can access the properties of this person by using dot notation&#8212;&#8203;for example, <code>person.LastName</code>. But with JavaScript, there is yet another way for you to access object properties, by using square-bracket syntax&#8212;&#8203;for example, <code>person["lastName"]</code>. In the next code sample, you&#8217;ll see that using square brackets is the only way to access the property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript"> var person = {
       "last name": "Roberts",
       firstName: "Julia",
             age: 42};

var herName=person.lastName;          <i class="conum" data-value="1"></i><b>(1)</b>

console.error("Hello " + herName);    <i class="conum" data-value="2"></i><b>(2)</b>

herName=person["last name"];           <i class="conum" data-value="3"></i><b>(3)</b>

person.salutation="Mrs. ";

console.log("Hello "+ person.salutation + person["last name"]); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The object <em>person</em> doesn&#8217;t have a property lastName, but no error is thrown.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This prints "Hello undefined."</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>An alternative way of referring to an object property.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This prints "Hello Mrs. Roberts."</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It&#8217;s a good idea to keep handy a style guide of any programming language, and we know of two such documents for JavaScript. Google has published its version of a JavaScript style guide at <a href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml">http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml</a>. A more detailed Airbnb JavaScript Style Guide is available as a GitHub project at <a href="https://github.com/airbnb/javascript">https://github.com/airbnb/javascript</a>. And the GitHub version of the JavaScript style guide is located at <a href="https://github.com/styleguide/javascript">https://github.com/styleguide/javascript</a>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_nesting-object-literals"><a class="anchor" href="#_nesting-object-literals"></a>Nesting object literals</h5>
<div class="paragraph">
<p>Objects can contain other objects. If a property of an object literal is also an object, you just need to specify the value of this property in an extra pair of curly braces. For example, you can represent the telephone of a person as an object having two properties: the type and the number. The following code snippet stores a work phone as a <em>nested object</em> inside the person&#8217;s object. Run this code in the Firebug console, and it will print "Call Julia at work 212-555-1212."</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var p = { lastName: "Roberts",
                firstName: "Julia",
                age: 42,
                phone:{
                      type: "work",
                      numb: "212-555-1212"
                 }
            };
console.log("Call " + p.firstName + " at " + p.phone.type + " " + p.phone.numb );</code></pre>
</div>
</div>
<div class="paragraph">
<p>What if a person has more then one phone? We can change the name of the property <code>phone</code> to <code>phones</code> and instead store an array of objects. JavaScript arrays are surrounded by square brackets, and they are zero based. The following code snippet will print "Call Julia at home 718-211-8987."</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var p = { lastName: "Roberts",
                firstName: "Julia",
                age: 42,
                phones:[{
                      type: "work",
                      numb: "212-555-1212"
                 },
                 {
                      type: "home",
                      numb: "799-211-8987"

                 }]
            };
console.log("Call " + p.firstName + " at " + p.phones[1].type + " "
                                           + p.phones[1].numb );</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_defining-methods-in-object-literals"><a class="anchor" href="#_defining-methods-in-object-literals"></a>Defining methods in object literals</h5>
<div class="paragraph">
<p>Functions defined inside objects are called <em>methods</em>. Defining methods in object literals is similar to defining properties: provide a method name followed by a colon and the function declaration. The code snippet that follows declares a method <code>makeAppointment()</code> to our object literal. Finally, the line <code>p.makeAppointment();</code> invokes this new method, which will print the message on the console that Steven wants to see Julia and will call at such-and-such number: </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var p = { lastName: "Roberts",
                firstName: "Julia",
                age: 42,
                phones:[{
                      type: "work",
                      numb: "212-555-1212"
                 },
                 {
                      type: "home",
                      numb: "718-211-8987"

                 }],
                makeAppointment: function(){
                    console.log("Steven wants to see  " + this.firstName +
                                 ". He'll call at " + this.phones[0].numb);
                }
            };

p.makeAppointment();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because we already started using arrays, it&#8217;s worth mentioning that arrays can store any objects. You don&#8217;t have to declare the size of the array up front and can create new arrays as easily as <code>var myArray=[]</code> or <code>var myArray=new Array()</code>. You can even store function declarations as regular strings, but they will be evaluated on the array initialization. For example, during the greetArray initialization, the user will see a prompt asking her to enter her name, and, when it&#8217;s done, the greetArray will store two strings. The output of the following code fragment looks like "Hello, Mary":</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var greetArray=[
    "Hello",
    prompt("Enter your name", ”Type your name here")
];

console.log(greetArray.join(","));</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve covered object literals enough so that you can begin using them. <a href="#using_ajax_and_json">[using_ajax_and_json]</a> covers JSON, a popular data format used as replacement for XML in the JavaScript world. You will see that the syntax of JSON and JavaScript object literals are similar. Now we&#8217;ll spend a little bit of time delving into JavaScript functions, and then back to objects again.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constructor-functions"><a class="anchor" href="#_constructor-functions"></a>Constructor Functions</h4>
<div class="paragraph">
<p>JavaScript functions are more than just named pieces of code that implement certain behavior. They also can become objects themselves by the magic of the <code>new</code> operator. To make things even more intriguing, the function calls can have memories, which is explained in the section <a href="#closures">Closures</a>.</p>
</div>
<div class="paragraph">
<p>If a function is meant to be instantiated with the <code>new</code> operator, it&#8217;s called a <em>constructor function</em>. If you are familiar with Java or C#, you understand the concept of a class constructor that is being executed only once during the instantiation of a class. Now imagine that there is only a constructor, without any class declaration that still can be instantiated with the <code>new</code> operator, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function Person(lname, fname, age){
         this.lastName=lname;
         this.firstName=fname;
         this.age=age;
};

// Creating 2 instances of Person
var p1 = new Person(“Roberts”,“Julia”, 42);

var p2 = new Person(“Smith”, “Steven”, 34);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code declares the function <code>Person</code>, and after that, with the help of the <a href="http://mzl.la/1owvKvH">new operator</a>, it creates two instances of the <code>Person</code> object referenced by the variables <code>p1</code> and <code>p2</code>, accordingly.</p>
</div>
<div class="paragraph">
<p>According to common naming conventions, the names of the constructor functions are capitalized.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The JavaScript language doesn&#8217;t support classes, and a constructor function is the closest concept to class in languages such as Java or C#. <a href="#developing_in_ext_js">[developing_in_ext_js]</a> discusses the Ext JS framework that extends JavaScript and introduces constructs similar to classes and classical inheritance.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_adding-methods-and-properties-to-functions"><a class="anchor" href="#_adding-methods-and-properties-to-functions"></a>Adding methods and properties to functions</h5>
<div class="paragraph">
<p>Objects can have methods and properties, right? On the other hand, functions are objects. Hence, functions can have methods and properties, too. If you declare a function <code>marryMe()</code> inside the constructor function <code>Person</code>, <code>marryMe()</code> becomes a method of <code>Person</code>. This is exactly what we&#8217;ll do next. But this time, we&#8217;ll create an HTML file that includes the <code>&lt;script&gt;</code> section, referencing the JavaScript code sample located in a separate file.</p>
</div>
<div class="paragraph">
<p>If you want a hands-on example, create a new file in your Aptana project by choosing File&#8594;New&#8594;File and give it the name <em>marryme.js</em>. When prompted, accept the suggested default JavaScript template and then key in the following content into this file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function Person(lname, fname, age){
         this.lastName=lname;
         this.firstName=fname;
         this.age=age;

         this.marryMe=function(person){
         	console.log("Will you marry me, " + person.firstName);
         };

};

var p1= new Person("Smith", "Steven");
var p2= new Person("Roberts", "Julia");

p1.marryMe(p2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code uses the keyword <code>this</code>, which refers to the object where the code will execute. If you are familiar with the meaning of <code>this</code> in Java or C#, it&#8217;s similar, but not exactly the same, and we&#8217;ll illustrate it in the section <a href="#scope">Scope, or Who&#8217;s This?</a>. The method <code>marryMe()</code> of one <code>Person</code> object takes an instance of another <code>Person</code> object and makes an interesting proposition: "Will you marry me, Julia?"</p>
</div>
<div class="paragraph">
<p>This time we won&#8217;t run this code in the Firebug console but rather will include it in the HTML file.
In WebStorm, create a new HTML file, <em>marryme.html</em>. Modify it to include the JavaScript file <em>marryme.js</em>, as shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

	&lt;body&gt;
		&lt;h1&gt;Making Proposal&lt;/h1&gt;

		&lt;script src="marryme.js"&gt;&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debugging-javascript-in-firebug"><a class="anchor" href="#_debugging-javascript-in-firebug"></a>Debugging JavaScript in Firebug</h3>
<div class="paragraph">
<p>Right-click the file <em>marryme.html</em> and choose Open in Browser. In Firefox, you&#8217;ll see a new web page open called Making Proposals. Open Firebug by using the View menu, refresh the page, and then switch to the Firebug Script tab. A split panel appears; the JavaScript code from <em>marryme.js</em> is on the left, as shown in <a href="#FIGaa06">Firebug&#8217;s Script panel</a>.</p>
</div>
<div id="FIGaa06" class="imageblock">
<div class="content">
<img src="images/ewdv_aa06.png" alt="ewdv aa06">
</div>
<div class="title">Figure 6. Firebug&#8217;s Script panel</div>
</div>
<div class="paragraph">
<p>Let&#8217;s set a breakpoint inside the method <code>marryMe()</code> by clicking in the gray area to the left of line 7. You&#8217;ll see a red circle that will reveal a yellow triangle as soon as your code execution hits this line. Refresh the content of the browser to rerun the script with a breakpoint. This time, the execution stops at line 7, and the right panel contains the runtime information about the objects and variables used by your program (see <a href="#FIGaa07">Firebug&#8217;s Script panel at a breakpoint</a>).</p>
</div>
<div id="FIGaa07" class="imageblock">
<div class="content">
<img src="images/ewdv_aa07.png" alt="ewdv aa07">
</div>
<div class="title">Figure 7. Firebug&#8217;s Script panel at a breakpoint</div>
</div>
<div class="paragraph">
<p>At the top of the left panel, you&#8217;ll see standard  debugger buttons with curved arrows (Step Into, Step Over, Step Out) as well as a triangular button to continue code execution. The right panel depicts the information related to <code>this</code> and global <code>Window</code> objects. In <a href="#FIGaa07">Firebug&#8217;s Script panel at a breakpoint</a>, <code>this</code> represents the instance of the Person object represented by the variable p1 (Steven Smith). To see the content of the object received by the method <code>marryMe()</code> you can add a watch variable by clicking the text "New watch expression&#8230;&#8203;" and entering person—the name of the parameter of <code>marryMe()</code>. <a href="#FIGaa08">Watching the person variable in the debugger</a> shows the watch variable <code>person</code> (Julia Roberts) that was used during the invocation of the method <code>marryMe()</code>.</p>
</div>
<div id="FIGaa08" class="imageblock">
<div class="content">
<img src="images/ewdv_aa08.png" alt="ewdv aa08">
</div>
<div class="title">Figure 8. Watching the person variable in the debugger</div>
</div>
<div class="paragraph">
<p>Now click Firebug&#8217;s Net panel, which shows what goes over the network during communication between the web browser and web server. <a href="#FIGaa09">Firebug&#8217;s Net panel</a> shows a screenshot of the Net panel, in which we clicked the Headers tab for <em>marryme.html</em> and the Response tab of <em>marryme.js</em>. The code 200 for both files means that they arrived successfully to the browser. It also shows the IP address of the web server they came from, their sizes, and plenty of other useful information. Both the Script and Net panels of Firebug, or any other developers tools, are the best friends of any web developer.</p>
</div>
<div id="FIGaa09" class="imageblock">
<div class="content">
<img src="images/ewdv_aa09.png" alt="ewdv aa09">
</div>
<div class="title">Figure 9. Firebug&#8217;s Net panel</div>
</div>
<div class="paragraph">
<p>We like Firebug, but testing and debugging should be done in several web browsers. Besides Firebug, we&#8217;ll be using the excellent Google Chrome Developer Tools. Its menus and panels are similar, and we won&#8217;t be including minitutorials on using such tools; you can easily learn them on your own.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can find a tutorial on using Google Chrome Developer Tools at <a href="https://developers.google.com/chrome-developer-tools/">https://developers.google.com/chrome-developer-tools/</a>. The cheatsheet for Chrome Developer Tools is located at <a href="http://anti-code.com/devtools-cheatsheet/">http://anti-code.com/devtools-cheatsheet/</a>. Finally, Google offers an online video course titled <a href="http://discover-devtools.codeschool.com/">"Explore and Master Chrome DevTools."</a>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Notes on Arrays</div>
<div class="paragraph">
<p>A JavaScript array is a grab bag of any objects. You don&#8217;t have to specify in advance the number of elements to store, and there is more than one way to create and initialize array instances. The following code samples are self-explanatory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var myArray=[];
    myArray[0]="Mary";
    myArray[2]="John";

// prints undefined John
console.log(myArray[1] + " " + myArray[2]);

var states1 = ["NJ", "NY", "CT", "FL"];

var states = new Array(4);  // size is optional

states[0]="NJ";

states[1]="NY";

states[2]="CT";

states[3]="FL";

// remove one array element
delete states[1];


// prints undefined CT length=4
console.log(states[1] + " " + states[2] + " Array length=" + states.length);

// remove one element starting from index 2
states.splice(2,1);

// prints undefined  FL length=3
console.log(states[1] + " " + states[2] + " Array length=" + states.length);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Removing elements with <code>delete</code> creates gaps in the arrays, whereas by using the array&#8217;s method splice(), you can remove or replace the specified range of elements, closing gaps.</p>
</div>
<div class="paragraph">
<p>The next code sample illustrates an interesting use case, wherein we assign a string and a function text as array elements to <code>mixedArray</code>.  During array initialization, the function <code>promt()</code> is invoked, the user is prompted to enter a name, and after that, two strings are stored in mixedArray—for example, "Hello" and "Mary."</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var mixedArray=[
    "Hello",
    prompt("Enter your name", ”Type your name here")
];</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_prototypal-inheritance"><a class="anchor" href="#_prototypal-inheritance"></a>Prototypal Inheritance</h3>
<div class="paragraph">
<p>JavaScript doesn&#8217;t support classes, at least not until ECMAScript 6 becomes a reality. But you can create objects that inherit the properties and methods of other objects. By default, all JavaScript objects are inherited from <code>Object</code>. Each JavaScript construction function has a special property called <code>prototype</code>, which points at this object&#8217;s ancestor. If you want to create an inheritance chain whereby instances of the constructor function <code>ObjectB</code> <em>extends</em> <code>ObjectA</code> (similar to  classical object-oriented languages), write one line of code such as <code>ObjectB.prototype=ObjectA;</code> (see <a href="#FIGaa10">Prototypal inheritance</a>).</p>
</div>
<div id="FIGaa10" class="imageblock">
<div class="content">
<img src="images/ewdv_aa10.png" alt="ewdv aa10">
</div>
<div class="title">Figure 10. Prototypal inheritance</div>
</div>
<div class="paragraph">
<p>Consider two constructor functions, <code>Employee</code> and <code>Person</code>, shown in the code snippet that follows. They represent two unrelated objects. But assigning the <code>Person</code> object to the <code>prototype</code> property of <code>Employee</code> creates an inheritance chain, and now the object <code>emp</code> will have all properties defined in both <code>Employee</code> and <code>Person</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function Person(name, title){
	this.name=name;
	this.title=title;
	this.subordinates=[];
}

function Employee(name, title){
	this.name=name;
	this.title=title;
}

// All instances of Employee will extend Person
Employee.prototype = new Person();            <i class="conum" data-value="1"></i><b>(1)</b>

var emp = new Employee("Mary", "Specialist"); <i class="conum" data-value="2"></i><b>(2)</b>

console.log(emp);      <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Assign an ancestor of type person.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Instantiate Employee.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Print the object referred by <code>emp</code> to output [object Object]. It happens because each object has a method <code>toString()</code>, and if you want it to output useful information, override it. You&#8217;ll see how to do this later in this section.</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The preceding code results in code duplication, because the object referenced by the variable <code>emp</code> will have a pair of <code>name</code> and a pair of <code>title</code> properties. You&#8217;ll see how to avoid such duplication a bit later, in the section <a href="#avoiding_declaration_redundancy">Avoiding Declaration Redundancy</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The property <code>prototype</code> exists on constructor functions. After creating specific instances of such objects, you might see that these instances have another property called <code>proto</code>. At the time of this writing, this property is not a standard yet and won&#8217;t be supported in some older browsers, but ECMAScript 6 will make it official. To illustrate the difference between <code>prototype</code> and <code>proto</code>, let&#8217;s add the following piece of code to the previous code sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">//Create an instance of Person and add property dependents
var p=new Person();
p.dependents=1;                 <i class="conum" data-value="1"></i><b>(1)</b>


var emp2=new Employee("Joe", "Father");

//This employee will have property dependents

emp2.__proto__=p;               <i class="conum" data-value="2"></i><b>(2)</b>

console.log("The number of Employee's dependents " + emp2.dependents);   <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create an instance of <code>Person</code> and add an extra property, dependents, just for this instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Assign this instance to the <code><em>proto</em></code> property of one instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The code will properly print 1 as a number of dependents of the <code>Employee</code> instance represented by the variable <code>emp2</code>.  The variable <code>emp</code> from the previous code snippet won&#8217;t have the property <code>dependents</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For a hands-on demonstration, open the file <em>WhoIsYourDaddy.html</em> (included in book code samples). Just for a change, this time we&#8217;ll use Google Chrome Developer Tools by opening the browser&#8217;s menu and choosing View&#8594;Developer&#8594;Developer Tools. Select the Sources tab and expand the panel on the left to select the file <em>WhoIsYourDaddy.js</em>. Set the breakpoint at the last line of the JavaScript, refresh the web page content, and add the watch expressions (click the + sign at the upper right) for the variables <code>p</code>, <code>emp</code>, and <code>emp2</code>. When the JavaScript code engine runs into <code>emp2.dependents</code>, it tries to find this property on the <code>Employee</code> object. If not found, the engine checks all the objects in the prototypal chain (in our case, it will find it in the object <code>p</code>) all the way up to the <code>Object</code>, if need be. Examine the values of the variable shown in <a href="#FIGaa11">The instance-specific <em>proto</em> variable</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If your program needs to work only with those properties that are defined on a specific object (not in its ancestors in the prototypal chain), use the method <a href="http://mzl.la/1iBmDBS"><code>hasOwnProperty()</code></a>.
</td>
</tr>
</table>
</div>
<div id="FIGaa11" class="imageblock">
<div class="content">
<img src="images/ewdv_aa11.png" alt="ewdv aa11">
</div>
<div class="title">Figure 11. The instance-specific <em>proto</em> variable</div>
</div>
<div class="paragraph">
<p>Note the difference in the content of the variables <code><em>proto</em></code> of the instances represented by <code>emp</code> and <code>emp2</code>. These two employees are inherited from two <em>different</em> objects <code>Person</code>. Isn&#8217;t it scary? Not really.</p>
</div>
<div class="sect3">
<h4 id="avoiding_declaration_redundancy"><a class="anchor" href="#avoiding_declaration_redundancy"></a>Avoiding Declaration Redundancy</h4>
<div class="paragraph">
<p>With prototypal inheritance, you can inherit one object from another, but it can lead to issues of redundancy and code duplication. If you take a closer look at the screenshot in <a href="#FIGaa12">Preparing breakpoints: take 1</a>, you&#8217;ll see that the <code>Person</code> and <code>Employee</code> objects have redundant properties <code>name</code> and <code>title</code>. We&#8217;ll deal with this redundancy in the section <a href="#call_and_apply">Call and Apply</a>. But first, let&#8217;s introduce and cure the redundancy in method declarations when prototypal inheritance is used.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s add a method <code>addSubordinate()</code> to the ancestor object <code>Person</code> that will populate its array <code>subordinates</code>. Who knows, maybe an object <code>Contractor</code> (descendant of a <code>Person</code>) will need to be introduced to the application in the future, so the ancestor&#8217;s method <code>addSubordinate()</code> can be reused. <em>First, we&#8217;ll do it the wrong way to illustrate the redundancy problem</em>, and then we&#8217;ll do it right. Consider the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">// Constructor function Person
function Person(name, title){
	this.name=name;
	this.title=title;
	this.subordinates=[];

    // Declaring method inside the constructor function
	this.addSubordinate=function (person){
		this.subordinates.push(person)
	}
}

// Constructor function Employee
function Employee(name, title){
	this.name=name;
	this.title=title;
}

// Changing the inheritance of Employee
Employee.prototype = new Person();

var mgr =  new Person("Alex", "Director");
var emp1 = new Employee("Mary", "Specialist");
var emp2 = new Employee("Joe", "VP");

mgr.addSubordinate(emp1);
mgr.addSubordinate(emp2);
console.log("mgr.subordinates.length is " + mgr.subordinates.length);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method <code>addSubordinate()</code> here is declared inside the constructor function <code>Person</code>, which becomes an ancestor of <code>Employee</code>. After instantiation of two <code>Employee</code> objects, the method <code>addSubordinate()</code> is duplicated for each instance.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s use the Google Chrome Developer Tools profiler to see the sizes of the objects allocated on the Heap memory. But first, we&#8217;ll set up two breakpoints: one before, and one after creating our instances, as shown in <a href="#FIGaa12">Preparing breakpoints: take 1</a>.</p>
</div>
<div id="FIGaa12" class="imageblock">
<div class="content">
<img src="images/ewdv_aa12.png" alt="ewdv aa12">
</div>
<div class="title">Figure 12. Preparing breakpoints: take 1</div>
</div>
<div class="paragraph">
<p>When the execution of the code stops at the first breakpoint, we&#8217;ll switch to the Profiler tab and take the first Heap snapshot. Upon reaching the second breakpoint, we&#8217;ll take another Heap snapshot. Using the drop-down at the status bar, you can view the objects allocated between the snapshots 1 and 2. <a href="#FIGaa13">Objects allocated between snapshots 1 and 2</a> depicts this view of the profiler. Note that the total size (the Shallow Size column) for the <code>Person</code> instances is 132 bytes. <code>Employee</code> instances <em>weigh</em> 104 bytes.</p>
</div>
<div id="FIGaa13" class="imageblock">
<div class="content">
<img src="images/ewdv_aa13.png" alt="ewdv aa13">
</div>
<div class="title">Figure 13. Objects allocated between snapshots 1 and 2</div>
</div>
<div class="paragraph">
<p>Now we&#8217;ll change the code to declare the method, not inside the <code>Person</code> constructor function, but on its prototype&#8212;&#8203;and <em>this is the right way to declare methods in functions to avoid code duplication</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">// Constructor function Person
function Person(name, title){
	this.name=name;
	this.title=title;
	this.subordinates=[];

}

//Declaring method on the object prototype
Person.prototype.addSubordinate=function(subordinate){
   this.subordinates.push(subordinate);
   return subordinate;
}

// Constructor function Employee
function Employee(name, title){
	this.name=name;
	this.title=title;
}

// Changing the inheritance of Employee
Employee.prototype = new Person();

var mgr =  new Person("Alex", "Director");
var emp1 = new Employee("Mary", "Specialist");
var emp2 = new Employee("Joe", "VP");

mgr.addSubordinate(emp1);
mgr.addSubordinate(emp2);
console.log("mgr.subordinates.length is " + mgr.subordinates.length);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, we&#8217;ll set up two breakpoints before and after object instantiation, as shown in <a href="#FIGaa14">Preparing breakpoints: take 2</a>.</p>
</div>
<div id="FIGaa14" class="imageblock">
<div class="content">
<img src="images/ewdv_aa14.png" alt="ewdv aa14">
</div>
<div class="title">Figure 14. Preparing breakpoints: take 2</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take two more profiler snapshots upon reaching each of the breakpoints. Although the size of the <code>Employee</code> instances remains the same (104 bytes), the <code>Person</code> instances become smaller: 112 bytes (see <a href="#FIGaa15">Objects allocated between snapshots 3 and 4</a>). Even though 20 bytes might not seem like a big deal, if you need to create hundreds or thousands of object instances, it adds up.</p>
</div>
<div id="FIGaa15" class="imageblock">
<div class="content">
<img src="images/ewdv_aa15.png" alt="ewdv aa15">
</div>
<div class="title">Figure 15. Objects allocated between snapshots 3 and 4</div>
</div>
<div class="paragraph">
<p>So, if you need to declare a method on the object that will play a role of the ancestor, do it on the prototype level. The only exception to this rule occurs when the method needs to use an object-specific variable that&#8217;s different for each instance; in that case, declare methods inside the constructors (for details, see the section <a href="#closures">Closures</a>).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Implementing Missing Features with Polyfills</div>
<div class="paragraph">
<p>All modern web browsers support the function <code>Object.create()</code>, which creates a new object based on another prototype object and sets that new object&#8217;s prototype to be the object passed in&#8212;&#8203;for example, <code>var objectB=Object.create(objectA);</code>.  What if you must support an older browser and need this "create by example" functionality? Of course, you can always create a custom, arbitrarily named function with similar functionality as the latest implementation of <code>Object.create()</code>. But the future-proof approach is to create the missing methods with the same signatures and on the same objects as the latest ECMAScript specification prescribes. In the case of <code>Object.create()</code>, you can use the implementation <a href="http://bit.ly/1qVDkNE">offered by Douglas Crockford</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">if (typeof Object.create !== 'function') {
    Object.create = function (o) {
        function F() {}
        F.prototype = o;
        return new F();
    };
}
newObject = Object.create(oldObject);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This approach of custom implementation of missing pieces according to the latest ECMAScript specifications or W3C drafts is known as <em>polyfills</em>. People who can&#8217;t wait until browser vendors implement the newest functionality create their own cross-browser polyfills, and some of them submit their source code to the public domain. You can find a number of polyfills in the Git repository of the <a href="http://bit.ly/mod-list">Modernizr project</a>. The <a href="http://caniuse.com">Can I use&#8230;&#8203; website</a> contains the current information about browser&#8217;s support of the latest HTML5, JavaScript, and CSS features.</p>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In <a href="#developing_in_ext_js">[developing_in_ext_js]</a>, you can see how this framework offers its own class system that supports inheritance.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_method-overriding"><a class="anchor" href="#_method-overriding"></a>Method Overriding</h4>
<div class="paragraph">
<p>Method overriding allows a subclass to replace (<em>override</em>) the functionality of a method defined in a superclass. Because JavaScript allows declaring methods on an object as well as on its prototype, overriding a method becomes really simple. The following code sample (see the file <em>overriding.js</em>) declares the method <code>addSubordinate()</code> on the prototype of the <code>Person</code> object, but then the object <code>p1</code> overrides this method: </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function Person(name, title){

  this.name=name;
  this.title=title;
  this.subordinates=[];
}

Person.prototype.addSubordinate=function(person){

   this.subordinates.push(person);
   console.log("I'm in addSubordinate on prototype " + this);
}

var p1=new Person("Joe", "President");

    p1.addSubordinate=function(person){

    this.subordinates.push(person);
    console.log("I'm in addSubordinate in object " + this);
  }

    var p2 = new Person("Mary", "Manager")

    p1.addSubordinate(p2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running this code prints only one line: "I&#8217;m in addSubordinate in object [object Object]." This proves that the method <code>addSubordinate()</code> on the prototype level is overridden. We can also improve this example by overriding the method <code>toString()</code> on the <code>Person</code> object. Just add the following fragment prior to instantiating <code>p1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">Person.prototype.toString=function(){
   return "name:" + this.name +" title:" + this.title;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the code prints "I&#8217;m in addSubordinate in object name:Joe, title:President." Overriding the method <code>toString()</code> on objects is a common practice because it gives a textual representation of your objects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="scope"><a class="anchor" href="#scope"></a>Scope, or Who&#8217;s This?</h3>
<div class="paragraph">
<p>You are about to read one of the most confusing sections in this book. The confusion is caused by inconsistencies in JavaScript design and implementations by various browsers. Do you know what will happen if you remove the keyword <code>this</code> from the <code>toString()</code> method  in the previous section? You&#8217;ll get an error: the variable <code>title</code> is not defined. Without the keyword <code>this</code>, the JavaScript engine tries to find the variable <code>title</code> in the global namespace. Declaring and initializing the variable <code>title</code> outside the <code>Person</code> declaration eliminates this error, but this is not what we want to do. Misunderstanding the current scope can lead to errors that are difficult to debug.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Interestingly enough, replacing <code>this.name</code> with <code>name</code> doesn&#8217;t generate an error but rather initializes the variable <code>name</code> with an empty string. Although <code>name</code> is not an officially reserved JavaScript keyword, there are articles in the blogosphere that don&#8217;t recommend using the word <code>name</code> as a variable name. Keep <a href="http://www.javascripter.net/faq/reserved.htm">this list of reserved words</a> handy to avoid running into unpredictable behavior.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s consider several examples that illustrate the meaning of the <code>this</code> variable in JavaScript. The code sample that follows defines an object <code>myTaxObject</code> and calls its method <code>doTaxes()</code>. Notice two variables with the same name, taxDeduction—one of them has global scope and another belongs to <code>myTaxObject</code>. This little script is titled <em>ThisMafia.js</em>, and it was written for the mafia and will apply some under-the-table deductions for those who belong to Cosa Nostra:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var taxDeduction=300;      // global variable

var myTaxObject = {

    taxDeduction: 400,    // object property

    doTaxes: function() {
         this.taxDeduction += 100;

         var mafiaSpecial= function(){
           console.log( "Will deduct " + this.taxDeduction);
         }

         mafiaSpecial();  // invoking as a function
    }
}

myTaxObject.doTaxes();  //invoking method doTaxes</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code fragment illustrates the use of <em>nested functions</em>. The object method <code>doTaxes()</code> has a nested function <code>mafiaSpecial()</code>, which is not visible from outside <code>myTaxObject</code>, but it can certainly be invoked inside <code>doTaxes()</code>. What number do you think this code will print after the words "Will deduct"? Will it print three, four, or five hundred? Run this code in Firebug, Chrome Developer Tools, or any other way, and you&#8217;ll see that it will print 300!</p>
</div>
<div class="paragraph">
<p>But this doesn&#8217;t sound right, does it? The problem is that in JavaScript, the context where the function executes depends on the way it was invoked. In this case, the function <code>mafiaSpecial()</code> was invoked as a function (not a method) without specifying the object it should apply to, and JavaScript makes it operate in the global object; hence, the global variable <code>taxDeduction</code> having the value of 300 is used. So in the expression <code>this.taxDeduction</code>  the variable <code>this</code> means global unless the code is operated in strict mode.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>ECMAScript 5 introduced a restricted version of JavaScript called <em>strict mode</em>, which among other things places stricter requirements to variable declarations and scope identification. Adding use strict as the first statement of the method <code>doTax()</code> will make the context <em>undefined</em>, and it will print the error "this is undefined" and not 300. You can read about strict mode at <a href="http://mzl.la/N4z1QI">Mozilla&#8217;s developers site</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s make a slight change to this example to control what <code>this</code> represents. When the object <code>myTaxObject</code> was instantiated, its own <code>this</code> reference was created. The following code fragment stores the reference to this in an additional variable. <code>thisOfMyTaxObject</code> changes the game, and the expression <code>thisOfMyTaxObject.taxDeduction</code> evaluates to 500:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var taxDeduction=300;      // global variable

var myTaxObject = {

    taxDeduction: 400,    // object property

    doTaxes: function() {
    var thisOfMyTaxObject=this;
         this.taxDeduction += 100;

         var mafiaSpecial= function(){
           console.log( "Will deduct " + thisOfMyTaxObject.taxDeduction);
         }

         mafiaSpecial();  // invoking as a function
    }
}

myTaxObject.doTaxes();  //invoking method doTaxes</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll see a different way of running a function in the context of the specified object, using the special functions <code>call()</code> and <code>apply()</code>. But for now, consider one more attempt to invoke <code>mafiaSpecial()</code> shown in the following example that uses <code>this.mafiaSpecial()</code> notation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var taxDeduction=300;      // global variable

var myTaxObject = {

    taxDeduction: 400,    // object property

    doTaxes: function() {
         this.taxDeduction += 100;

         var mafiaSpecial= function(){
           console.log( "Will deduct " + this.taxDeduction);
         }

         this.mafiaSpecial();  // trying to apply object's scope
    }
}

myTaxObject.doTaxes();  //invoking method doTaxes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run this code; you&#8217;ll see the error "TypeError: this.mafiaSpecial is not a function," and rightly so. Take a closer look at the object <code>myTaxObject</code> represented by the variable <code>this</code>. The object <code>myTaxObject</code> has only two properties: <code>taxDeduction</code> and <code>doTaxes</code>. The function <code>mafiaSpecial</code> is hidden within the method <code>doTaxes</code> and can&#8217;t be accessed via <code>this</code>.</p>
</div>
<div class="paragraph">
<p>After learning how to hide a function within an object, let&#8217;s see how to do something quite the opposite: allowing an external method to run inside the context of an object.</p>
</div>
<div class="sect3">
<h4 id="call_and_apply"><a class="anchor" href="#call_and_apply"></a>Call and Apply</h4>
<div class="paragraph">
<p>Visualize the International Space Station. Now, add to the picture an image of an approaching space shuttle. After attaching to the docking bay of the station, the shuttle&#8217;s crew performs some functions on the station (a.k.a. the object) and then flies to another object or back to Earth. What does this have to do with JavaScript? It can serve as an analogy for creating a JavaScript function that can operate in the scope of any arbitrary object. For this purpose, JavaScript offers two special functions: <code>call()</code> and <code>apply()</code>. Both <code>call()</code> and <code>apply()</code> can invoke any function on any object. The only difference between them is that <code>apply()</code> passes  parameters to a function as an array, whereas <code>call()</code> uses a comma-separated list.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Every function in JavaScript is an instance of the <code>Function</code> object. Both <code>call()</code> and <code>apply()</code> are defined in <code>Function</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, you can invoke a function <code>calcStudentDeduction(income,numOfStudents)</code> in the context of a given object by using either call() or apply(). Note that with <code>call()</code>, you must list parameters explicitly, whereas with <code>apply()</code>, parameters are given as an array:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">calcStudentDeduction.call(myTaxObject, 50000, 2);

calcStudentDeduction.apply(myTaxObject, [50000, 2]);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, you can reference the instance of myTaxObject as <code>this</code> from within the function <code>calcStudentDeduction()</code>, even though this is a function and not a method. You can rewrite the last example from the previous section to invoke <code>mafiaSpecial()</code>. The following code will ensure that <code>mafiaSpecial()</code> has <code>this</code> pointing to myTaxObject and will print on the console "Will deduct 500."</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var taxDeduction=300;      // global variable

var myTaxObject = {

    taxDeduction: 400,

    doTaxes: function() {
         this.taxDeduction += 100;

         var mafiaSpecial = function(){
           console.log( "Will deduct " + this.taxDeduction);
         }

         mafiaSpecial.call(this);  // passing context to a function
    }
}

myTaxObject.doTaxes();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="callbacks"><a class="anchor" href="#callbacks"></a>Callbacks</h4>
<div class="paragraph">
<p>Can you program without using <code>call()</code> and <code>apply()</code>?  Sure you can, but with JavaScript, you can easily create callbacks. The callback mechanism lets you pass the code of one function as a parameter to another function for execution in the latter function&#8217;s context. This is a very useful feature of the language. Imagine an object with a method <code>processData()</code>. Depending on the business logic, you can pass to this method (as an argument) different functions that will do actual data processing: these are callbacks.</p>
</div>
<div class="paragraph">
<p>Another example of callbacks is event handlers. If a user clicks this button, here&#8217;s the name of the handler function to call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">`myButton.addEventListener("click", myFunctionHandler);`</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s important to understand that <em>you don&#8217;t immediately call</em> the function <code>myFunctionHandler</code> here; you are just registering it as the function argument. If the user clicks <code>myButton</code>, the code of the callback <code>myFunctionHandler</code> will be given to the object <code>myButton</code> and will be  invoked in the context of the <code>myButton</code> object. The functions <code>call()</code> and <code>apply()</code> exist exactly for this purpose.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider an example. Suppose that you need to write a function that will take two arguments: an array containing preliminary tax data and a callback function, which will be applied to each element of this array. The following code sample (<em>Callback.js</em>) creates <code>myTaxObject</code> that has two properties: <code>taxDeduction</code> and <code>applyDeduction</code>. The latter is a method with two parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var myTaxObject = {

    taxDeduction: 400, // state-specific  deduction

    // this function takes an array and callback as parameters
    applyDeduction: function(someArray, someCallBackFunction){

        for (var i = 0; i &lt; someArray.length; i++){

            // Invoke the callback
           someCallBackFunction.call(this, someArray[i]);
        }

    }
}

// array
var preliminaryTaxes=[1000, 2000, 3000];

// tax handler function
var taxHandler=function(currentTax){
                   console.log("Hello from callback. Your final tax is " +
                   (currentTax - this.taxDeduction));
                }

// invoking applyDeduction passing an array and callback
myTaxObject.applyDeduction(preliminaryTaxes, taxHandler);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code invokes <code>applyDeduction()</code>, passing it the array <code>preliminaryTaxes</code>, and the callback function <code>taxHandler</code> that takes the <code>currentTax</code> and subtracts <code>this.taxDeduction</code>. By the time this callback is applied to each element of the array, the value of <code>this</code> will be known and this code will print the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">Hello from callback. Your final tax is 600
Hello from callback. Your final tax is 1600
Hello from callback. Your final tax is 2600</code></pre>
</div>
</div>
<div class="paragraph">
<p>You might be wondering, why pass the function to another object if we could take an array, subtract 400 from each of its elements, and be done with it? The solution with callbacks gives you an ability to decide which function to call during runtime and call it only when a certain event happens. Using callbacks, you can do <em>asynchronous processing</em>. For example, you make an asynchronous  request to a server and register the callback to be invoked if a result comes back. The code is not blocked and doesn&#8217;t wait until the server response is ready. Here&#8217;s an example from Ajax: <code>request.onreadystatechange=myHandler</code>. You register the <code>myHandler</code> callback but don&#8217;t immediately call it. JavaScript functions are objects, so get used to the fact that you can pass them around as you&#8217;d be passing any objects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hoisting"><a class="anchor" href="#_hoisting"></a>Hoisting</h4>
<div class="paragraph">
<p>A variable scope depends on where it was declared. You already had a chance to see that a variable declared inside a function with the keyword <code>var</code> is visible only within this function and any function declared within it. With some programming languages, you can narrow the scope even further. For example, in Java, declaring a variable inside any block of code surrounded with curly braces makes it visible only within that block. In JavaScript, it works differently. No matter where in the function you declare the variable, its declaration will be <em>hoisted</em> to the top of the function, and you can use this variable anywhere within the function.</p>
</div>
<div class="sect4">
<h5 id="_hoisting-variables"><a class="anchor" href="#_hoisting-variables"></a>Hoisting variables</h5>
<div class="paragraph">
<p>The following code snippet will print 5, even though the variable b has been declared inside the if statement. Its declaration has been hoisted to the top:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function test () {
    var a=1;

    if(a&gt;0) {
        var b = 5;
    }
    console.log(b);

}

test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s make a slight change to this code to separate the variable declaration and initialization. The following code has two <code>console.log(b)</code> statements; the first one will output <code>undefined</code>, and the second will print 5, just as in the previous example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function test () {
    var a=1;

    console.log(b);  // b is visible, but not initialized

    if(a&gt;0) {
        var b;
    }

    b=5;

    console.log(b);  // b is visible and initialized
}

test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Due to hoisting, JavaScript doesn&#8217;t complain when the first <code>console.log(b)</code> is invoked. It knows about the variable <code>b</code>, but its value is <code>undefined</code> just yet. By the time the second <code>console.log(b)</code> is called, the variable b was initialized with the value of 5. Just remember that hoisting applies only to variable declarations and doesn&#8217;t interfere with your code when it comes to initialization.</p>
</div>
</div>
<div class="sect4">
<h5 id="_hoisting-functions"><a class="anchor" href="#_hoisting-functions"></a>Hoisting functions</h5>
<div class="paragraph">
<p>You can hoist JavaScript function declarations, too, as is illustrated in the following code sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function test () {
    var a=1;

    if(a&gt;0) {
        var b;
    }

    b=5;

    printB();

    function printB(){
        console.log(b);
    }
}

test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code will print 5. We can call the function printB() here because its declaration was hoisted to the top. But the situation changes if instead of a function declaration we use a function expression. The following code will give you the error "PrintB is not a function":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function test () {
    var a=1;

    if(a&gt;0) {
        var b;
    }

    b=5;

    printB();

    var printB = function(){
        console.log(b);
    }

}

test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the error doesn&#8217;t complain about <code>printB</code> being undefined because the variable declaration was hoisted, but because the function expression wasn&#8217;t, the JavaScript engine doesn&#8217;t know yet that <code>printB</code> will become a function rather soon. Anyway, moving the invocation line <code>printB()</code> to the bottom of the function <code>test()</code> cures this issue.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Function expressions are not hoisted, but the variables to which they are assigned (if any) are hoisted.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_function-properties"><a class="anchor" href="#_function-properties"></a>Function Properties</h4>
<div class="paragraph">
<p>Functions, like any other objects, can have properties. You can attach any properties to a <code>Function</code> object, and their values can be used by all instances of this object. Static variables in programming languages with classical inheritance is the closest analogy to function properties in JavaScript.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider an example of a constructor function <code>Tax</code>. Let&#8217;s assume that we have an accounting program that can create multiple instances of Tax—one per person. Suppose that this program will be used in a Florida neighborhood with predominantly Spanish-speaking people. The following code (see the file <em>FunctionProperties.js</em>) illustrates the case in which the method <code>doTax()</code> can be called with or without parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function Tax(income, dependents){
    this.income=income;              // instance variable
    this.dependents=dependents;      // instance variable

    this.doTax = function calcTax(state, language){
           if(!(state &amp;&amp; language)){     <i class="conum" data-value="1"></i><b>(1)</b>
              console.log("Income: " + this.income + " Dependents: "+
                                                       this.dependents
              + " State: " + Tax.defaults.state + " language:" +
                                                    Tax.defaults.language);
           } else{                       <i class="conum" data-value="2"></i><b>(2)</b>
              console.log("Income: " + this.income + " Dependents: "+
                                                       this.dependents
              + " State: " + state + " language:" + language);
           }
    }
}

Tax.defaults={                           <i class="conum" data-value="3"></i><b>(3)</b>
     state:"FL",
     language:"Spanish"
};

// Creating 2 Tax objects
var t1 = new Tax(50000, 3);
    t1.doTax();                          <i class="conum" data-value="4"></i><b>(4)</b>
var t2 = new Tax(68000, 1);
    t2.doTax("NY","English");            <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>No state or language were given to the method <code>doTax()</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The state and language were provided as <code>doTax()</code> parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Assigning the object with two properties as a <code>defaults</code> property on <code>Tax</code>. The property <code>default</code> is not instance specific, which makes it static.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Invoking <code>doTax()</code> without parameters&#8212;&#8203;use <code>defaults</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Invoking <code>doTax()</code> with parameters.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This program produces the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">Income: 50000 Dependents: 3 State: FL language:Spanish
Income: 68000 Dependents: 1 State: NY language:English</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add as many properties to the constructor function as needed. For example, to count the number of instances of the <code>Tax</code> object, just add one more property: <code>Tax.counter=0;</code>. Now add to the <code>Tax</code> function something like <code>console.log(Tax.counter++);</code> and you&#8217;ll see that the counter increments on each instance creation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If multiple instances of a function object need to access certain HTML elements of the DOM,  add references to these elements as function properties so objects can reuse them instead of traversing the DOM (it&#8217;s slow) from each instance.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="closures"><a class="anchor" href="#closures"></a>Closures</h3>
<div class="paragraph">
<p>A <em>closure</em> is one of those terms that is easier explained by examples. Formal definitions are not very helpful to first-timers. Here&#8217;s the <a href="http://bit.ly/1kGNVGZ">definiton of a closure from Wikipedia</a>:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>In programming languages, a closure (also lexical closure or function closure) is a function or reference to a function together with a referencing environment—a table storing a reference to each of the non-local variables (also called free variables or upvalues) of that function. A closure—unlike a plain function pointer—allows a function to access those non-local variables even when invoked outside its immediate lexical scope.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>It&#8217;s not a very helpful definition, is it? Let&#8217;s try to give a better one. Imagine a function that contains a private variable and a nested function. Is it possible to invoke the nested function from outside the outer one? And if it&#8217;s possible, what does this inner function know about its surroundings?</p>
</div>
<div class="paragraph">
<p>Larry Ullman gives the following definition in <em>Modern Java Script</em> (Peachpit Press): "Closure is a function call with memory." We can offer you our version of what a closure is: A closure is a function call with strings attached.</p>
</div>
<div class="sect3">
<h4 id="_why-do-we-need-closures"><a class="anchor" href="#_why-do-we-need-closures"></a>Why Do We Need Closures?</h4>
<div class="paragraph">
<p>In classical object-oriented languages, you create an object with a certain state and behavior and can pass it to a method of another object for further processing. In JavaScript, you can even pass a function to an object&#8217;s method for further processing. But what if a function also needs to remember the state (the values of external variables) of the context where the function was defined?</p>
</div>
<div class="paragraph">
<p>Think of a closure as a function that remembers  state. It&#8217;s just a special type of object that can be passed between objects and use certain variables that didn&#8217;t seem to be defined in the function&#8217;s code. But they existed in the context where the function was defined.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_closures-by-example"><a class="anchor" href="#_closures-by-example"></a>Closures by Example</h3>
<div class="paragraph">
<p>Now it&#8217;s time to explain these mysterious definitions, and we&#8217;ll do it by example. Consider the following code (see <em>closure1.js</em>) that is yet another example of implementing the tax collection functionality:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">(function (){                // this is an anonymous function expression

    var taxDeduction = 500;  // private context to remember

      //exposed closure
      this.doTaxes=function(income, customerName) {

      	var yourTax;

        if (customerName !== "Tony Soprano"){
          yourTax = income*0.05 - taxDeduction;
        } else{
          yourTax = mafiaSpecial(income);
        }

         console.log( "   Dear " + customerName + ", your tax is "+ yourTax);
         return yourTax;
      }

      //private function
      function mafiaSpecial(income){
          return income*0.05 - taxDeduction*2;
      }

})();    // Self-invoked function

// The closure remembers its context with taxDeduction=500
doTaxes(100000, "John Smith");
doTaxes(100000, "Tony Soprano");

mafiaSpecial();        // throws an error - this function is private</code></pre>
</div>
</div>
<div class="paragraph">
<p>First, a self-invoking function creates an anonymous instance of an object in the global scope. It contains a private variable <code>taxDeduction</code>, a public method <code>doTaxes()</code>, and a private method <code>mafiaSpecial()</code>. Just by virtue of declaring <code>doTaxes</code> on <code>this</code> object, this method becomes exposed to the current scope, which is global in this example.</p>
</div>
<div class="paragraph">
<p>After that, we call the method <code>doTaxes()</code> twice. Note that the function <code>doTaxes()</code> uses the variable <code>taxDeduction</code> that was never declared there. But when <code>doTaxes</code> was initially declared, the variable <code>taxDeduction</code> with a value of 500 was already there. So the internal function "remembers" the context (the neighborhood) where it was declared and can use it for its calculations.</p>
</div>
<div class="paragraph">
<p>The algorithm of tax calculations makes <code>doTaxes()</code> call the function <code>mafiaSpecial()</code> if the customer&#8217;s name is Tony Soprano. The function <code>mafiaSpecial()</code> is not visible from outside, but for insiders like <code>doTaxes()</code>, it&#8217;s available. Here&#8217;s what the preceding code example prints on the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">Dear John Smith, your tax is 4500
Dear Tony Soprano, your tax is 4000
Uncaught ReferenceError: mafiaSpecial is not defined</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#FIGaa16">Closure view in Chrome Developer Tools</a> shows a screenshot taken when <code>doTaxes()</code> hit the breakpoint inside <code>doTaxes</code>. Note the right panel that shows what&#8217;s visible in the Closure scope.</p>
</div>
<div id="FIGaa16" class="imageblock">
<div class="content">
<img src="images/ewdv_aa16.png" alt="ewdv aa16">
</div>
<div class="title">Figure 16. Closure view in Chrome Developer Tools</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
JavaScript doesn&#8217;t give you an explicit way to mark a variable as private. By using closures, you can get the same level of data hiding that you get from private variables in other languages. In the preceding example, the variable <code>taxDeduction</code> is local for the object enclosed in the outermost parentheses and can&#8217;t be accessed from outside. But <code>taxDeduction</code> can be visible from the object&#8217;s functions <code>doTaxes</code> and <code>mafiaSpecial</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="#FIGaa17">The closure doTaxes</a> gives yet another visual representation of our code sample. The self-invoked anonymous function is shown as a cloud that exposes only one thing to the rest of the world: the closure <code>doTaxes</code>.</p>
</div>
<div id="FIGaa17" class="imageblock">
<div class="content">
<img src="images/ewdv_aa17.png" alt="ewdv aa17">
</div>
<div class="title">Figure 17. The closure doTaxes</div>
</div>
<div class="paragraph">
<p>Let&#8217;s consider a couple more cases of returning a closure to the outside world so it can be invoked later. Whereas the previous code sample exposes the closure by using <code>this.taxes</code> notation, the next two examples simply return the code of the closure by using the <code>return</code> statement. The following code (see <em>closure3.js</em>) declares a constructor function <code>Person</code>, adds a function <code>doTaxes()</code> to its prototype, and then finally creates two instances of the <code>Person</code> calling the method <code>doTaxes()</code> on each of them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">// Constructor function
function Person(name){

	this.name = name;

}

// Declaring a method that returns closure
Person.prototype.doTaxes= function(){

    var taxDeduction = 500;

      //private function
      function mafiaSpecial(income){
          return income*0.05 - taxDeduction*2;
      }

      //the code of this function is returned to the caller
      return function(income) {

      	var yourTax;

        if (this.name !== "Tony Soprano"){
          yourTax =   income*0.05 - taxDeduction;
        } else{
          yourTax =   mafiaSpecial(income);
        }

         console.log( "My dear " + this.name + ", your tax is "+ yourTax);
         return yourTax;
      }
}();     // important parentheses!

//Using closure
var p1 = new Person("John Smith");
var result1 = p1.doTaxes(100000);

var p2 = new Person("Tony Soprano");
var result2 = p2.doTaxes(100000);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The calculated taxes in this example are the same as in the previous one: John Smith has to pay $4,500, whereas Tony Soprano has to pay only $4,000. But we used a different technique for exposing the closure. We want to make sure that you didn&#8217;t overlook the parentheses at the very end of the function expression for <code>doTaxes</code>. These parentheses force the anonymous function to self-invoke; it will run into a <code>return</code> statement and will assign the code of the anonymous inner function that takes the parameter <code>income</code> to the property <code>doTaxes</code>. So when the line <code>var result1 = p1.doTaxes(100000);</code> calls the closure, the variable <code>result1</code> will have the value 4500. Remove these important parentheses, and the value of <code>result1</code> is not the tax amount, but the code of the closure itself&#8212;&#8203;the invocation of the closure is not happening.</p>
</div>
<div class="paragraph">
<p>The following code fragment (see <em>closure2.js</em>) is yet another example of returning the closure that remembers its context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">function prepareTaxes(studentDeductionAmount) {

	return function (income) {           <i class="conum" data-value="1"></i><b>(1)</b>
	   return income*0.05 - studentDeductionAmount;
	};

}

var doTaxes = prepareTaxes(300);         <i class="conum" data-value="2"></i><b>(2)</b>
var yourTaxIs = doTaxes(10000);          <i class="conum" data-value="3"></i><b>(3)</b>
console.log("Your tax is " + yourTaxIs);  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When the function prepareTaxes is called, it immediately hits the <code>return</code> statement and returns the code of the closure to the caller.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>After this line is executed, the variable <code>doTaxes</code> has the code of the closure, which remembers that <code>studentDeductionAmount</code> is equal to 300.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This is the actual invocation of the closure.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The console output is "your tax is 200."</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>First, the closure is returned to the caller of <code>prepareTaxes()</code>, and when the closure is invoked, it remembers the values defined in its outer context. After looking at this code, you might say that nothing is declared in the closure&#8217;s outside context! There is&#8212;&#8203;by the time the closure is created, the value of <code>studentDeductionAmount</code> will be known.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Check the quality of your code with the help of JavaScript code-quality tools such as <a href="http://www.jslint.com/">JSLint</a> or <a href="http://www.jshint.com/">JSHint</a>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_closures-as-callbacks"><a class="anchor" href="#_closures-as-callbacks"></a>Closures as Callbacks</h4>
<div class="paragraph">
<p>Let&#8217;s revisit the code from the previous section. That code shows how to pass an arbitrary function to another one and invoke it there by using <code>call()</code>. But if that version of the function <code>taxHandler</code> is not aware of the context in which it was created, the following version is. If in classical object-oriented languages you need to pass a method that knows about its context, you create an instance of an object that contains the method and the required object-level properties, and then you pass this wrapper-object to another object for processing. But because the closure remembers its context anyway, we can just pass a closure as an object. Compare the following code (see <em>callbackWithClosure.js</em>) with the code from <a href="#callbacks">Callbacks</a>: </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var myTaxObject = {

    // this function takes an array and callback as parameters
    applyDeduction: function(someArray, someCallBackFunction){

        for (var i = 0; i &lt; someArray.length; i++){

            // Invoke the callback
           someCallBackFunction.call(this, someArray[i]);
        }

    }
}

// array
var preliminaryTaxes=[1000, 2000, 3000];


var taxHandler = function (taxDeduction){

// tax handler closure
	return function(currentTax){
                   console.log("Hello from callback. Your final tax is " +
                   (currentTax - taxDeduction));
                };
}

// invoking applyDeduction passing an array and callback-closure
myTaxObject.applyDeduction(preliminaryTaxes, taxHandler(200));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last line of this example calls <code>taxHandler(200)</code>, which creates a closure that&#8217;s being passed as a callback to the method <code>applyDeduction()</code>. Even though this closure is executed in the context of <code>myTaxObject</code>, it remembers that the tax deduction is 200.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mixins"><a class="anchor" href="#_mixins"></a>Mixins</h3>
<div class="paragraph">
<p>The need to extend capabilities of objects can be fulfilled by inheritance, but this is not the only way of adding behavior to objects. In this section, you&#8217;ll see an example of something that would not be possible in object-oriented languages such as Java or C#, which don&#8217;t support multiple inheritance. JavaScript makes it possible to take a piece of code and <em>mix it into any object</em> regardless of its inheritance chain. A <em>mixin</em> is a reusable code fragment that an object can borrow without the need to use inheritance. We&#8217;ll illustrate this concept by example.</p>
</div>
<div class="paragraph">
<p>In the next code fragment, we define a function expression and assign it to a variable named <code>Tax</code>. This is a closure that includes the function <code>calcTax()</code> which knows the values of <code>income</code> and <code>state</code>. There is also an independent mixin, <code>TaxMixin</code>, with a couple of functions, <code>mafiaSpecial()</code> and <code>drugCartelSpecial()</code>. We want to blend this mixin into <code>Tax</code>. After this is done, the Tax object will have its original functionality&#8212;&#8203;for example, calcTax()—as well as new "mafia and drug cartel" flavors. The following code is located in the file <em>mixins.js</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">// Defining a function expression
var Tax = function(income, state){
	this.income=income;
	this.state=state;

	this.calcTax=function(){
		var tax=income*0.05;
		console.log("Your calculated tax is " + tax)
		return tax;
	}
};


// Defining a mixin
var TaxMixin = function () {};

TaxMixin.prototype = {

  mafiaSpecial: function(originalTax){
    console.log("Mafia special:" + (originalTax - 1000));
  },

  drugCartelSpecial: function(originalTax){
     console.log("Drug Cartel special:" + (originalTax - 3000));
  }

};

// this function can blend TaxMixin into Tax
function blend( mainDish, spices ) {

  for ( var methodName in spices.prototype ) {
      mainDish.prototype[methodName] = spices.prototype[methodName];
  }
}

// Blend the spices with the main dish
blend( Tax, TaxMixin );

// Create an instant of Tax
var t = new Tax(50000, "NY");

var rawTax = t.calcTax();

// invoke a freshly blended method
t.mafiaSpecial(rawTax);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The function <code>blend()</code> loops through the code of the <code>TaxMixin</code> and copies all its properties into <code>Tax</code>. After the function <code>blend()</code> is finished, you can call on the <code>Tax</code> instance the newly acquired methods <code>mafiaSpecial()</code> and <code>drugCartelSpecial()</code>.</p>
</div>
<div class="paragraph">
<p>Mixins can be useful if you want to provide a specific feature to numerous objects without changing their inheritance chains. The other use case is if you want to prepare a bunch of small code fragments (think, spices) and add any combination of them to the various objects (dishes) as needed. Mixins give you a lot of flexibility in what you can achieve with minimum code, but they can decrease the readability of your code.</p>
</div>
<div class="paragraph">
<p>If you&#8217;ve read this far, you should have a good understanding of the syntax of the JavaScript language. Studying the code samples provided in this appendix has one extra benefit: now you can apply for a job as a tax accountant in a mafia near you.</p>
</div>
</div>
<div class="sect2">
<h3 id="_javascript-in-the-web-browser"><a class="anchor" href="#_javascript-in-the-web-browser"></a>JavaScript in the Web Browser</h3>
<div class="paragraph">
<p>After learning all these facts and techniques about the language, you might be eager to see the real-world use of JavaScript. Slowly but surely, a web browser becomes the leading platform for development of the user interface. The vast majority of today&#8217;s JavaScript programs primarily manipulate HTML elements of web pages. In this section, we&#8217;ll be doing exactly this: applying JavaScript code to modify the content or style of HTML elements.</p>
</div>
<div class="sect3">
<h4 id="_the-document-object-model-dom"><a class="anchor" href="#_the-document-object-model-dom"></a>The Document Object Model (DOM)</h4>
<div class="paragraph">
<p><em>DOM</em> stands for <em>Document Object Model</em>. It&#8217;s an object representing the hierarchy of HTML elements of a web page. Every element of the HTML document is loaded into the DOM. Each DOM element has a reference to its children and siblings. When the DOM was invented, web pages were simple and static. The DOM was not meant to be an object actively accessed by code. This is the reason why on some heavily populated web pages, manipulating DOM elements can be slow. Most likely the DOM is the main target for anyone who&#8217;s trying to optimize the performance of a web page.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If your web page is slow, analyze it by using <a href="http://yslow.org/">YSlow</a>, a tool built based on the Yahoo! rules for high-performance websites. Also, you can minimize and obfuscate your JavaScript code with the help of  <a href="http://javascriptcompressor.com/">JavaScript Compressor</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a web browser receives content, it  performs the following activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds arriving HTML elements to the DOM and lays out the content of the web pages</p>
</li>
<li>
<p>Renders the UI</p>
</li>
<li>
<p>Runs JavaScript that was included in the HTML</p>
</li>
<li>
<p>Processes events</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The amount of time spent on each activity varies depending the content of the page.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are interested in learning how browsers work, read the excellent write-up titled <a href="http://bit.ly/how-browsers-work">"How Browsers Work: Behind The Scenes of Modern Web Browsers."</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the operations that your application needs to be able to perform inside a web page:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Programmatically find the required element by ID, type, or a CSS class</p>
</li>
<li>
<p>Change styles of elements (show, hide, apply fonts and colors, and more)</p>
</li>
<li>
<p>Process events that might happen to HTML elements (<code>click</code>, <code>mouseover</code>, and the like)</p>
</li>
<li>
<p>Dynamically add or remove HTML elements from the page or change content</p>
</li>
<li>
<p>Communicate with the server side (for example, submitting forms or making Ajax requests for data from the server)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you&#8217;ll see some code samples illustrating the use of JavaScript for these operations. Even if you’re using one of the popular JavaScript frameworks, your program will be performing similar operations, applying the syntax prescribed by your framework of choice. So let&#8217;s learn how it can be done.</p>
</div>
</div>
<div class="sect3">
<h4 id="_working-with-the-dom"><a class="anchor" href="#_working-with-the-dom"></a>Working with the DOM</h4>
<div class="paragraph">
<p>If you want to change the appearance of an HTML page, you need to manipulate the DOM elements. Older web applications prepared HTML content on the server side. For example, a server-side Java servlet would compose and send to the client HTML whenever the application logic required a change to the appearance of the UI. The current trend is different: the client&#8217;s code takes care of the UI rendering, and only the data goes back and forth between the client and the server. You can see how this works in more detail in <a href="#using_ajax_and_json">[using_ajax_and_json]</a>, which explains the use of Ajax and JSON.</p>
</div>
<div class="paragraph">
<p>Earlier in this appendix, we talked about the global namespace where all JavaScript objects live unless they were declared with <code>var</code> inside the functions. If JavaScript code is running in a web browser, this global namespace is represented by a special variable <code>window</code>. It&#8217;s an implicit variable, and you don&#8217;t have to use it in your code, but whenever we say that a variable is global, we mean that it exists in the <code>window</code> object. For example, the following code prints "123 Main Street" twice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var address ="123 Main Street";

console.log(address);
console.log(window.address);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>window</code> object has many useful properties, including <code>cookie</code>, <code>location</code>, <code>parent</code>, and <code>document</code>.  The variable <code>document</code> points at the root of the DOM hierarchy. Often your JavaScript code will find an element in the DOM first, and then it can read or modify its content.
<a href="#FIGaa18">Firebug&#8217;s representation of the DOM</a> is a screenshot from Firebug showing the fragment of a DOM of the simple web page <em>mixins.html</em>.</p>
</div>
<div id="FIGaa18" class="imageblock">
<div class="content">
<img src="images/ewdv_aa18.png" alt="ewdv aa18">
</div>
<div class="title">Figure 18. Firebug&#8217;s representation of the DOM</div>
</div>
<div class="paragraph">
<p>The following are some of the methods that exist on the <code>document</code> object:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>document.write(text)</code></dt>
<dd>
<p>Adds the specific text to the DOM. Careless use of the method <code>write()</code> can result in unpredictable results, if after changing the DOM the HTML content is still arriving.</p>
</dd>
<dt class="hdlist1"><code>document.getElementById(id)</code></dt>
<dd>
<p>Gets a reference to the HTML element by its unique identifier.</p>
</dd>
<dt class="hdlist1"><code>document.getElementsByTagName(tname)</code></dt>
<dd>
<p>Gets a reference to one or more elements by tag names; for example, a reference to all <code>&lt;div&gt;</code> elements.</p>
</dd>
<dt class="hdlist1"><code>document.getElementsByName(name)</code></dt>
<dd>
<p>Gets a reference to all elements that have the requested value in their name attribute.</p>
</dd>
<dt class="hdlist1"><code>document.getElementsByClassName(className)</code></dt>
<dd>
<p>Gets a reference to all elements that use specified CSS class(es), such as <code>document.getElementsByClassName('red text-left')</code>.</p>
</dd>
<dt class="hdlist1"><code>document.querySelector(cssSelector)</code></dt>
<dd>
<p>Finds the first element that matches the provided CSS selector string. This comes in handy if you want to specify more-complex queries than just a class name; for example, <code>document.querySelector("style[type='text-left']");</code>.</p>
</dd>
<dt class="hdlist1"><code>document.querySelectorAll(cssSelector)</code></dt>
<dd>
<p>Finds all elements that match the provided CSS selector string.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The next code sample contains the HTML <code>&lt;span&gt;</code> element that has an ID of <code>emp</code>. Initially, it contains an ellipsis, but when the user enters the name in the input text field, the JavaScript code finds the reference to this <code>&lt;span&gt;</code> element and replaces the ellipsis with the content of the input text field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

	&lt;body&gt;
        &lt;h2&gt;Selecting DOM elements&lt;/h2&gt;

        &lt;p&gt;
        	The employee of the month is &lt;span id="emp"&gt;...&lt;/span&gt;
        &lt;br&gt;
        &lt;input type="button" value="Change the span value"
               onclick="setEmployeeOfTheMonth()"/&gt;
        Enter your name  &lt;input type="text" id="theName" /&gt;
        &lt;/p&gt;

        &lt;script&gt;
           function setEmployeeOfTheMonth(){

        	   var mySpan = document.getElementById("emp");

        	   var empName = document.getElementsByTagName("input")[1];

        	   mySpan.firstChild.nodeValue = empName.value;

        	}
        &lt;/script&gt;

	&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the input field of type <code>button</code>, which includes the <code>onclick</code> property that corresponds to the <code>click</code> event. When the user clicks the button, the browser dispatches the <code>click</code> event and calls the JavaScript function <code>setEmployeeOfTheMonth()</code>. The latter queries the DOM and finds the reference to the  <code>emp</code> by calling the method <code>getElementById()</code>. After that, the method <code>getElementByTagName()</code> is called, trying to find all the references to the HTML <code>&lt;input&gt;</code> elements. This method returns an array because there could be more than one element with the same tag name on a page, which explains the use of array notation. The first <code>&lt;input&gt;</code> element is a button, and the second is the text field in which we&#8217;re interested. Remember that arrays in JavaScript have zero-based indexes. <a href="#FIGaa19">Changing the content of the HTML &lt;span&gt; element</a> shows the web page after the user enters the name <em>Mary</em> and clicks the button.</p>
</div>
<div id="FIGaa19" class="imageblock">
<div class="content">
<img src="images/ewdv_aa19.png" alt="ewdv aa19">
</div>
<div class="title">Figure 19. Changing the content of the HTML &lt;span&gt; element</div>
</div>
<div class="paragraph">
<p>While manipulating the content of your web page, you might need to traverse the DOM tree. The code example that follows shows you an HTML document which includes JavaScript that walks the DOM and prints the name of each node. If a node has children, the recursive function <code>walkTheDOM()</code> will visit each child: </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

    &lt;body&gt;
     &lt;h1&gt;WalkTheDom.html&lt;/h1&gt;

     &lt;p&gt;
        Enter your name: &lt;input type="text"
                                name="customerName" id="custName" /&gt;
     &lt;/p&gt;

     &lt;input type="button" value="Walk the DOM"
                          onclick="walkTheDOM(document.body, processNode)"/&gt;

     &lt;script&gt;
        	function walkTheDOM(node, processNode){

                   processNode(node)
                    node = node.firstChild;

			      while(node){
			         // call wakTheDOM recursively for each child
			         walkTheDOM(node,processNode);
			         node = node.nextSibling;
			      }
            }

         function processNode(node){
            // the real code for node processing goes here

        	console.log("The current node name is "+  node.nodeName);
         }
      &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our function <code>processNode()</code> just prints the name of the current node, but you could implement any code that your web application requires.  Run this code in different browsers and check the output on the JavaScript console. <a href="#FIGaa20">Traversing the DOM in Internet Explorer and Firefox</a> depicts two screenshots taken in the F12 Developer Tools in Internet Explorer (left) and Firebug running in Firefox (right).</p>
</div>
<div id="FIGaa20" class="imageblock">
<div class="content">
<img src="images/ewdv_aa20.png" alt="ewdv aa20">
</div>
<div class="title">Figure 20. Traversing the DOM in Internet Explorer and Firefox</div>
</div>
<div class="paragraph">
<p>Even though some of the output is self-explanatory, there are a number of <code>#text</code> nodes that you won&#8217;t find in the preceding code sample. Unfortunately, web browsers treat whitespaces differently&#8212;&#8203;some ignore them, whereas others report them as DOM elements. Accordingly, different browsers insert a different number of text nodes in the DOM, representing whitespaces found in the HTML document. So you&#8217;re better off using one of the JavaScript frameworks for traversing the DOM the cross-browser way. For example, jQuery framework&#8217;s API for DOM traversing is listed at <a href="http://bit.ly/WXj2r2">http://bit.ly/WXj2r2</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Styling Web Pages with CSS</div>
<div class="paragraph">
<p><em>CSS</em> stands for <em>Cascading Style Sheets</em>. During the past 15 years, several CSS specifications reached the level of Recommendation by W3C: CSS Level 1, 2, and 2.1. The latest CSS Level 3 (a.k.a., CSS3) adds new features to CSS 2.1, module by module, which are listed at the <a href="http://bit.ly/1lsedgd">W3C website</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can find a CSS tutorial as well as tons of other learning resources at <a href="http://www.webplatform.org/">webplatform.org</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can include CSS in a web page by linking to separate files via the HTML tag <code>&lt;link&gt;</code>, or by inlining the styles with the tag <code>&lt;style&gt;</code>, or by using the <code>style</code> attribute in an HTML element (not recommended). For example, if CSS is located in the file <em>mystyles.css</em> in
the folder <em>css</em>, add the following tag to HTML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;link rel="stylesheet" type="text/css" href="css/mystyles.css" media="all"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>&lt;link&gt;</code> tag, you can specify the media where the specific CSS file has to be used. For example, you can have one CSS file for smartphones and another one for tablets. We discuss this in detail in <a href="#css_media_queries">[css_media_queries]</a>.</p>
</div>
<div class="paragraph">
<p>You should put this tag in the section of your HTML before any JavaScript code to make sure that the styles are loaded before the content of the web page.</p>
</div>
<div class="paragraph">
<p>Placing the <code>@import</code> attribute inside the <code>&lt;style&gt;</code> tag allows you to include styles located elsewhere:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;style&gt;
   @import url (css/contactus.css)
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>What’s the best way of including CSS in HTML? We recommend using CSS files. Keeping CSS in files separate from HTML and JavaScript makes the code more readable and reusable. You can argue that if your website consists of many files, the web browser will have to make multiple round trips to your server just to load all resources required by the HTML document, which can worsen the responsiveness of your web application. But usually all files are merged into one before deploying a web application in QA or production servers.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>HTML documents are often <em>prettified</em> by using CSS class selectors, and you can switch them programmatically with JavaScript.  Imagine that a <code>&lt;style&gt;</code> section has the following definition of two class selectors, <code>badStyle</code> and <code>niceStyle</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-css" data-lang="css">   &lt;style&gt;
   	 .badStyle{
      	font-family: Verdana;
      	font-size:small;
      	color:navy;
      	background-color:red;
    }

    .niceStyle{
      	font-family: Verdana;
      	font-size:large;
      	font-style:italic;
      	color:gray;
      	background-color:green;
    }
  &lt;/style&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any of these class selectors can be used by one or more HTML elements; for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;div id="header" class="badStyle"&gt;
   &lt;h1&gt;This is my header&lt;/h1&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Imagine that an important event has happened and the appearance the <code>&lt;div&gt;</code> styled as <code>badStyle</code> should programmatically change to &lt;niceStyle&gt;. In this case we need to find the <code>badStyle</code> element(s) first and change their style. The method <code>getElementsByClassName()</code> returns a set of elements that have the specified class name, and because our HTML has only one such element, the JavaScript will use the element zero from this set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">   	  document.getElementsByClassName("badStyle")[0].className="niceStyle";</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next example illustrates adding a new element to the DOM. Upon clicking a button, the code that follows dynamically creates an instance of type <code>img</code> and then assigns the location of the image to its <code>src</code> element. In a similar way, we could assign values to any other attributes of the <code>img</code> element, including <code>width</code>, <code>height</code>, or <code>alt</code>. The method <code>appendChild()</code> is applied to the &lt;body&gt; container, but it could be any other container that exists on the DOM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

    &lt;body&gt;
     &lt;h2&gt;Employee of the month&lt;/h2&gt;
        &lt;p&gt;
             &lt;input type="button" value="Show me"
                    onclick="setEmployeeOfTheMonth()"/&gt;
        &lt;/p&gt;

     &lt;script&gt;

         function setEmployeeOfTheMonth(){

           // Create an image and add it to the &lt;body&gt; element
           var empImage=document.createElement("img");
        	   empImage.setAttribute('src','resources/images/employee.jpg');
        	   document.body.appendChild(empImage);
        	}

     &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Some HTML elements such as <code>&lt;div&gt;</code> or &lt;span&gt;  contain other elements (children), and if you need to change their content, use their property <code>innerHTML</code>. For example, to delete the entire content of the document body, just do this: <code>document.body.innerHTML=""</code>. You can also use the method <code>appendChild()</code>, as shown in the preceding code sample.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you run this example and click the Show Me button, you&#8217;ll see an image of the employee of the month added to the <code>&lt;body&gt;</code> section of the HTML document, as shown in <a href="#FIGaa21">After clicking the Show Me button</a>.</p>
</div>
<div id="FIGaa21" class="imageblock">
<div class="content">
<img src="images/ewdv_aa21.png" alt="ewdv aa21">
</div>
<div class="title">Figure 21. After clicking the Show Me button</div>
</div>
</div>
<div class="sect3">
<h4 id="dom_events"><a class="anchor" href="#dom_events"></a>DOM Events</h4>
<div class="paragraph">
<p>The web browser will notify your application when changes or interactions occur. In such cases, the browser will dispatch an appropriate event (for example, <code>load</code>, <code>unload</code>, <code>mousemove</code>, <code>click</code>, and <code>keydown</code>). When the web page finishes loading, the browser dispatches the <code>load</code> event. When the user clicks a button on a web page, the <code>click</code> event is dispatched. A web developer needs to provide JavaScript code that will react to the events important to the application. The browser events will occur regardless of whether you provide the code to handle them. It&#8217;s important to understand some terms related to event processing.</p>
</div>
<div class="paragraph">
<p>An <em>event handler</em> (a.k.a. <em>event listener</em>) is JavaScript code that you want to be called as a response to this event. The last code sample in the previous section was processing the <code>click</code> event on the Show Me button as follows: <code>onclick="setEmployeeOfTheMonth()"</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Each HTML element has a certain number of predefined <em>event attributes</em>, which start with the prefix <code>on</code> followed by the name of the event. For example, <code>onclick</code> is an event attribute that you can use to specify the handler for the <code>click</code> event. You can find out what event attributes are available in the online document <a href="http://www.w3.org/TR/DOM-Level-3-Events//">"Document Object Model Events."</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The preferred way of adding event listeners was introduced in the DOM Level 2 specification back in 2000. You should find the HTML element in the DOM and then assign the event listener to it by calling the method <code>addEventListener()</code>. (This is done differently in Internet Explorer earlier than version 9.) For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">document.getElementById("myButton").addEventListener("click",
                                                     setEmployeeOfTheMonth);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The advantage of using this programmatic assignment of event listeners is that this can be done for all controls in a central place&#8212;&#8203;for example, in a JavaScript function that runs immediately after the web page completes loading. Another advantage is that you can programmatically remove the event listener if it&#8217;s no longer needed by invoking <code>removeEventListener()</code>. The following example is a rewrite of the last example from the previous section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

    &lt;body&gt;
     &lt;h2&gt;Employee of the month&lt;/h2&gt;
        &lt;p&gt;
             &lt;input type="button" value="Show me" id="myButton"/&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/p&gt;

     &lt;script&gt;
         window.onload=function(){         <i class="conum" data-value="2"></i><b>(2)</b>
         	document.getElementById("myButton").addEventListener("click",
           	                                      setEmployeeOfTheMonth);
         }

         function setEmployeeOfTheMonth(){

           // Create an image and add it to the &lt;body&gt; element
           var empImage=document.createElement("img");
        	   empImage.setAttribute('src','resources/images/employee.jpg');
        	   document.body.appendChild(empImage);

        	 document.getElementById("myButton").removeEventListener("click",
           	                                 setEmployeeOfTheMonth); <i class="conum" data-value="3"></i><b>(3)</b>
        	}

     &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Compare this button with the one from the previous section: the event handler is removed, but it has an ID now.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When the web page completes loading, a <code>load</code> event is dispatched and the function attached to the event attribute <code>onload</code> assigns the event handler for the button 'click' event. Note that we are passing the callback <code>setEmployeeOfTheMonth</code> as the second argument of the <code>addEventListener()</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Removing the event listener after the image of the employee of the month has been added. Without this line, each click of the button would add to the web page yet another copy of the same image.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each event goes through three phases: <em>capture</em>, <em>target</em>, and <em>bubble</em>. It&#8217;s easier to explain this concept by example. Imagine that a button is located inside <code>&lt;div&gt;</code>, which is located inside the <code>&lt;body&gt;</code> container. When you click the button, the event travels to the button through all enclosing containers, and this is the capture phase. You can intercept the event at one of these containers even before it reaches the button if need be. For example, your application logic might need to prevent the button from being clicked if a certain condition occurs.</p>
</div>
<div class="paragraph">
<p>Then, the event reaches the button; this is the target phase. After the event is handled by the button&#8217;s <code>click</code> handler, the event bubbles up through the enclosing containers; this is the bubble phase. You can create listeners and handle this event after the button finishes its processing at the target phase. The next code sample is based on the previous one, but it demonstrates the event processing in all three phases.</p>
</div>
<div class="paragraph">
<p>Note that if your event handler function is declared by using the event parameter, it will receive the <code>Event</code> object (not in Internet Explorer 8), which contains a number of useful parameters. For more information refer, to <a href="http://www.w3.org/TR/DOM-Level-3-Events/">"Document Object Model Events."</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

    &lt;body&gt;
     &lt;h2&gt;Employee of the month&lt;/h2&gt;
        &lt;div id="myDiv"&gt;
             &lt;input type="button" value="Show me" id="myButton"/&gt;
        &lt;/div&gt;

     &lt;script&gt;
         window.onload=function(){
         	document.getElementById("myButton").addEventListener("click",
           	                                setEmployeeOfTheMonth);

        	document.getElementById("myDiv").addEventListener("click",
           	                                processDivBefore, true); <i class="conum" data-value="1"></i><b>(1)</b>
        	document.getElementById("myButton").addEventListener("click",
           	                                processDivAfter);

         }

         function setEmployeeOfTheMonth(){

           console.log("Got the click event in target phase");

           // Create an image and add it to the &lt;body&gt; element
           var empImage=document.createElement("img");
        	   empImage.setAttribute('src','resources/images/employee.jpg');
        	   document.body.appendChild(empImage);

        	 document.getElementById("myButton").removeEventListener("click",
           	                                    setEmployeeOfTheMonth);
        	}

         function processDivBefore(evt){
         	console.log("Intercepted the click event in capture phase");

         	// Cancel the click event so the button won't get it

         	// if (evt.preventDefault) evt.preventDefault();        <i class="conum" data-value="2"></i><b>(2)</b>
         	// if (evt.stopPropagation) evt.stopPropagation();
         }

         function processDivAfter(){
         	console.log("Got the click event in bubble phase");
         }
     &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We&#8217;ve added two event handlers on the <code>&lt;div&gt;</code> level. The first one intercepts the event in the capture phase. When the third argument of <code>addEventListener()</code> is true, this handler kicks in during the capture phase.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If you uncomment these two lines, the default behavior of the <code>click</code> event will be cancelled and it won&#8217;t reach the button at all. Unfortunately, browsers might have different methods, implementing <em>prevent default</em> functionality, so additional if statements are needed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Running the preceding example causes the following output in the JavaScript console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">Intercepted the click event in capture phase
Got the click event in target phase
Got the click event in bubble phase</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see another example of intercepting the event during the capture phase in <a href="#first_ver_of_home_page">[first_ver_of_home_page]</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The Microsoft web browsers Internet Explorer 8 and below didn&#8217;t implement the W3C DOM Level 3 event model;  they handled events differently. You can read more on the subject in this <a href="http://bit.ly/1p9BCXP">MSDN article</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h3>
<div class="paragraph">
<p>This appendix covered the JavaScript language constructs that any professional web developer should know. A smaller portion of this appendix illustrated how to combine JavaScript, HTML, and CSS. There are many online resources and books that cover just the HTML markup and CSS, and you&#8217;ll definitely need to spend more time mastering details of web tools such as Firebug or Google Developer Tools.</p>
</div>
<div class="paragraph">
<p>Software developers who are coming from strongly typed compiled languages might have a feeling that their productivity drops with JavaScript. We can recommend several medications for this. First, become familiar with the language called CoffeeScript. As respected Java developer James Ward put it, "CoffeeScript is <em>the</em> way to write JavaScript." This language is similar to JavaScript and is easy to learn if you understand the JavaScript syntax; it supports classes and is compiled into JavaScript. Visit <a href="http://coffeescript.org/">coffescript.org</a> to see CoffeeScript code snippets and their equivalents in JavaScript.</p>
</div>
<div class="paragraph">
<p>Another interesting language to learn is Microsoft&#8217;s TypeScript (it&#8217;s an open source project). This language is also an extension of JavaScript with added classes, interfaces, and inheritance. It also gets compiled into JavaScript and allows developers to write strongly typed code. TypeScript increases productivity of developers because it helps identify lots of errors related to incorrect types during the compilation phase. TypeScript implements many constructs from ECMAScript 6 and can serve as an example of the JavaScript of the future.</p>
</div>
<div class="paragraph">
<p>Probably the most interesting new programming language is Google&#8217;s <a href="http://www.dartlang.org/">Dart</a>. This is a compiled language with all object-oriented features: classes, objects, abstract classes, and inheritance. The compiled code runs inside the VM, and Google supports it in the Chrome browser. What about the other browsers? The web application is deployed as a script that automatically checks whether the browser supports Dart. If it does, the compiled code will be sent to the client; otherwise, the Dart code will be automatically compiled into JavaScript, and from the browser&#8217;s perspective nothing but a JavaScript engine is required. You can perform server-side programming in Dart, too. JetBrains WebStorm, our IDE of choice, supports CoffeeScript, Dart, and TypeScript.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2014-12-20 17:19:02 PST
</div>
</div>
</body>
</html>