<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Selected HTML5 APIs</title>
<style>
@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
@import url(http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic);
/* normalize.css v2.1.1 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address styling not present in IE 8/9. */
[hidden] { display: none; }

/* ========================================================================== Base ========================================================================== */
/** 1. Prevent system color scheme's background color being used in Firefox, IE, and Opera. 2. Prevent system color scheme's text color being used in Firefox, IE, and Opera. 3. Set default font family to sans-serif. 4. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { background: #fff; /* 1 */ color: #000; /* 2 */ font-family: sans-serif; /* 3 */ -ms-text-size-adjust: 100%; /* 4 */ -webkit-text-size-adjust: 100%; /* 4 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

a:focus { outline: none; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

/* Grid HTML Classes */
.row { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; }
.row:before, .row:after { content: " "; display: table; }
.row:after { clear: both; }
.row.collapse .column, .row.collapse .columns { position: relative; padding-left: 0; padding-right: 0; float: left; }
.row .row { width: auto; margin-left: -0.9375em; margin-right: -0.9375em; margin-top: 0; margin-bottom: 0; max-width: none; *zoom: 1; }
.row .row:before, .row .row:after { content: " "; display: table; }
.row .row:after { clear: both; }
.row .row.collapse { width: auto; margin: 0; max-width: none; *zoom: 1; }
.row .row.collapse:before, .row .row.collapse:after { content: " "; display: table; }
.row .row.collapse:after { clear: both; }

.column, .columns { position: relative; padding-left: 0.9375em; padding-right: 0.9375em; width: 100%; float: left; }

@media only screen { .column, .columns { position: relative; padding-left: 0.9375em; padding-right: 0.9375em; float: left; }
  .small-1 { position: relative; width: 8.33333%; }
  .small-2 { position: relative; width: 16.66667%; }
  .small-3 { position: relative; width: 25%; }
  .small-4 { position: relative; width: 33.33333%; }
  .small-5 { position: relative; width: 41.66667%; }
  .small-6 { position: relative; width: 50%; }
  .small-7 { position: relative; width: 58.33333%; }
  .small-8 { position: relative; width: 66.66667%; }
  .small-9 { position: relative; width: 75%; }
  .small-10 { position: relative; width: 83.33333%; }
  .small-11 { position: relative; width: 91.66667%; }
  .small-12 { position: relative; width: 100%; }
  .small-offset-0 { position: relative; margin-left: 0%; }
  .small-offset-1 { position: relative; margin-left: 8.33333%; }
  .small-offset-2 { position: relative; margin-left: 16.66667%; }
  .small-offset-3 { position: relative; margin-left: 25%; }
  .small-offset-4 { position: relative; margin-left: 33.33333%; }
  .small-offset-5 { position: relative; margin-left: 41.66667%; }
  .small-offset-6 { position: relative; margin-left: 50%; }
  .small-offset-7 { position: relative; margin-left: 58.33333%; }
  .small-offset-8 { position: relative; margin-left: 66.66667%; }
  .small-offset-9 { position: relative; margin-left: 75%; }
  .small-offset-10 { position: relative; margin-left: 83.33333%; }
  [class*="column"] + [class*="column"]:last-child { float: right; }
  [class*="column"] + [class*="column"].end { float: left; }
  .column.small-centered, .columns.small-centered { position: relative; margin-left: auto; margin-right: auto; float: none !important; } }
/* Styles for screens that are atleast 768px; */
@media only screen and (min-width: 768px) { .large-1 { position: relative; width: 8.33333%; }
  .large-2 { position: relative; width: 16.66667%; }
  .large-3 { position: relative; width: 25%; }
  .large-4 { position: relative; width: 33.33333%; }
  .large-5 { position: relative; width: 41.66667%; }
  .large-6 { position: relative; width: 50%; }
  .large-7 { position: relative; width: 58.33333%; }
  .large-8 { position: relative; width: 66.66667%; }
  .large-9 { position: relative; width: 75%; }
  .large-10 { position: relative; width: 83.33333%; }
  .large-11 { position: relative; width: 91.66667%; }
  .large-12 { position: relative; width: 100%; }
  .row .large-offset-0 { position: relative; margin-left: 0%; }
  .row .large-offset-1 { position: relative; margin-left: 8.33333%; }
  .row .large-offset-2 { position: relative; margin-left: 16.66667%; }
  .row .large-offset-3 { position: relative; margin-left: 25%; }
  .row .large-offset-4 { position: relative; margin-left: 33.33333%; }
  .row .large-offset-5 { position: relative; margin-left: 41.66667%; }
  .row .large-offset-6 { position: relative; margin-left: 50%; }
  .row .large-offset-7 { position: relative; margin-left: 58.33333%; }
  .row .large-offset-8 { position: relative; margin-left: 66.66667%; }
  .row .large-offset-9 { position: relative; margin-left: 75%; }
  .row .large-offset-10 { position: relative; margin-left: 83.33333%; }
  .row .large-offset-11 { position: relative; margin-left: 91.66667%; }
  .push-1 { position: relative; left: 8.33333%; right: auto; }
  .pull-1 { position: relative; right: 8.33333%; left: auto; }
  .push-2 { position: relative; left: 16.66667%; right: auto; }
  .pull-2 { position: relative; right: 16.66667%; left: auto; }
  .push-3 { position: relative; left: 25%; right: auto; }
  .pull-3 { position: relative; right: 25%; left: auto; }
  .push-4 { position: relative; left: 33.33333%; right: auto; }
  .pull-4 { position: relative; right: 33.33333%; left: auto; }
  .push-5 { position: relative; left: 41.66667%; right: auto; }
  .pull-5 { position: relative; right: 41.66667%; left: auto; }
  .push-6 { position: relative; left: 50%; right: auto; }
  .pull-6 { position: relative; right: 50%; left: auto; }
  .push-7 { position: relative; left: 58.33333%; right: auto; }
  .pull-7 { position: relative; right: 58.33333%; left: auto; }
  .push-8 { position: relative; left: 66.66667%; right: auto; }
  .pull-8 { position: relative; right: 66.66667%; left: auto; }
  .push-9 { position: relative; left: 75%; right: auto; }
  .pull-9 { position: relative; right: 75%; left: auto; }
  .push-10 { position: relative; left: 83.33333%; right: auto; }
  .pull-10 { position: relative; right: 83.33333%; left: auto; }
  .push-11 { position: relative; left: 91.66667%; right: auto; }
  .pull-11 { position: relative; right: 91.66667%; left: auto; }
  .column.large-centered, .columns.large-centered { position: relative; margin-left: auto; margin-right: auto; float: none !important; }
  .column.large-uncentered, .columns.large-uncentered { margin-left: 0; margin-right: 0; float: left !important; }
  .column.large-uncentered.opposite, .columns.large-uncentered.opposite { float: right !important; } }
/* Image Thumbnails */
.th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); -webkit-transition: all 200ms ease-out; -moz-transition: all 200ms ease-out; transition: all 200ms ease-out; }
.th:hover, .th:focus { -webkit-box-shadow: 0 0 6px 1px rgba(43, 166, 203, 0.5); box-shadow: 0 0 6px 1px rgba(43, 166, 203, 0.5); }
.th.radius { -webkit-border-radius: 3px; border-radius: 3px; }

a.th { display: inline-block; }

button, .button { border-style: solid; border-width: 1px; cursor: pointer; font-family: inherit; font-weight: bold; line-height: 1; margin: 0 0 1.25em; position: relative; text-decoration: none; text-align: center; display: inline-block; padding-top: 0.75em; padding-right: 1.5em; padding-bottom: 0.8125em; padding-left: 1.5em; font-size: 1em; background-color: #2ba6cb; border-color: #2284a1; color: white; }
button:hover, button:focus, .button:hover, .button:focus { background-color: #2284a1; }
button:hover, button:focus, .button:hover, .button:focus { color: white; }
button.secondary, .button.secondary { background-color: #e9e9e9; border-color: #d0d0d0; color: #333333; }
button.secondary:hover, button.secondary:focus, .button.secondary:hover, .button.secondary:focus { background-color: #d0d0d0; }
button.secondary:hover, button.secondary:focus, .button.secondary:hover, .button.secondary:focus { color: #333333; }
button.success, .button.success { background-color: #5da423; border-color: #457a1a; color: white; }
button.success:hover, button.success:focus, .button.success:hover, .button.success:focus { background-color: #457a1a; }
button.success:hover, button.success:focus, .button.success:hover, .button.success:focus { color: white; }
button.alert, .button.alert { background-color: #c60f13; border-color: #970b0e; color: white; }
button.alert:hover, button.alert:focus, .button.alert:hover, .button.alert:focus { background-color: #970b0e; }
button.alert:hover, button.alert:focus, .button.alert:hover, .button.alert:focus { color: white; }
button.large, .button.large { padding-top: 1em; padding-right: 2em; padding-bottom: 1.0625em; padding-left: 2em; font-size: 1.25em; }
button.small, .button.small { padding-top: 0.5625em; padding-right: 1.125em; padding-bottom: 0.625em; padding-left: 1.125em; font-size: 0.8125em; }
button.tiny, .button.tiny { padding-top: 0.4375em; padding-right: 0.875em; padding-bottom: 0.5em; padding-left: 0.875em; font-size: 0.6875em; }
button.expand, .button.expand { padding-right: 0px; padding-left: 0px; width: 100%; }
button.left-align, .button.left-align { text-align: left; text-indent: 0.75em; }
button.right-align, .button.right-align { text-align: right; padding-right: 0.75em; }
button.disabled, button[disabled], .button.disabled, .button[disabled] { background-color: #2ba6cb; border-color: #2284a1; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { background-color: #2284a1; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { color: white; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { background-color: #2ba6cb; }
button.disabled.secondary, button[disabled].secondary, .button.disabled.secondary, .button[disabled].secondary { background-color: #e9e9e9; border-color: #d0d0d0; color: #333333; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { background-color: #d0d0d0; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { color: #333333; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { background-color: #e9e9e9; }
button.disabled.success, button[disabled].success, .button.disabled.success, .button[disabled].success { background-color: #5da423; border-color: #457a1a; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { background-color: #457a1a; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { color: white; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { background-color: #5da423; }
button.disabled.alert, button[disabled].alert, .button.disabled.alert, .button[disabled].alert { background-color: #c60f13; border-color: #970b0e; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { background-color: #970b0e; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { color: white; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { background-color: #c60f13; }

button, .button { padding-top: 0.8125em; padding-bottom: 0.75em; -webkit-appearance: none; }
button.tiny, .button.tiny { padding-top: 0.5em; padding-bottom: 0.4375em; -webkit-appearance: none; }
button.small, .button.small { padding-top: 0.625em; padding-bottom: 0.5625em; -webkit-appearance: none; }
button.large, .button.large { padding-top: 1.03125em; padding-bottom: 1.03125em; -webkit-appearance: none; }

@media only screen { button, .button { -webkit-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset; box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset; -webkit-transition: background-color 300ms ease-out; -moz-transition: background-color 300ms ease-out; transition: background-color 300ms ease-out; }
  button:active, .button:active { -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2) inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2) inset; }
  button.radius, .button.radius { -webkit-border-radius: 3px; border-radius: 3px; }
  button.round, .button.round { -webkit-border-radius: 1000px; border-radius: 1000px; } }
@media only screen and (min-width: 768px) { button, .button { display: inline-block; } }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #003b6b; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #00579e; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-weight: normal; font-style: normal; color: #7b2d00; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #ff6b15; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #003426; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; }

ul, ol { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #e15200; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #e15200; }

blockquote, blockquote p { line-height: 1.6; color: #333333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: -webkit-linear-gradient(top, #add386, #90b66a); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: white; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #edf2f2; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 3px 2px 1px 2px; white-space: nowrap; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.6; color: black; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

kbd.keyseq { color: #333333; }

kbd:not(.keyseq) { display: inline-block; color: black; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: black; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: #7b2d00; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #333333; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #003b6b; }

@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #7b2d00; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #622400; }

.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #333333; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #aaaaaa; box-shadow: 0 1px 8px #aaaaaa; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #003b6b; margin-top: 0; line-height: 1.6; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock > .content pre, .listingblock > .content pre { background: #eeeeee; border-width: 1px; border-style: dashed; border-color: #666666; -webkit-border-radius: 0; border-radius: 0; padding: 1.25em 1.5625em 1.125em 1.5625em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.72em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.81em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 0.75em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #e15200; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

p.tableblock.header { color: white; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.375em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #004985; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #00579e; color: #004176; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }

body { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-size: 16px; color: #111; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #dddddd; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#appendix_b">Appendix A: Selected HTML5 APIs</a>
<ul class="sectlevel2">
<li><a href="#_does-your-browser-support-html5">Does Your Browser Support HTML5?</a></li>
<li><a href="#_handling-differences-in-browsers">Handling Differences in Browsers</a></li>
<li><a href="#_html5-web-messaging-api">HTML5 Web Messaging API</a>
<ul class="sectlevel3">
<li><a href="#_sending-and-receiving-messages">Sending and Receiving Messages</a></li>
<li><a href="#_communicating-with-an-iframe">Communicating with an iFrame</a></li>
<li><a href="#_applying-the-mediator-design-pattern">Applying the Mediator Design Pattern</a></li>
</ul>
</li>
<li><a href="#_web-workers-api">Web Workers API</a>
<ul class="sectlevel3">
<li><a href="#_creating-and-communicating-with-workers">Creating and Communicating with Workers</a></li>
<li><a href="#_dedicated-and-shared-workers">Dedicated and Shared Workers</a></li>
</ul>
</li>
<li><a href="#_the-websocket-api">The WebSocket API</a></li>
<li><a href="#_offline-web-applications">Offline Web Applications</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites-for-developing-offline-web-applications">Prerequisites for Developing Offline Web Applications</a></li>
<li><a href="#application_cache">Application Cache API</a></li>
<li><a href="#_is-your-application-offline">Is Your Application Offline?</a></li>
<li><a href="#_options-for-storing-data-locally">Options for Storing Data Locally</a></li>
<li><a href="#_web-storage-specification-apis">Web Storage Specification APIs</a></li>
<li><a href="#_introduction-to-indexeddb">Introduction to IndexedDB</a></li>
</ul>
</li>
<li><a href="#_the-history-api">The History API</a>
<ul class="sectlevel3">
<li><a href="#_modifying-the-browser-s-history-by-using-pushstate">Modifying the Browser&#8217;s History by Using pushState()</a></li>
<li><a href="#_processing-the-popstate-event">Processing the popstate Event</a></li>
</ul>
</li>
<li><a href="#_summary">Summary</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="appendix_b"><a class="anchor" href="#appendix_b"></a>Appendix A: Selected HTML5 APIs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix is a brief review of selected HTML5 APIs. <em>HTML5</em> is just a commonly used term for a combination of HTML, JavaScript, CSS, and several new APIs that appeared during the last several years. Five years ago, people were using the term <em>Web 2.0</em> to define modern-looking applications. These days, HTML5 is almost a household name, and we&#8217;ll go along with it. But HTML5 is about the same old development in JavaScript plus the latest advances in HTML and CSS.</p>
</div>
<div class="paragraph">
<p>This appendix is more of an overview of selected APIs that are included in the HTML5 specification&#8212;&#8203;namely, Web Messaging, Web Storage, Application Cache, IndexedDB, localStorage, Web Workers, and History APIs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To understand the code samples included in this appendix, you must be familiar with JavaScript and some monitoring tools such as Chrome Developer Tools. We assume that you are familiar with the materials covered in the bonus online chapter.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_does-your-browser-support-html5"><a class="anchor" href="#_does-your-browser-support-html5"></a>Does Your Browser Support HTML5?</h3>
<div class="paragraph">
<p>The majority of modern web browsers already support the current version of the <a href="http://bit.ly/1oEqN0z">HTML5 specification</a>, which will become a World Wide Web Consortium (W3C) standard in 2014. The question is whether the users of your web application have a modern browser installed on their device. There are two groups of users who will stick to outdated browsers for some time:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Less technically savvy people might be afraid of installing any new software on their PCs, especially people of the older generation. <em>"John, after the last visit of our grandson, our computer works even slower than before. Please don&#8217;t let him install these new fancy browsers here. I just need my old Internet Explorer, access to Hotmail and Facebook."</em></p>
</li>
<li>
<p>Business users working for large corporations, where all software installations on their PCs are done by a dedicated technical support team. They say, <em>"We have 50,000 PCs in our firm. An upgrade from Internet Explorer version 8 to version 9 is a major undertaking. Internal users work with hundreds of web applications on a regular basis. They can install whatever browser they want, but if some of these applications won&#8217;t work as expected, the users will flood us with support requests we&#8217;re not qualified to resolve</em>. Hence, the strategy of using the lowest common denominator browser often wins.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Often web developers need to make both of these groups of users happy. Take, for example, online banking: an old couple has to be able to use your web application from their old PCs; otherwise, they will transfer their life savings to a different bank that doesn&#8217;t require, say, the latest version of Firefox be installed.</p>
</div>
<div class="paragraph">
<p>Does it mean that enterprise web developers shouldn&#8217;t even bother using HTML5 that&#8217;s not 100 percent supported? Not at all. This means that a substantial portion of their application&#8217;s code will be bloated with if statements trying to determine what this specific web browser supports and providing several solutions that keep your application properly running in any web browser. This is what makes the job of DHTML developers a lot more difficult than that of, say, Java or .NET developers who know exactly the VM where their code will work. If you don&#8217;t install the Java Runtime of version 1.6, our application won&#8217;t work. It&#8217;s as simple as that. How about asking Java developers to write applications that will work in any runtime released during the past 10 years? No, we&#8217;re not that nasty.</p>
</div>
<div class="paragraph">
<p>Do you believe it would be a good idea for Amazon or Facebook to rewrite their UIs in Java? Of course not, unless those companies want to lose most of their customers, who will be scared to death after seeing a message from a 20-step Java installer asking to access the internals of their computer. Each author of this book is a Java developer, and we love using Java&#8212;&#8203;on the server side. But when it comes to the consumer-facing web applications, there are better choices.</p>
</div>
<div class="paragraph">
<p>The bottom line is that we have to learn how to develop web applications that won&#8217;t require installing any new software on user&#8217;s machines. In web browsers, it&#8217;s DHTML, or in the modern terminology, it&#8217;s the HTML5 stack.</p>
</div>
<div class="paragraph">
<p>In the unfortunate event that you need to support both new and old HTML and CSS implementations, you can use <a href="http://html5boilerplate.com">HTML5 Boilerplate</a> that is not a framework, but a template for creating a new HTML project that will support HTML5 and CSS3 elements and yet will work even in the hostile environments of the older browsers. It&#8217;s like broadcasting a TV show in HD, but letting the cavemen with the 50-year-old black-and-white tubes watch it, too.</p>
</div>
<div class="paragraph">
<p>HTML Boilerplate comes with a simple way to start your project, prepackaged with solutions and workarounds offered by well-known gurus in the industry. Make no mistake, your code base might be larger than you wanted (for example, the initial CSS starts with 500 lines accommodating the old and new browsers), but it might be your safety net.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Watch <a href="http://bit.ly/1nutL8e">this screencast by Paul Irish</a>, a co-creator of HTML5 Boilerplate. You can also read the current version of the <a href="http://bit.ly/TPQeSF">Getting started with HTML5 Boilerplate</a> on GitHub.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_handling-differences-in-browsers"><a class="anchor" href="#_handling-differences-in-browsers"></a>Handling Differences in Browsers</h3>
<div class="paragraph">
<p>This appendix is about selected HTML APIs that we find important to understand in web applications. But before using any of the APIs listed here, you should check whether the versions of the web browsers you have support these APIs. The website <a href="http://caniuse.com">http://caniuse.com</a> will give you up-to-date information about all major browsers and their versions that do (or don&#8217;t) support the API in question. For example, to see which browsers support the Web Workers API, visit <a href="http://caniuse.com/#search=Worker">caniuse.com</a>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s a good practice to include in your code a line that tests whether a specific API is supported. For example, if the following if statement returns false, the Web Workers API is not supported and the code should fall back to a single-threaded processing mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">if (window.Worker) {
   // create a Worker instance to execute your
   // script in a separate thread
) else{
	// tough luck, fallback to a single–threaded mode
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#mocking_up_the_app">[mocking_up_the_app]</a> demonstrates the feature-detection tool <em>Modernizr</em> with which you can programmatically check whether a particular HTML5 API is supported by the browser being used: </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">if (Modernizr.Worker) {
   // create a Worker instance to execute your
   // script in a separate thread
)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_html5-web-messaging-api"><a class="anchor" href="#_html5-web-messaging-api"></a>HTML5 Web Messaging API</h3>
<div class="paragraph">
<p>With <a href="http://bit.ly/1z26wIa">HTML5 Web Messaging</a>, you can arrange for communication between different web pages of the same web application. More officially, it&#8217;s about "communicating between browsing contexts in HTML documents." Web messaging also allows you to work around the "same domain" policy that would result in a security error if a browser&#8217;s page A has one origin (the combination of URL scheme, hostname, and port, for example, <a href="http://myserver.com:8080" class="bare">http://myserver.com:8080</a>) and tries to access the property of page B that was downloaded from another origin. But with the Messaging API, windows downloaded from different origins can send messages to each other.</p>
</div>
<div class="sect3">
<h4 id="_sending-and-receiving-messages"><a class="anchor" href="#_sending-and-receiving-messages"></a>Sending and Receiving Messages</h4>
<div class="paragraph">
<p>The API is fairly straightforward: if a script in the page <code>WindowA</code> has a reference to <code>WindowB</code> where you want to send a message, invoke the following method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript"> myWindowB.postMesage(someData, targetOrigin);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The object referenced by <code>myWindowB</code> will receive an event object with the content of payload <code>someData</code> in the event&#8217;s property <code>data</code>.  The <code>targetOrigin</code> specifies the origin from which <code>myWindowB</code> was downloaded.</p>
</div>
<div class="paragraph">
<p>Specifying a concrete URI of the destination window in <code>targetOrigin</code> is the right way to do messaging. This way, if a malicious site tries to intercept the message, it won&#8217;t be delivered because the URI specified in <code>targetOrigin</code> is different from the malicious site&#8217;s URI. But if you&#8217;re absolutely sure that your application is operating in an absolutely safe environment, you can specify <code>"*"</code> as <code>targetOrigin</code>.</p>
</div>
<div class="paragraph">
<p>Accordingly, <code>myWindowB</code> has to define an event handler for processing this external event <code>message</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">window.addEventListener('message', myEventHandler, false);

function myEventHandler(event){
	console.log(`Received something: ` + event.data);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_communicating-with-an-iframe"><a class="anchor" href="#_communicating-with-an-iframe"></a>Communicating with an iFrame</h4>
<div class="paragraph">
<p>Let&#8217;s consider an example in which an HTML window creates an iFrame and needs to communicate with it. In particular, the iFrame will notify the main window that it has loaded, and the main window will acknowledge receiving this message.</p>
</div>
<div class="paragraph">
<p>The iFrame has two buttons, emulating a trading system with two buttons: Buy and Sell. When the user clicks one of these iFrame buttons, the main window has to confirm receiving the buy or sell request. <a href="#FIG1-1">Message exchange between the window and iFrame</a> is a screenshot from a Chrome browser; the Developer Tools panel
 shows the output on the console after the iFrame is loaded and the user clicks the Buy and Sell buttons.</p>
</div>
<div id="FIG1-1" class="imageblock">
<div class="content">
<img src="images/ewdv_ab01.png" alt="ewdv ab01">
</div>
<div class="title">Figure 1. Message exchange between the window and iFrame</div>
</div>
<div class="paragraph">
<p>The source code of this example is shown next. It&#8217;s just two HTML files: <em>mainWindow.html</em> and <em>myFrame.html</em>. Here&#8217;s the code of <em>mainWindow.html</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    &lt;title&gt;The main Window&lt;/title&gt;
&lt;/head&gt;

&lt;body bgcolor="cyan"&gt;

    &lt;h1&gt;This is Main Window &lt;/h1&gt;

    &lt;iframe id="myFrame"&gt;
        &lt;p&gt;Some page content goes here&lt;/p&gt;
    &lt;/iframe&gt;

   &lt;script type="text/javascript"&gt;
        var theiFrame;

        function handleMessage(event) {              <i class="conum" data-value="1"></i><b>(1)</b>
                console.log('Main Window got the message ' +
                                     event.data );

             // Reply to the frame here
             switch (event.data) {                   <i class="conum" data-value="2"></i><b>(2)</b>

                case 'loaded':
                   theiFrame.contentWindow.postMessage(
                                    "Hello my frame! Glad you loaded! ",
                                    event.origin);   <i class="conum" data-value="3"></i><b>(3)</b>
                   break;
                case 'buy':
                   theiFrame.contentWindow.postMessage(
                               "Main Window confirms the buy request ",
                               event.origin);
                   break;
                case 'sell':
                   theiFrame.contentWindow.postMessage(
                               "Main Window confirms the sell request. ",
                               event.origin);
                   break;
             }
        }

        window.onload == function() {                 <i class="conum" data-value="4"></i><b>(4)</b>
            window.addEventListener('message', handleMessage, false);
            theiFrame == document.getElementById('myFrame');
            theiFrame.src == "myFrame.html";
        }

   &lt;/script&gt;

 &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This function is an event handler for messages received from the iFrame window. The main window is the parent of iFrame, and whenever the latter invokes <code>parent.postMessage()</code>, this event handler will be engaged.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Depending on the content of the message payload (<code>event.data</code>),	respond to the sender with an acknowledgment. If the payload is <code>loaded</code>, this means that the iFrame has finished loading. If it&#8217;s <code>buy</code> or <code>sell</code>, this means that the corresponding button in the iFrame has been clicked. As an additional precaution, you can ensure that <code>event.origin</code> has the expected URI before even starting processing received events.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Although this code shows how a window sends a message to an iFrame, you can send messages to any other window as long as you have a reference to it. For example:</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>On loading, the main window starts listening to messages from other windows and loads the content of the iFrame.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To implement error processing, add a handler for the <code>window.onerror</code> property.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The code of <em>myFrame.html</em> comes next. This frame contains two buttons, Buy and Sell, but there is no business logic to buy or sell anything. The role of these buttons is just to deliver the message to the creator of the iFrame that it&#8217;s time to buy or sell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

 &lt;body bgcolor="white"&gt;

    &lt;h2&gt; This is My Frame Window &lt;/h2&gt;

    &lt;button type="buy" onclick="sendToParent('buy')"&gt;Buy&lt;/button&gt;
    &lt;button type="sell" onclick="sendToParent('sell')"&gt;Sell&lt;/button&gt;

  &lt;script type="text/javascript"&gt;

        var senderOrigin == null;

        function handleMessageInFrame(event) {
                console.log('   My Frame got the message from ' +
                 event.origin +": " + event.data);
                if (senderOrigin === null) senderOrigin == event.origin; <i class="conum" data-value="1"></i><b>(1)</b>
        }

        window.onload == function(){
        	window.addEventListener('message', handleMessageInFrame, false);
            parent.postMessage('loaded', "*");  <i class="conum" data-value="2"></i><b>(2)</b>
        };

        function sendToParent(action){
        	parent.postMessage(action,  senderOrigin);        <i class="conum" data-value="3"></i><b>(3)</b>
        }

    &lt;/script&gt;
 &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When the iFrame receives the first message from the parent, store the reference to the sender&#8217;s origin.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Notify the parent that the iFrame is loaded. The target origin is specified as "*" here as an illustration of how to send messages without worrying about malicious site-interceptors; always specify the target URI as it&#8217;s done in the function <code>sendToParent()</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Send the message to the parent window when the user clicks the Buy or Sell button.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you need to build a UI of the application from reusable components, applying messaging techniques makes it possible for you to create loosely coupled components. Suppose that you&#8217;ve created a window for a financial trader. This window receives the data push from the server, showing the latest stock prices. When a trader likes the price, he can click the Buy or Sell button to initiate a trade. The order to trade can be implemented in a separate window, and establishing interwindow communications in a loosely coupled manner is really important.</p>
</div>
</div>
<div class="sect3">
<h4 id="_applying-the-mediator-design-pattern"><a class="anchor" href="#_applying-the-mediator-design-pattern"></a>Applying the Mediator Design Pattern</h4>
<div class="paragraph">
<p>Three years ago, O&#8217;Reilly published another book written by us titled <em>Enterprise Development with Flex</em>. In particular, it described how to apply the Mediator design pattern to create a UI where components can communicate with one another by sending-receiving events from the <em>mediator</em> object.  The Mediator pattern remains very important in developing UIs by using any technologies or programming languages, and the importance of HTML5 messaging can&#8217;t be underestimated.</p>
</div>
<div class="paragraph">
<p><a href="#FIG1-2">Before and after the trader clicks the Price panel</a> is an illustration from that Enterprise Flex book. The Price panel on the left gets the data feed about current prices of IBM stock. When the user clicks the Bid or Ask button, the Price panel just sends the event with the relevant information (for example, a JSON-formatted string containing the stock symbol, price, buy or sell flag, or date). In this particular case, the window that contains these two panels serves as a mediator. In the HTML5 realm, we can say that the Price panel invokes <code>parent.postMessage()</code> and shoots the message to the mediator (a.k.a. main window).</p>
</div>
<div id="FIG1-2" class="imageblock">
<div class="content">
<img src="images/ewdv_ab02.png" alt="ewdv ab02">
</div>
<div class="title">Figure 2. Before and after the trader clicks the Price panel</div>
</div>
<div class="paragraph">
<p>The Mediator receives the message and reposts it to its other child&#8212;&#8203;the Order panel&#8212;&#8203;that knows how to place orders to purchase stocks. The main takeaway from this design is that the Price and Order panels do not know about each other and are communicating by sending-receiving messages to/from a mediator. Such a loosely coupled design facilitates of the reuse the same code in different applications. For example, the Price panel can be reused in a portal that&#8217;s used by company executives in a dashboard showing prices without the need to place orders. Because the Price panel has no string attached to the Order panel, it&#8217;s easy to reuse the existing code in such a dashboard.</p>
</div>
<div class="paragraph">
<p>You can find a more advanced example of intercomponent communication techniques using the <em>Mediator design pattern</em> in <a href="#mediator_section">[mediator_section]</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">HTML5 Forms</div>
<div class="paragraph">
<p>Even though this appendix is about selected HTML APIs, we should briefly bring your attention to improvements in the HTML5 <code>&lt;form&gt;</code> tag, too.</p>
</div>
<div class="paragraph">
<p>It&#8217;s hard to imagine an enterprise web application that is not using forms. At a very minimum, the Contact Us form has to be there. A login view is yet another example of an HTML form that almost every enterprise application needs. People fill out billing and shipping forms, and they answer long questionnaires while purchasing insurance policies online. HTML5 includes some very useful additions that simplify working with forms.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll start with the prompts. Showing the hints or prompts right inside the input field will save you some screen space. HTML5 has a special attribute, <code>placeholder</code>. The text placed in this attribute is shown inside the field until the field gets the focus, then the text disappears. You can see the placeholder attribute in action in <a href="#mocking_up_the_app">[mocking_up_the_app]</a>, in the logging part of our sample application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;input id="username" name="username" type="text"
                      placeholder="username" autofocus/&gt;

&lt;input id="password" name="password"
          type="password" placeholder="password"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another useful attribute is <code>autofocus</code>, which automatically places the focus in the field with this attribute. In the preceding HTML snippet, the focus is automatically placed in the field <code>username</code>.</p>
</div>
<div class="paragraph">
<p>HTML5 introduces several new input types, and many of them have a huge impact on the look and feel of the UI on mobile devices. The following are brief explanations.</p>
</div>
<div class="paragraph">
<p>If the input type is <code>date</code>, in mobile devices it will show native-looking date pickers when the focus moves into this field. In desktop computers, you&#8217;ll see a little stepper icon with which the user can select the next or previous month, day, or year without typing. Besides <code>date</code>, you can also specify such types as <code>datetime</code>, <code>week</code>, <code>month</code>, <code>time</code>, and <code>datetime-local</code>.</p>
</div>
<div class="paragraph">
<p>If the input type is <code>email</code>, the main view of the virtual keyboard on your smartphone will include the <em>@</em> key.</p>
</div>
<div class="paragraph">
<p>If the input type is <code>url</code>, the main virtual keyboard will include the buttons <em>.com</em>, <em>.</em>, and <em>/</em>.</p>
</div>
<div class="paragraph">
<p>The <code>tel</code> type will automatically validate telephone numbers for the right format.</p>
</div>
<div class="paragraph">
<p>The <code>color</code> type opens a color picker control to select the color. After selection, the hexadecimal representation of the color becomes the <code>value</code> of this input field.</p>
</div>
<div class="paragraph">
<p>The input type <code>range</code> shows a slider, and you can specify its <code>min</code> and <code>max</code> values.</p>
</div>
<div class="paragraph">
<p>The <code>number</code> type shows a numeric stepper icon on the right side of the input field.</p>
</div>
<div class="paragraph">
<p>If the type is <code>search</code>, at a very minimum you&#8217;ll see a little cross on the right of this input field with which the user can quickly clear the field. On mobile devices, bringing the focus to the search field brings up a virtual keyboard with the Search button. Consider adding the attributes <code>placeholder</code> and <code>autofocus</code> to the search field.</p>
</div>
<div class="paragraph">
<p>If the browser doesn&#8217;t support the new input type, it will render it as a text field.</p>
</div>
<div class="paragraph">
<p>To validate the input values, use the <code>required</code> attribute. It doesn&#8217;t include any logic, but won&#8217;t allow submitting the form until the input field marked as <code>required</code> has something in it.</p>
</div>
<div class="paragraph">
<p>Using the <code>pattern</code> attribute, you can write a regular expression that ensures that the field contains certain symbols or words. For example, adding <code>pattern="http:.+"</code> won&#8217;t consider the input data valid, unless it starts with <code>http://</code> followed by one or more characters, one of which has to be a period. It&#8217;s a good idea to include a <code>pattern</code> attribute with a regular expression in most of the input fields.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you&#8217;re not familiar with regular expressions, watch the presentation <a href="http://bit.ly/1ynI6IN">Demistifying Regular Expressions</a> by Lea Verou at the O&#8217;Reilly Fluent conference;  it&#8217;s a good primer on this topic.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_web-workers-api"><a class="anchor" href="#_web-workers-api"></a>Web Workers API</h3>
<div class="paragraph">
<p>When you start a web browser or any other application on your computer or other device, you start <em>a task</em> or <em>a process</em>. <em>A thread</em> is a lighter process within another process. Although JavaScript doesn&#8217;t support multithreaded mode, HTML5 has a way to run a script as a separate thread in the background.</p>
</div>
<div class="paragraph">
<p>A typical web application has a UI part (HTML) and a processing part (JavaScript). If a user clicks a button, which starts a JavaScript function that runs, say, for a hundred milliseconds, there won&#8217;t be any noticeable delays in user interaction. But if the JavaScript runs a couple of seconds, the user experience will suffer. In some cases, the web browser will assume that the script became <em>unresponsive</em> and will offer to kill it.</p>
</div>
<div class="paragraph">
<p>Imagine an HTML5 game in which a click of a button initiates major recalculation of coordinates and repainting multiple images in the browser&#8217;s window. Ideally, we&#8217;d like to parallelize the execution of UI interactions and background JavaScript functions as much as possible, so the user won&#8217;t notice any delays.  Another example is a CPU-intensive spellchecker function that finds errors while the user keeps typing. Parsing the JSON object is yet another candidate to be done in the background. Web workers are also good at polling server data.</p>
</div>
<div class="paragraph">
<p>In other words, use web workers when you want to be able to run multiple parallel <em>threads of execution</em> within the same task.
On a multiprocessor computer, parallel threads can run on different CPUs. On a single-processor computer, threads will take turns getting <em>slices</em> of the CPU&#8217;s time. Because switching CPU cycles between threads happens fast, the user won’t notice tiny delays in each thread’s execution, getting a feeling of smooth interaction.</p>
</div>
<div class="sect3">
<h4 id="_creating-and-communicating-with-workers"><a class="anchor" href="#_creating-and-communicating-with-workers"></a>Creating and Communicating with Workers</h4>
<div class="paragraph">
<p>HTML5 offers <a href="http://bit.ly/1oEqN0z">a solution</a> for multithreaded execution of a script with the help of the <code>Worker</code> object. To start a separate thread of execution, you&#8217;ll need to create an instance of a <code>Worker</code> object, passing it the name of the file with the script to run in a separate thread. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var mySpellChecker == new Worker("spellChecker.js");</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Worker</code> thread runs asynchronously and can&#8217;t directly communicate with the UI components (that is, DOM elements) of the browser. When the Worker's script finishes execution, it can send back a message by using the <code>postMessage()</code> method. Accordingly, the script that created the worker thread can listen for the event from the worker and process its responses in the event handler. This event object will contain the data received from the worker in its <code>data</code> property; for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var mySpellChecker == new Worker("spellChecker.js");
    mySpellChecker.onmessage == function(event){

        // processing the worker's response
        document.getElementById('myEditorArea').textContent == event.data;
    };</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use an alternative and preferred JavaScript function <code>addEventListener()</code> to assign the message handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var mySpellChecker == new Worker("spellChecker.js");
    mySpellChecker.addEventListener("message", function(event){

        // processing the worker's response
        document.getElementById('myEditorArea').textContent == event.data;
    });</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, the HTML page can also send any message to the worker, forcing it to start performing its duties (for example, starting the spellchecking process):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">    mySpellChecker.postMessage(wordToCheckSpelling);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The argument of <code>postMessage()</code> can contain any object, and it&#8217;s  being passed by value, not by reference.</p>
</div>
<div class="paragraph">
<p>Inside the worker, you also need to define an event handler to process the data sent from outside. To continue the previous example, <em>spellChecker.js</em> will have inside it the code that receives the text to check, performs the spellcheck, and returns the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">self.onmesage == function(event){

     // The code that performs spellcheck goes here

	 var resultOfSpellCheck == checkSpelling(event.data);

     // Send the results back to the window that listens
     // for the messages from this spellchecker

	 self.postMessage(resultOfSpellCheck);
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to run certain code in the background repeatedly, you can create a wrapper function (for example, <code>doSpellCheck()</code>) that internally invokes <code>postMesage()</code> and then gives this wrapper to <code>setTimeout()</code> or <code>setInterval()</code> to run every second or so: <code>var timer == setTimout(doSpellCheck, 1000);</code>.</p>
</div>
<div class="paragraph">
<p>If an error occurs in a worker thread, your web application will get a notification in the form of an event, and you need to provide a function handler for <code>onerror</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">mySpellChecker.onerror == function(event){
    // The error handling code goes here
};</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dedicated-and-shared-workers"><a class="anchor" href="#_dedicated-and-shared-workers"></a>Dedicated and Shared Workers</h4>
<div class="paragraph">
<p>If a window&#8217;s script creates a worker thread for its own use, we call it <em>a dedicated worker</em>.  A window creates an event listener, which gets the messages from the worker. On the other hand, the worker can have a listener, too, to react to the events received from its creator.</p>
</div>
<div class="paragraph">
<p>A <em>shared worker</em> thread can be used by several scripts, as long as they have the same origin. For example, if you want to reuse a spellchecker feature in several views of your web application, you can create a shared worker as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var mySpellChecker == new SharedWorker("spellChecker.js");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another use case is funneling all requests from multiple windows to the server through a shared worker. You can also place into a shared worker a number of reusable utility functions that might be needed in several windows&#8212;&#8203;this architecture can reduce or eliminate repeatable code.</p>
</div>
<div class="paragraph">
<p>One or more scripts can communicate with a shared worker, and it&#8217;s done slightly differently than with a dedicated one. Communication is done through the <code>port</code> property, and the <code>start()</code> method has to be invoked to be able to use <code>postMessage()</code> the first time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var mySpellChecker == new SharedWorker("spellChecker.js");
    mySpellChecker.port.addEventListener("message", function(event){
        document.getElementById('myEditorArea').textContent == event.data;
    });
    mySpellChecker.port.start()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The event handler becomes connected to the <code>port</code> property, and now you can post the message to this shared worker by using the same <code>postMessage()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">    mySpellChecker.postMessage(wordToCheckSpelling);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each new script that will connect to the shared worker by attaching an event handler to the port results in incrementing the number of active connections that the shared worker maintains.  If the script of the shared worker invokes <code>port.postMessage("Hello scripts!")</code>, all listeners that are connected to this port will get it.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If a shared thread is interested in processing the moments when a new script connects to it, add an event listener to the <code>connect</code> event in the code of the shared worker.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a worker needs to stop communicating with the external world, it can call <code>self.close()</code>. The external script can kill the worker thread by calling the method <code>terminate()</code>; for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">mySpellChecker.terminate();</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Because the script running inside the <code>Worker</code> thread doesn&#8217;t have access to the browser&#8217;s UI components, you can&#8217;t debug these scripts by printing messages onto the browser&#8217;s console with <code>console.log()</code>. In the bonus online chapter, we used the Firefox browser for development, but now we&#8217;ll illustrate how to use Chrome Browser Developer Tools, which includes the <a href="http://bit.ly/1r5J4qR"><em>Workers</em> panel</a> that can be used for debugging code that&#8217;s launched in worker threads. You&#8217;ll see multiple examples of using Chrome Developer Tools going forward.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more detailed coverage of web workers, read <em>Web Workers</em> by Ido Green (O&#8217;Reilly).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When the user switches to another page in a browser and the current web page loses focus, you might want to stop running processes that would unnecessarily use CPU cycles. To catch this moment, use the <a href="http://mzl.la/1q9FiLm">Page Visibility API</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the-websocket-api"><a class="anchor" href="#_the-websocket-api"></a>The WebSocket API</h3>
<div class="paragraph">
<p>For many years, web applications were associated with HTTP as the main protocol for communication between web browsers and servers. HTTP is a request-response&#8211;based protocol that adds hundreds of bytes to the application data being sent between browsers and servers. WebSocket is not a request-response, but a bidirectional, full-duplex, socket-based protocol, which adds only a couple of bytes (literally) to the application data. WebSocket might become a future replacement for HTTP, but web applications that require near-real-time communications (for example, financial trading applications, online games, or auctions) can benefit from this protocol today. The authors of this book believe that WebSocket is so important that we dedicated <a href="#upgrading_http_to_websocket">[upgrading_http_to_websocket]</a> to this API. In this section, we just introduce this API very briefly.</p>
</div>
<div class="paragraph">
<p>This is how the WebSocket workflow proceeds:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A web application tries to establish a socket connection between the client and the server, using HTTP only for the initial handshake.</p>
</li>
<li>
<p>If the server supports WebSocket, it switches the communication protocol from HTTP to a socket-based protocol.</p>
</li>
<li>
<p>From this point on, both client and server can send messages in both directions simultaneously (that is, in full-duplex mode).</p>
</li>
<li>
<p>This is not a request-response model, because both the server and the client can initiate the data transmission that enables the real server-side push.</p>
</li>
<li>
<p>Both the server and the client can initiate disconnects, too.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is a very short description of what the WebSocket API is about. We encourage you to read <a href="#upgrading_http_to_websocket">[upgrading_http_to_websocket]</a> and find a use for this great API in one of your projects.</p>
</div>
</div>
<div class="sect2">
<h3 id="_offline-web-applications"><a class="anchor" href="#_offline-web-applications"></a>Offline Web Applications</h3>
<div class="paragraph">
<p>A common misconception about web applications is that they are useless without an Internet connection. Everyone knows that you can write native applications in a way that they have everything they need installed on your device&#8217;s data storage&#8212;&#8203;both the application code and the data storage. With HTML5,  you can design web applications to be functional even when the user&#8217;s device is disconnected. The offline version of a web application might not offer full functionality, but certain functions can still be available.</p>
</div>
<div class="sect3">
<h4 id="_prerequisites-for-developing-offline-web-applications"><a class="anchor" href="#_prerequisites-for-developing-offline-web-applications"></a>Prerequisites for Developing Offline Web Applications</h4>
<div class="paragraph">
<p>To be useful in disconnected mode, an HTML-based application needs to have access to local storage on the device so data entered by the user in the HTML windows can be saved locally, further synchronized with the server when a connection becomes available. Think of a salesperson of a pharmaceutical company visiting medical offices and trying to sell new pills. What if a connection is not available at a certain point? She can still use her tablet to demonstrate the marketing materials, and more important, collect data about this visit and save it locally. When the Internet connection becomes available again, the web application should support automatic or manual data synchronization so the information about the sales activity is stored in a central database.</p>
</div>
<div class="paragraph">
<p>There are two main prerequisites for building offline web applications. You need local storage, and you need to ensure that the server sends only raw data to the client, with no HTML markup (see <a href="#FIG1-3">Design with offline use in mind</a>). So all these server-side frameworks that prepare data heavily sprinkled with HTML markup should not be used. For example, the frontend should be developed in HTML/JavaScript/CSS, the backend in your favorite language (Java, .NET, PHP), and the JSON-formatted data should be sent from the server to the client and back.</p>
</div>
<div id="FIG1-3" class="imageblock">
<div class="content">
<img src="images/ewdv_ab03.png" alt="ewdv ab03">
</div>
<div class="title">Figure 3. Design with offline use in mind</div>
</div>
<div class="paragraph">
<p>The business logic that supports the client&#8217;s offline functionality should be developed in JavaScript and run in the web browser. Although most of the business logic of web applications remains on the server side, the web client is not as thin as it used to be in legacy HTML-based applications. The client becomes fatter and it can have state.</p>
</div>
<div class="paragraph">
<p>It&#8217;s a good idea to create a data layer in your JavaScript code that will be responsible for all data communications. If the Internet connection is available, the data layer will make requests to the server; otherwise, it will get the data from the local storage.</p>
</div>
</div>
<div class="sect3">
<h4 id="application_cache"><a class="anchor" href="#application_cache"></a>Application Cache API</h4>
<div class="paragraph">
<p>First, an application&#8217;s cache is not related to the web browser&#8217;s cache. Its main reason for existence is to facilitate creating applications that can run even without an Internet connection available. The user will still go to her browser and enter the URL, but the trick is that the browser will load previously saved web pages from the local <em>application cache</em>. So even if the user is not online, the application will start anyway. </p>
</div>
<div class="paragraph">
<p>If your web application consists of multiple files, you need to specify which ones have to be present on the user&#8217;s computer in offline mode. A file called <em>cache manifest</em> is a plain-text file that lists these resources.</p>
</div>
<div class="paragraph">
<p>Storing resources in the application cache can be a good idea not only in disconnected mode, but also to lower the amount of code that has to be downloaded from the server each time the user starts your application. Here&#8217;s an example of the file <em>mycache.manifest</em>, which includes one CSS file, two JavaScript files, and one image to be stored locally on the user&#8217;s computer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">CACHE MANIFEST
/resources/css/main.css
/js/app.js
/js/customer_form.js
/resources/images/header_image.png</code></pre>
</div>
</div>
<div class="paragraph">
<p>The manifest file has to start with the line CACHE MANIFEST and can be optionally divided into sections. The landing page of your web application has to specify an explicit reference to the location of the manifest. If the preceding file is located in the document root directory of your application, the main HTML file can refer to the manifest as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" manifest="/mycache.manifest"&gt;
  ...
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The web server must serve the manifest file with a MIME type text/cache-manifest, and you need to refer to the documentation of your web server to see how to make a configuration change so that all files with the extension <em>.manifest</em> are served as text/cache-manifest.</p>
</div>
<div class="paragraph">
<p>On each subsequent application load, the browser makes a request to the server and retrieves the manifest file to see whether it has been updated, in which case it reloads all previously cached files. It&#8217;s the responsibility of web developers to modify the manifest on the server if any of the cacheable resources have changed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_is-your-application-offline"><a class="anchor" href="#_is-your-application-offline"></a>Is Your Application Offline?</h4>
<div class="paragraph">
<p>Web browsers have a <code>boolean</code> property, <code>window.navigator.onLine</code>, which should be used to check for a connection to the Internet. The HTML5 specification states that <em>"The navigator.onLine attribute must return false if the user agent will not contact the network when the user follows links or when a script requests a remote page (or knows that such an attempt would fail), and must return true otherwise."</em> Unfortunately, major web browsers deal with this property differently, so you need to do a thorough testing to see if it works as expected with the browser you care about.</p>
</div>
<div class="paragraph">
<p>To intercept changes in the connectivity status, you can also assign event listeners to the <code>online</code> and <code>offline</code> events. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">window.addEventListener("offline", function(e) {
    // The code to be used in the offline mode goes here
});

window.addEventListener("online", function(e) {
    // The code to synchronize the data saved in the offline mode
    // (if any) goes here
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also add the <code>onoffline</code> and <code>ononline</code> event handlers to the <code>&lt;body&gt;</code> tag of your HTML page or to the <code>document</code> object. Again, test the support of these events in your browsers.</p>
</div>
<div class="paragraph">
<p>What if the browser&#8217;s support of the offline/online events is still not stable? You&#8217;ll have to write your own script that will periodically make an Ajax call (see <a href="#using_ajax_and_json">[using_ajax_and_json]</a>) trying to connect to a remote server that&#8217;s always up and running&#8212;&#8203;for example, google.com. If this request fails, it&#8217;s a good indication that your application is disconnected from the Internet.</p>
</div>
</div>
<div class="sect3">
<h4 id="_options-for-storing-data-locally"><a class="anchor" href="#_options-for-storing-data-locally"></a>Options for Storing Data Locally</h4>
<div class="paragraph">
<p>In the past, web browsers could store their own cache and application&#8217;s cookies only on the user&#8217;s computer.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>Cookies</em> are small files (up to 4 KB) that a web browser automatically saves locally if the server&#8217;s <code>HTTPResponse</code> includes them. On the next visit to the same URL, the web browser sends all nonexpired cookies back to the browser as a part of the <code>HTTPRequest</code> object. Cookies are used for arranging HTTP session management and shouldn&#8217;t be considered a solution for setting up a local storage.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>HTML5 offers a lot more advanced solutions for storing data locally, namely:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="http://www.w3.org/TR/webstorage">Web Storage</a></dt>
<dd>
<p>Offers local storage for long-term data storage and session storage for storing a single data session.</p>
</dd>
<dt class="hdlist1"><a href="http://www.w3.org/TR/IndexedDB">IndexedDB</a></dt>
<dd>
<p>A NoSQL database that stores key-value pairs.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is another option worth mentioning: <a href="http://bit.ly/1mzIOcc">Web SQL Database</a>. The specification was based on the open source SQLite database. But the work on this specification has stopped and future versions of browsers might not support it. That&#8217;s why we don&#8217;t discuss Web SQL Database in this book.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By the end of 2013, local and session storage were supported by all modern web browsers. Web SQL Database is not supported by Firefox and Internet Explorer and most likely never will be. IndexedDB is the web storage format of the future, but Safari doesn&#8217;t support it yet, so if your main development platform is iOS, you might need to stick to Web SQL Database. Consider using a polyfill for indexedDB by using a Web SQL API called <a href="http://bit.ly/1lZrNfP">IndexedDBShim</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To get the current status of support for HTML5 features, visit <a href="http://www.caniuse.com">caniuse.com</a> and search for the API you&#8217;re interested in.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Although web browsers send cookies to the web server, they don&#8217;t send the data saved in local storage. The saved data is used only on the user&#8217;s device. Also, the data saved in the local storage never expires. A web application has to programmatically clean up the storage, if need be, which will be illustrated next.</p>
</div>
</div>
<div class="sect3">
<h4 id="_web-storage-specification-apis"><a class="anchor" href="#_web-storage-specification-apis"></a>Web Storage Specification APIs</h4>
<div class="paragraph">
<p>With <code>window.localStorage</code> or <code>window.sessionStorage</code> (a.k.a. web storage), you can store any objects on the local disk as key-value pairs. Both objects implement the <code>Storage</code> interface. The main difference between the two is that the lifespan of the former is longer. If the user reloads the page, or the web browser, or restarts the computer, the data saved with <code>window.localStorage</code> will survive, whereas the data saved via <code>window.sessionStorage</code> won&#8217;t.</p>
</div>
<div class="paragraph">
<p>Another distinction is that the data from <code>window.localStorage</code> is available for any page loaded from the same origin as the page that saved the data.  With <code>window.sessionStorage</code>, the data is available only to the window or a browser&#8217;s tab that saved it.</p>
</div>
<div class="sect4">
<h5 id="_localstorage-api"><a class="anchor" href="#_localstorage-api"></a>localStorage API</h5>
<div class="paragraph">
<p>Saving the application state is the main use of local storage. Coming back to the use-case of the pharmaceutical salesperson, in offline mode, you can save the name of the person she talked to in a particular medical office and the notes about the conversation that took place. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">localStorage.setItem('officeID', 123);
localStorage.setItem('contactPerson', 'Mary Lou');
localStorage.setItem('notes', 'Drop the samples of XYZin on 12/15/2013');</code></pre>
</div>
</div>
<div class="paragraph">
<p>Accordingly, to retrieve the saved information, you&#8217;d need to use the method <code>getItem()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var officeID == localStorage.getItem('officeID');
var contact == localStorage.getItem('contactPerson');
var notes == localStorage.getItem('notes');</code></pre>
</div>
</div>
<div class="paragraph">
<p>These code samples are fairly simple because they store single values. In real-life scenarios, we often need to store multiple objects. What if our salesperson visits several medical offices and needs to save information about all these visits in the web store?  For each visit, we can create a key-value combination, where a <em>key</em> includes the unique ID (for example, office ID), and the <em>value</em> is a JavaScript object (for example, Visit) turned into a JSON-formatted string (see <a href="#using_ajax_and_json">[using_ajax_and_json]</a> for details) by using <code>JSON.stringify()</code>. </p>
</div>
<div class="paragraph">
<p>The code sample that follows illustrates how to store and retrieve the custom <code>Visit</code> objects. Each visit to a medical office is represented by one instance of the <code>Visit</code> object. To keep the code simple, we haven&#8217;t included any HTML components. The JavaScript functions are invoked and print their output on the browser&#8217;s console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset="utf-8" /&gt;
  &lt;title&gt;My Today's Visits&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
 &lt;script&gt;

  // Saving in local storage
  var saveVisitInfo == function (officeVisit) {
          var visitStr=JSON.stringify(officeVisit);      <i class="conum" data-value="1"></i><b>(1)</b>
          window.localStorage.setItem("Visit:"+ visitNo, visitStr);
          window.localStorage.setItem("Visits:total", ++visitNo);

          console.log("saveVisitInfo: Saved in local storage " + visitStr);
 };

// Reading from local storage
  var readVisitInfo == function () {

     var totalVisits == window.localStorage.getItem("Visits:total");
     console.log("readVisitInfo: total visits " + totalVisits);

     for (var i == 0; i &lt; totalVisits; i++) {    <i class="conum" data-value="2"></i><b>(2)</b>

         var visit == JSON.parse(window.localStorage.getItem("Visit:" + i));
         console.log("readVisitInfo: Office " + visit.officeId +
                     " Spoke to " + visit.contactPerson + ": " + visit.notes);
  }
 };

// Removing the visit info from local storage
var removeAllVisitInfo == function (){             <i class="conum" data-value="3"></i><b>(3)</b>
          var totalVisits == window.localStorage.getItem("Visits:total");

          for (i == 0; i &lt; totalVisits; i++) {
              window.localStorage.removeItem("Visit:" + i);
      }

      window.localStorage.removeItem("Visits:total");

      console.log("removeVisits: removed all visit info");
}

   var visitNo == 0;

   // Saving the first visit's info
   var visit == {                                <i class="conum" data-value="4"></i><b>(4)</b>
         officeId: 123,
         contactPerson: "Mary Lou",
         notes: "Drop the samples of XYZin on 12/15/2013"
    };
    saveVisitInfo(visit);

    // Saving the second visit's info           <i class="conum" data-value="5"></i><b>(5)</b>
    visit == {
         officeId: 987,
         contactPerson: "John Smith",
         notes: "They don't like XYZin - people die from it"
    };
    saveVisitInfo(visit);

   // Retrieving visit info from local storage
   readVisitInfo();                             <i class="conum" data-value="6"></i><b>(6)</b>

   // Removing all visit info from local storage
   removeAllVisitInfo();                        <i class="conum" data-value="7"></i><b>(7)</b>

   // Retrieving visit info from local storage - should be no records
   readVisitInfo();                             <i class="conum" data-value="8"></i><b>(8)</b>

  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The function <code>saveVisitInfo()</code> uses a JSON object to turn the visit object into a string with <code>JSON.stringify()</code>. It then saves this string in local storage. This function also increments the total number of visits and saves it in local storage under the key <code>Visits:total</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The function <code>readVisitInfo()</code> gets the total number of visits from local storage and then reads each visit record, re-creating the JavaScript object from the JSON string by using <code>JSON.parse()</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The function <code>removeAllVisitInfo()</code> reads the number of visit records, removes each of them, and then removes the <code>Visits:total</code>, too.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Creates and saves the first visit record.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Creates and saves the second visit record.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Reads saved visit info.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Removes saved visit info. To remove the entire content that was saved for a specific origin, call the method <code>localStorage.clear()</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Rereads visit info after removal.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="#FIG1-4">Chrome&#8217;s console after running the Visits sample</a> shows the output on the console of Chrome Developer Tools. Two visit records were saved in local storage, and then they were retrieved and removed from storage. Finally, the program attempts to read the value of the previously saved <code>Visits:total</code>, but it&#8217;s null now&#8212;&#8203;we&#8217;ve removed from <code>localStorage</code> all the records related to visits.</p>
</div>
<div id="FIG1-4" class="imageblock">
<div class="content">
<img src="images/ewdv_ab04.png" alt="ewdv ab04">
</div>
<div class="title">Figure 4. Chrome&#8217;s console after running the Visits sample</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are interested in intercepting the moments when the content of local storage gets modified, listen to the DOM <code>storage</code> event, which carries the old and new values and the URL of the page whose data is being changed.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Another good example of a use case when <code>locaStorage</code> becomes handy is when a user is booking airline tickets by using more than one browser&#8217;s tab.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_sessionstorage-api"><a class="anchor" href="#_sessionstorage-api"></a>sessionStorage API</h5>
<div class="paragraph">
<p>The <code>sessionStorage</code> life is short; it&#8217;s available for a web page only while the browser stays open. If the user decides to refresh the page, <code>sessionStorage</code> will survive, but opening a page in a new browser&#8217;s tab or window will create a new <code>sessionStorage</code> object. Working with session storage is fairly straightforward; for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">sessionStorage.setItem("userID","jsmith");

var userID == sessionStorage.getItem("userID");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Chrome Developer Tools includes the tab Resources that allows browsing the local or session storage if a web page uses it. For example, <a href="#FIG1-0">Browsing local storage in Chrome Developer Tools</a> shows the storage used by <em>cnn.com</em>.</p>
</div>
<div id="FIG1-0" class="imageblock">
<div class="content">
<img src="images/ewdv_ab05.png" alt="ewdv ab05">
</div>
<div class="title">Figure 5. Browsing local storage in Chrome Developer Tools</div>
</div>
</div>
<div class="sect4">
<h5 id="_localstorage-and-sessionstorage-commonalities"><a class="anchor" href="#_localstorage-and-sessionstorage-commonalities"></a>localStorage and sessionStorage commonalities</h5>
<div class="paragraph">
<p>Both <code>localStorage</code> and <code>sessionStorage</code> are subject to the same-origin policy, meaning that saved data is available only for web pages that come from the same host, from the same port, and via the same protocol.</p>
</div>
<div class="paragraph">
<p>Both <code>localStorage</code> and <code>sessionStorage</code> are browser-specific. For example, if the web application stores data from Firefox, that data won&#8217;t be available if the user opens the same application from Safari.</p>
</div>
<div class="paragraph">
<p>The APIs from the Web Storage specification are simple to use, but their major drawbacks are that they don&#8217;t give you a way to structure the stored data, you always have to store strings, and the API is synchronous, which can cause delays in the user interaction when your application accesses the disk.</p>
</div>
<div class="paragraph">
<p>There is no actual limit on the size of local storage, but browsers usually default to 5 MB. If the application tries to store more data than the browser permits, the <code>QUOTA_EXCEEDED_ERR</code> exception will be thrown&#8212;&#8203;always use the try-catch blocks when saving data.</p>
</div>
<div class="paragraph">
<p>Even if the user&#8217;s browser allows increasing this setting (for example, via the <em>about:config</em> URL in Firefox), access to such data might be slow. Consider using the <a href="http://www.w3.org/TR/FileAPI/">File API</a> or IndexedDB, which are introduced in the next section.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_introduction-to-indexeddb"><a class="anchor" href="#_introduction-to-indexeddb"></a>Introduction to IndexedDB</h4>
<div class="paragraph">
<p><a href="http://www.w3.org/TR/IndexedDB">Indexed Database API</a> (a.k.a., IndexedDB) is a solution based on the NoSQL database. As with the <code>Storage</code> interface, IndexedDB stores data as key-value pairs, but it also offers  transactional handling of objects. IndexedDB creates indexes of the stored objects for fast retrieval. With Web Storage, you can store only strings, and we had to do these tricks with JSON <code>stingify()</code> and <code>parse()</code> to give some structure to these strings. With IndexedDB, you can directly store and index regular JavaScript objects.</p>
</div>
<div class="paragraph">
<p>Using IndexedDB, you can access data asynchronously, so UI freezes won&#8217;t occur while accessing large objects on disk. You make a request to the database and define the event handlers that should process the errors or the result when ready. IndexedDB uses DOM events for all notifications. Success events don&#8217;t bubble, whereas error events do.</p>
</div>
<div class="paragraph">
<p>Users will have the feeling that the application is responsive, which wouldn&#8217;t be the case if you were saving several megabytes of data with the Web Storage API. Similar to Web Storage, access to the IndexedDB databases is regulated by the same-origin policy.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In the future, web browsers might implement <a href="http://mzl.la/1iSK0fT">synchronous IndexedDB API</a> to be used inside web workers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Because not every browser supports IndexedDB yet, you can use Modernizr (see <a href="#mocking_up_the_app">[mocking_up_the_app]</a>) to detect whether your browser supports it. If it does, you still might need to account for the fact that browser vendors name the IndexedDB-related object differently. To be on the safe side, at the top of your script include statements to account for the prefixed vendor-specific implementations of <code>indexedDB</code> and related objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var medicalDB == {};   // just an object to store references

medicalDB.indexedDB == window.indexedDB || window.mozIndexedDB
      || window.msIndexedDB || window.webkitIndexedDB ;
if (!window.indexedDB){
   // this browser doesn't support IndexedDB
} else {
  medicalDB.IDBTransaction == window.IDBTransaction ||
                              window.webkitIDBTransaction;
  medicalDB.IDBCursor == window.IDBCursor || window.webkitIDBCursor;
  medicalDB.IDBKeyRange == window.IDBKeyRange || window.webkitIDBKeyRange;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this code snippet, the <a href="http://mzl.la/TwkJMs"><code>IDBKeyRange</code></a> is an object that allows you to restrict the range for the continuous keys while iterating through the objects. <a href="http://mzl.la/1iSK4Mq"><code>IDBTransaction</code></a> is an implementation of transaction support. <a href="http://mzl.la/1vnNbMO"><code>IDBCursor</code></a> is an object that represents a cursor for traversing over multiple objects in the database.</p>
</div>
<div class="paragraph">
<p>IndexedDB doesn&#8217;t require you to define a formal structure of your stored objects; any JavaScript object can be stored there. Not having a formal definition of a database scheme is an advantage compared to relational databases, where you can&#8217;t store data until the structure of the tables is defined.</p>
</div>
<div class="paragraph">
<p>Your web application can have one or more databases, and each can contain one or more <em>object stores</em>.  Each object store will contain similar objects (for example, one stores the salesperson&#8217;s visits, whereas another stores upcoming promotions).</p>
</div>
<div class="paragraph">
<p>Every object that you are planning to store in the database has to have one property that plays a role similar to a primary key in a relational database. You have to decide whether you want to maintain the value in this property manually, or use the <code>autoIncrement</code> option, where the values of this property will be assigned automatically. Coming back to our Visits example, you can either maintain the unique values of the <code>officeId</code> on your own or create a surrogate key that will be assigned by IndexedDB. The current generated number to be used as a surrogate keys never decreases, and starts with the value of 1 in each object store.</p>
</div>
<div class="paragraph">
<p>As with relational databases, you create indexes based on the searches that you run often. For example, if you need to search on the contact name in the Visits store, create an index on the property <code>contactPerson</code> of the <code>Visit</code> objects. Whereas in relational databases creation of indexes is done for performance reasons, with IndexedDB you can&#8217;t run a query unless the index on the relevant property exists. The following code sample shows how to connect to an existing object or create a new object store <code>Visits</code> in a database called Medical_DB:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var request == medicalDB.indexedDB.open('Medical_DB');     <i class="conum" data-value="1"></i><b>(1)</b>

request.onsuccess == function(event) {       <i class="conum" data-value="2"></i><b>(2)</b>
    var myDB == request.result;

};

request.onerror == function (event) {        <i class="conum" data-value="3"></i><b>(3)</b>
    console.log("Can't access Medical_DB: " + event.target.errorCode);
};

request.onupgradeneeded == function(event){  <i class="conum" data-value="4"></i><b>(4)</b>
     event.currentTarget.result.createObjectStore ("Visits",
            {keypath: 'id', autoIncrement: true});
};</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The browser invokes the method <code>open()</code>, asynchronously requesting to establish the connection with the database. It doesn&#8217;t wait for the  completion of this request, and the user can continue working with the web page without any delays or interruptions. The method <code>open()</code> returns an instance of the <a href="http://mzl.la/1rPytxR"><code>IDBRequest</code></a> object.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When the connection is successfully obtained, the <code>onsuccess</code> function handler will be invoked. The result is available through the <code>IDBRequest.result</code> property.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Error handling is done here. The event object given to the <code>onerror</code> handler will contain the information about the error.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>onupgradeneeded</code> handler is the place to create or upgrade the storage to a new version. This is explained next.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
There are several scenarios to consider while deciding whether you need to use the <code>autoIncrement</code> property with the store key. Kristof Degrave described in the article <a href="http://bit.ly/1lJjjEN">"Indexed DB: To provide a key or not to provide a key."</a>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_object-stores-and-versioning"><a class="anchor" href="#_object-stores-and-versioning"></a>Object stores and versioning</h5>
<div class="paragraph">
<p>In the world of traditional DBMS servers, when the database structure has to be modified, the DBA will do this upgrade, the server will be restarted, and the users will work with the <em>new version</em> of the database. With IndexedDB, it works differently. Each database has a version, and when the new version of the database (for example, Medical_DB) is created, <code>onupgradeneeded</code> is dispatched, which is where object store(s) are created. But if you already had object stores in the older version of the database, and they don&#8217;t need to be changed, there is no need to re-create them.</p>
</div>
<div class="paragraph">
<p>After successful connection to the database, the version number is available in the <code>IDBRequest.result.version</code> property. The starting version of any database is 1.</p>
</div>
<div class="paragraph">
<p>The method <code>open()</code> takes a second parameter: the database version to be used. If you don&#8217;t specify the version, the latest one will be used. The following line shows how the application&#8217;s code can request a connection to version 3 of the database <code>Medical_DB</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var request == indexedDB.open('Medical_DB',3);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the user&#8217;s computer already has the <code>Medical_DB</code> database of one of the earlier versions (1 or 2), the <code>onupgradeneeded</code> handler will be invoked.  The initial creation of the database is triggered the same way&#8212;&#8203;the absence of the database also falls under the "upgrade is needed" case, and the  <code>onupgradeneeded</code> handler has to invoke the <code>createObjectStore()</code> method. If an upgrade is needed, <code>onupgradeneeded</code> will be invoked before the <code>onsuccess</code> event.</p>
</div>
<div class="paragraph">
<p>The following code snippet creates a new or initial version of the object store <code>Visits</code>, requesting autogeneration of the surrogate keys named <code>id</code>. It also creates indexes to allow searching by office ID, contact name, and notes. Indexes are updated automatically, as soon as the web application makes any changes to the stored data. If you couldn&#8217;t create indexes, you&#8217;d be able to look up objects only by the value of the key.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">request.onupgradeneeded == function(event){  <i class="conum" data-value="4"></i><b>(4)</b>
  var visitsStore ==
     event.currentTarget.result.createObjectStore ("Visits",
         {keypath='id',
         autoIncrement: true
         });

  visitsStore.createIndex("officeIDindex", "officeID",
                                         {unique: true});
  visitsStore.createIndex("contactsIndex", "contactPerson",
                                         {unique: false});
  visitsStore.createIndex("notesIndex", "notes",
                                         {unique: false});
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that while creating the object store for visits, we could have used a unique property <code>officeID</code> as a <code>keypath</code> value by using the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript"> var visitsStore ==
     event.currentTarget.result.createObjectStore ("Visits",
         {keypath='officeID'});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>event.currentTarget.result</code> (as well as <code>IDBRequest.result</code>) points at the instance of the <code>IDBDatabase</code> object, which has a number of useful properties such as <code>name</code>, which contains the name of the current database, and the array <code>objectStoreNames</code>, which has the names of all object stores that exist in this database. Its property <code>version</code> has the database version number. If you&#8217;d like to create a new database, just call the method <code>open()</code>, specifying a version number that&#8217;s higher than the current one.</p>
</div>
<div class="paragraph">
<p>To remove the existing database, call the method <code>indexedDB.deleteDatabase()</code>. To delete the existing object store, invoke <code>indexedDB.deleteObjectStore()</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
IndexedDB doesn&#8217;t offer a secure way of storing data. Anyone who has access to the user&#8217;s computer can get a hold of the data stored in IndexedDB. Do not store any sensitive data locally. Always use the secure HTTPS protocol with your web application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_transactions"><a class="anchor" href="#_transactions"></a>Transactions</h5>
<div class="paragraph">
<p>A <em>transaction</em> is a logical unit of work. Executing several database operations in one transaction guarantees that the changes will be committed to the database only if all operations finished successfully. If at least one of the operations fails, the entire transaction will be rolled back (undone). IndexDB supports three transaction modes: <code>readonly</code>, <code>readwrite</code>, and <code>versionchange</code>.</p>
</div>
<div class="paragraph">
<p>To start any manipulations of the database, you have to open a transaction in one of these modes. The <code>readonly</code> transaction (the  default one) allows multiple scripts to read from the database concurrently. This statement might raise a question: why would the user need concurrent access to his local database if he&#8217;s the only user of the application on his device? The reason is that the same application can be opened in more than one tab, or by spawning more than one worker thread that needs to access the local database. The <code>readonly</code> mode is the least restrictive mode, and more than one script can open a <code>readonly</code> transaction.</p>
</div>
<div class="paragraph">
<p>If the application needs to modify or add objects to the database, open the transaction in <code>readwrite</code> mode; only one script can have the transaction open on any particular object store. But you can have more than one <code>readwrite</code> transaction open at the same time on different stores. And if the database/store/index creation or upgrade has to be done, use <code>versionchange</code> mode.</p>
</div>
<div class="paragraph">
<p>When a transaction is created, you should assign listeners to its <code>complete</code>, <code>error</code>, and <code>abort</code> events. If the <code>complete</code> event is fired, the transaction is automatically committed; manual commits are not supported. If the <code>error</code> event is dispatched, the entire transaction is rolled back. Calling the method <code>abort()</code> will fire the <code>abort</code> event and will roll back the transaction, too.</p>
</div>
<div class="paragraph">
<p>Typically, you should open the database and in the <code>onsuccess</code> handler create a transaction. Then, open a transaction by calling the method <code>objectStore()</code> and perform data manipulations. In the next section, you&#8217;ll see how to add objects to an object store by using transactions.</p>
</div>
</div>
<div class="sect4">
<h5 id="_modyfying-the-object-store-data"><a class="anchor" href="#_modyfying-the-object-store-data"></a>Modyfying the object store data</h5>
<div class="paragraph">
<p>The following code snippet creates a transaction that allows updates of the store <code>Visits</code> (you could create a transaction for more than one store) and adds two visit objects by invoking the method <code>add()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">request.onsuccess == function(event) {       <i class="conum" data-value="1"></i><b>(1)</b>
    var myDB == request.result;

  var visitsData == [{                       <i class="conum" data-value="2"></i><b>(2)</b>
         officeId: 123,
         contactPerson: "Mary Lou",
         notes: "Drop the samples of XYZin on 12/15/2013"
    },
    {
         officeId: 987,
         contactPerson: "John Smith",
         notes: "They don't like XYZin - people die from it"
    }];

   var transaction == myDB.transaction(["Visits"],
                                      "readwrite");  <i class="conum" data-value="3"></i><b>(3)</b>
   transaction.oncomplete == function(event){
      console.log("All visit data have been added);
   }

   transaction.onerror == function(event){
      // transaction rolls back here
      console.log("Error while adding visits");
   }

   var visitsStore == transaction.objectStore("Visits");  <i class="conum" data-value="4"></i><b>(4)</b>

    for (var i in visitsData) {
      visitsStore.add(visitsData[i]);       <i class="conum" data-value="5"></i><b>(5)</b>
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The database opened successfully.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Create a sample array of <code>visitsData</code> to illustrate adding more than one object to an object store.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Open a transaction for updates and assign listeners for success and failure. The first argument is an array of object stores that the transaction will span (only <code>Visits</code> in this case). When all visits are added, the <code>complete</code> event is fired and the transaction commits. If adding any visit fails, the <code>error</code> event is dispatched and the transaction rolls back.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Get a reference to the object store <code>visits</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>In a loop, add the data from the array <code>visitsData</code> to the object store <code>Visits</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the preceding code sample, each object that represents a visit has a property <code>notes</code>, which is a string. If later you decide to allow storing more than one note per visit, just turn the property <code>notes</code> into an array in your JavaScript; no changes in the object stores is required.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The method <code>put()</code> allows you to update an existing object in a record store. It takes two parameters: the new object and the key of the existing object to be replaced; for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var putRequest == visitsStore.put({officeID: 123, contactName: "Mary Lee"}, 1);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To remove all objects from the store, use the method <code>clear()</code>. To delete an object, specify its ID:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var deleteRequest == visitsStore.delete(1);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can browse the data from your IndexedDB database in Chrome Developer Tools under the tab Resources (see <a href="#FIG1-0">Browsing local storage in Chrome Developer Tools</a>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_retrieving-the-data"><a class="anchor" href="#_retrieving-the-data"></a>Retrieving the data</h5>
<div class="paragraph">
<p>IndexedDB doesn&#8217;t support SQL. You&#8217;ll be using cursors to iterate through the object store. First, you open the transaction. Then, you invoke <code>openCursor()</code> on the object store. While opening the cursor, you can specify optional parameters like the range of object keys you&#8217;d like to iterate and the direction of the cursor movement: <code>IDBCursor.PREV</code> or <code>IDBCursor.NEXT</code>. If none of the parameters is specified, the cursor will iterate all objects in the store in ascending order. The following code snippet iterates through all Visit objects, printing just contact names: </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var transaction == myDB.transaction(["visits"], "readonly");
var visitsStore == transaction.objectStore("Visits");

visitsStore.openCursor().onsuccess == function(event){
    var visitsCursor == event.target.result;
    if (visitsCursor){
        console.log("Contact name: " + visitCursor.value.contactPerson);
        visitsCursor.continue();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to iterate through a limited key range of objects, you can specify the from-to values. The next line creates a cursor for iterating the first five objects from the store:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var visitsCursor == visitsStore.openCursor(IDBKeyRange.bound(1, 5));</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also create a cursor on indexes. This makes it possible to work with sorted sets of objects. In one of the earlier examples we created an index on <code>officeID</code>. Now we can get a reference to this index and create a cursor on the specified range of sorted office IDs, as in the following code snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">var visitsStore == transaction.objectStore("visits");
var officeIdIndex == visitsStore.index("officeID");

officeIdIndex.openCursor().onsuccess == function(event){
    var officeCursor == event.target.result;
    // iterate through objects here
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To limit the range of offices to iterate through, you could open the cursor on the <code>officeIdIndex</code> differently. Suppose that you need to create a filter to iterate the offices with numbers between 123 and 250. This is how you can open such a cursor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">officeIdIndex.openCursor(IDBKeyRange.bound(123, 250, false, true);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>false</code> in the third argument of <code>bound()</code> means that 123 should be included in the range, and the <code>true</code> in the fourth parameter excludes the object with <code>officeID=250</code> from the range. The methods <code>lowerbound()</code> and <code>upperbound()</code> are other variations of the method bound()—consult the <a href="http://bit.ly/1nR65dF">online documentation</a> for details.</p>
</div>
<div class="paragraph">
<p>If you need to fetch just one specific record, restrict the selected range to only one value by using the method <code>only()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">contactNameIndex.openCursor(IDBKeyRange.only("Mary Lou");</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_runninng-the-sample-code"><a class="anchor" href="#_runninng-the-sample-code"></a>Runninng the sample code</h5>
<div class="paragraph">
<p>Let&#8217;s bring together all of the previous code snippets into one runnable HTML file. While doing this, we&#8217;ll be watching the script execution in the Chrome Developer Tools panel. We&#8217;ll do it in two steps. The first version of this file will create a database of a newer version than the one that currently exists on the user&#8217;s device. Here&#8217;s the code that creates the database Medical_DB with an empty object store Visits:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset="utf-8" /&gt;
  &lt;title&gt;My Today's Visits With IndexedDB&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;script&gt;
     var medicalDB == {};   // just an object to store references
     var myDB;

  medicalDB.indexedDB == window.indexedDB || window.mozIndexedDB
        || window.msIndexedDB || window.webkitIndexedDB ;
  if (!window.indexedDB){
     // this browser doesn't support IndexedDB
  } else {
    medicalDB.IDBTransaction == window.IDBTransaction ||
                                window.webkitIDBTransaction;
    medicalDB.IDBCursor == window.IDBCursor || window.webkitIDBCursor;
    medicalDB.IDBKeyRange == window.IDBKeyRange || window.webkitIDBKeyRange;
  }

  var request == medicalDB.indexedDB.open('Medical_DB', 2);  <i class="conum" data-value="1"></i><b>(1)</b>

      request.onsuccess == function(event) {
          myDB == request.result;
    };

  request.onerror == function (event) {
      console.log("Can't access Medical_DB: " + event.target.errorCode);
  };

  request.onupgradeneeded == function(event){
     event.currentTarget.result.createObjectStore ("Visits",
            {keypath:'id', autoIncrement: true});    <i class="conum" data-value="2"></i><b>(2)</b>
};

  &lt;/script&gt;
 &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This version of the code is run when the user&#8217;s computer already had a database Medical_DB: initially we invoke <code>open()</code> without the second argument. Running the code and specifying 2 as the version causes invocation of the callback <code>onupgradeneeded</code> even before <code>onsuccess</code> is called.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Create an empty object store <code>Visits</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="#FIG1-5">Chrome&#8217;s console after running the Visits sample</a> shows a screenshot from the Chrome Developer Tools at the end of processing the <code>success</code> event. Note the Watch Expression section on the right. The name of the database is Medical_DB, its version number is 2, and the <code>IDBDatabase</code> property <code>objectStoreNames</code> shows that there is one object store named Visits.</p>
</div>
<div id="FIG1-5" class="imageblock">
<div class="content">
<img src="images/ewdv_ab06.png" alt="ewdv ab06">
</div>
<div class="title">Figure 6. Chrome&#8217;s console after running the Visits sample</div>
</div>
<div class="paragraph">
<p>The next version of our sample HTML file populates the object store Visits with some data and then iterates through all the Visit objects and displays the values of their properties on the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset="utf-8" /&gt;
  &lt;title&gt;My Today's Visits With IndexedDB&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;script&gt;
     var medicalDB == {};   // just an object to store references
     var myDB;

  medicalDB.indexedDB == window.indexedDB || window.mozIndexedDB
        || window.msIndexedDB || window.webkitIndexedDB ;
  if (!window.indexedDB){
     // this browser doesn't support IndexedDB
  } else {
    medicalDB.IDBTransaction == window.IDBTransaction ||
                                window.webkitIDBTransaction;
    medicalDB.IDBCursor == window.IDBCursor || window.webkitIDBCursor;
    medicalDB.IDBKeyRange == window.IDBKeyRange || window.webkitIDBKeyRange;
  }

  var request == medicalDB.indexedDB.open('Medical_DB', 2);

    request.onsuccess == function(event) {
          myDB == request.result;

  var visitsData == [{
           officeId: 123,
           contactPerson: "Mary Lou",
           notes: "Drop the samples of XYZin on 12/15/2013"
      },
      {
           officeId: 987,
           contactPerson: "John Smith",
           notes: "They don't like XYZin - people die from it"
      }];

     var transaction == myDB.transaction(["Visits"],
                                        "readwrite");
     transaction.oncomplete == function(event){
        console.log("All visit data have been added.");

        readAllVisitsData();                <i class="conum" data-value="1"></i><b>(1)</b>
     }

     transaction.onerror == function(event){
        // transaction rolls back here
        console.log("Error while adding visits");
     }

     var visitsStore == transaction.objectStore("Visits");

     visitsStore.clear();                   <i class="conum" data-value="2"></i><b>(2)</b>

    for (var i in visitsData) {
       visitsStore.add(visitsData[i]);
    }

    };

  request.onerror == function (event) {
      console.log("Can't access Medical_DB: " + event.target.errorCode);
  };

  request.onupgradeneeded == function(event){
     event.currentTarget.result.createObjectStore ("Visits",
            {keypath:'id', autoIncrement: true});
};


function readAllVisitsData(){
  var readTransaction == myDB.transaction(["Visits"], "readonly");

   readTransaction.onerror == function(event){
      console.log("Error while reading visits");
   }

   var visitsStore == readTransaction.objectStore("Visits");

 visitsStore.openCursor().onsuccess == function(event){   <i class="conum" data-value="3"></i><b>(3)</b>
        var visitsCursor == event.target.result;

        if (visitsCursor){
          console.log("Contact name: " +
                      visitsCursor.value.contactPerson +
                      ", notes: " +
                      visitsCursor.value.notes);
          visitsCursor.continue();                   <i class="conum" data-value="4"></i><b>(4)</b>
       }
  }
 }
  &lt;/script&gt;
 &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>After the data store is populated and the transaction is commited, invoke the method to read all the objects from the Visits store.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Remove all the objects from the store Visits before populating it with the data from the array <code>VisitsData</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Open the cursor to iterate through all visits.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Move the cursor&#8217;s pointer to the next object after printing the contact name and notes in the console.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="#FIG1-6">Chrome&#8217;s console after reading the first Visit object</a> shows the screenshot from Chrome Developer Tools when the debugger stops in <code>readAllVisitsData()</code>, directly after reading both objects from the Visits store. The console output is shown at the bottom. Note the content of visitsCursor on the right. The cursor is moving forward (the <code>next</code> direction), and the <code>value</code> property points at the object at the cursor. The <code>key</code> value of the object is 30. It&#8217;s autogenerated, and on each run of this program, you&#8217;ll see a new value, because we clean the store and reinsert the objects, which generates the new keys.</p>
</div>
<div id="FIG1-6" class="imageblock">
<div class="content">
<img src="images/ewdv_ab07.png" alt="ewdv ab07">
</div>
<div class="title">Figure 7. Chrome&#8217;s console after reading the first Visit object</div>
</div>
<div class="paragraph">
<p>This concludes our brief introduction to IndexedDB. Those of you who have experience working with relational databases might find the querying capabilities of IndexedDB rather limited compared to powerful relational databases such as Oracle or MySQL. On the other hand, IndexedDB is quite flexible. With it, you can store and look up any JavaScript objects without worrying about creating a database schema first. At the time of this writing, there are no books dedicated to IndexedDB. For up-to-date information, refer to the <a href="http://mzl.la/1x4Sh3l">IndexedDB online documentation</a> at Mozilla Developer Network.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the-history-api"><a class="anchor" href="#_the-history-api"></a>The History API</h3>
<div class="paragraph">
<p>To put this simply, the <a href="http://bit.ly/1q9FWIS">History API</a> is about ensuring that the Back/Forward  buttons on the browser toolbar can be controlled programmatically. Each web browser has the <code>window.history</code> object. The History API is not new to HTML5. The <code>history</code> object has been around for many years, with methods like <code>back()</code>, <code>forward()</code>, and <code>go()</code>. But HTML5 adds new methods, <code>pushState()</code> and <code>replaceState()</code>, with which you can modify the browser&#8217;s address bar without reloading the web page.</p>
</div>
<div class="paragraph">
<p>Imagine a single-page application (SPA) that has a navigational menu to open various views, based on the user&#8217;s interaction. Because these views represent URLs loaded by making Ajax calls from your code, the web browser still shows the original URL of the home page of your web application.</p>
</div>
<div class="paragraph">
<p>A perfect user always navigates your application by using the menus and controls you provided, but what if she clicks the Back button of the web browser? If the navigation controls aren&#8217;t changing the URL in the browser&#8217;s address bar, the browser obediently will show the web page that the user has visited before, even launching your application, which is most likely not what she intended to do. Using the History API, you can create more fine-grained bookmarks that define a specific state within the web page.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Not writing any code that would process clicks on the Back and Forward buttons is the easiest way to frustrate your users.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_modifying-the-browser-s-history-by-using-pushstate"><a class="anchor" href="#_modifying-the-browser-s-history-by-using-pushstate"></a>Modifying the Browser&#8217;s History by Using pushState()</h4>
<div class="paragraph">
<p>Imagine that you have a customer-management application with the URL <a href="http://myapp.com" class="bare">http://myapp.com</a>. The user clicks the menu item Get Customers, which makes an Ajax call loading the customers. You can programmatically change the URL on the browser&#8217;s address line to <a href="http://myapp.com/customers" class="bare">http://myapp.com/customers</a> without asking the web browser to make a request to this URL. You do this by invoking the <code>pushState()</code> method.</p>
</div>
<div class="paragraph">
<p>The browser will just remember that the current URL is <a href="http://myapp.com/customers" class="bare">http://myapp.com/customers</a>, while the previous was <a href="http://myapp.com" class="bare">http://myapp.com</a>. So pressing the Back button changes the address back to <a href="http://myapp.com" class="bare">http://myapp.com</a>, and not some unrelated web application. The Forward button will also behave properly, as per the history chain set by your application.</p>
</div>
<div class="paragraph">
<p>The <code>pushState()</code> takes three arguments (the values from the first two might be ignored by some web browsers):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The application-specific state to be associated with the current view of the web page</p>
</li>
<li>
<p>The title of the current view of the web page.</p>
</li>
<li>
<p>The suffix to be associated with the current view of the page. It will be added to the address bar of the browser:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;head&gt;
	&lt;meta charset="utf-8"&gt;
	&lt;title&gt;History API&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;div id="main-container"&gt;

  	 &lt;h1&gt;Click on Link and watch the address bar...&lt;/h1&gt;

    &lt;button type="button" onclick="whoWeAre()"&gt;Who we are&lt;/button&gt;  <i class="conum" data-value="1"></i><b>(1)</b>

    &lt;button type="button" onclick="whatWeDo()"&gt;What we do&lt;/button&gt;

  &lt;/div&gt;

  &lt;script&gt;

     function whoWeAre(){
     	var locationID== {locID: 123,                             <i class="conum" data-value="2"></i><b>(2)</b>
     		        uri: '/whoweare'};

     	history.pushState(locationID,'', 'who_we_are' );          <i class="conum" data-value="3"></i><b>(3)</b>
     }

     function whatWeDo(){
     	var actionID== {actID: 123,                               <i class="conum" data-value="4"></i><b>(4)</b>
     		          uri: '/whatwedo'};

     	history.pushState(actionID,'', 'what_we_do' );            <i class="conum" data-value="5"></i><b>(5)</b>
     }
  &lt;/script&gt;
 &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>On a click of the button, call the event handler function. Call <code>pushState()</code> to modify the browser&#8217;s history. Other processing, such as making an Ajax request to the server, can be done in <code>whoWeAre()</code>, too.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Prepare the custom state object to be used in server-side requests. The information about <em>who we are</em> depends on the location ID.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Call <code>pushState()</code> to remember the customer ID, and add the suffix <em>/who_we_are</em> to serve as a path to the server-side RESTful request. The page title is empty; the History API currently ignores it.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Prepare the custom state object to be used in server-side requests. The information about <em>what we do</em> depends on customer ID.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Call <code>pushState()</code> to remember the customer ID, and add the suffix <em>/what_we_do</em> to serve as a path to the server-side RESTful request. The page title is empty; the History API currently ignores it.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This preceding sample is a simplified example and would require more code to properly form the server request, but our goal here is just to clearly illustrate the use of the History API.</p>
</div>
<div class="paragraph">
<p><a href="#FIG1-11">Testing pushState()</a> depicts the view after the user clicks the Who We Are button. The URL now shows <a href="http://127.0.0.1:8020/HistoryAPI/who_we_are" class="bare">http://127.0.0.1:8020/HistoryAPI/who_we_are</a>, but keep in mind that if you try to reload the page while this URL is shown, the browser will give you a Not Found error, and rightly so. There is no resource that represents the URL that ends with <em>who_we_are</em>—it&#8217;s just the name of the view in the browser&#8217;s history.</p>
</div>
<div id="FIG1-11" class="imageblock">
<div class="content">
<img src="images/ewdv_ab08.png" alt="ewdv ab08">
</div>
<div class="title">Figure 8. Testing pushState()</div>
</div>
<div class="paragraph">
<p>Using <code>replaceState()</code>, you can technically change history. We are talking about the browser&#8217;s history, of course.</p>
</div>
</div>
<div class="sect3">
<h4 id="_processing-the-popstate-event"><a class="anchor" href="#_processing-the-popstate-event"></a>Processing the popstate Event</h4>
<div class="paragraph">
<p>But changing the URL when the user clicks the Back or Forward button is just half of the job to be done. The content of the page has to be refreshed, accordingly. The browser dispatches the event <code>window.popstate</code> whenever the browser&#8217;s navigation history changes either on initial page load, as a result of clicking the Back/Forward buttons, or by invoking <code>history.back()</code> or <code>history.forward()</code>.</p>
</div>
<div class="paragraph">
<p>Your code has to include an event handler function that will  perform the actions that must be done whenever the application gets into the state represented by the current suffix (for example, make a server request to retrieve the data associated with the state <em>who_we_are</em>). The <code>popstate</code> event will contain a copy of the history&#8217;s entry state object. Let&#8217;s add the following event listener to the <code>&lt;script&gt;</code> part of the code sample from the previous section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript" data-lang="javascript">addEventListener('popstate',function (evt){
  console.log(evt);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#FIG1-12">Monitoring popState with Chrome Developers Tool</a> depicts the view of the Chrome Developer Tools when the debugger stops in the listener of the <code>popstate</code> event after the user clicks the Who We Are and then the What We Do buttons, and then the browser&#8217;s Back button. On the righthand side, you can see that the event object contains the <code>evt.state</code> object with the right values of <code>locID</code> and <code>uri</code>. In real-world scenarios these values could have been used in, say, an Ajax call to the server to re-create the view for the location ID 123.</p>
</div>
<div id="FIG1-12" class="imageblock">
<div class="content">
<img src="images/ewdv_ab09.png" alt="ewdv ab09">
</div>
<div class="title">Figure 9. Monitoring popState with Chrome Developers Tool</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you run into a browser that doesn&#8217;t support the HTML5 History API, consider using the <a href="https://github.com/browserstate/History.js">History.js</a> library.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Custom Data Attributes</div>
<div class="paragraph">
<p>We&#8217;ve included this sidebar in this appendix, even though it&#8217;s not an API. But we&#8217;re talking about HTML here and don&#8217;t want to miss this important feature of the HTML5 specification: you can add to any HTML tag any number of <a href="http://bit.ly/9Udecy">custom nonvisible attributes</a> as long as they start with <code>data-</code> and have at least one character after the hyphen. For example, this is absolutely legal in HTML5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;ol&gt;
 &lt;li data-phone="212-324-6656"&gt;Mary&lt;/li&gt;
 &lt;li data-phone="732-303-1234"&gt;Anna&lt;/li&gt;
 ...
&lt;/ol&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Behind the scenes, a custom framework can find all elements that have the <code>data-phone</code> attribute and generate additional code for processing the provided phone number. If this example doesn&#8217;t impress you, go to <a href="#responsive_design">[responsive_design]</a>, where you&#8217;ll learn how to use jQuery Mobile. The creators of this library use these <code>data-</code> attributes in a very smart way.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h3>
<div class="paragraph">
<p>In this appendix, you were introduced to a number of useful HTML5 APIs. You know how to check whether a particular API is supported by your web browser. But what if you are one of many enterprise developers who must use an Internet Explorer version earlier than 10.0? Google used to offer a nice solution:  <a href="http://www.google.com/chromeframe">Google Chrome Frame</a>, which was a plug-in for Internet Explorer.</p>
</div>
<div class="paragraph">
<p>Users had to install Chrome Frame on their machines, and web developers just needed to add the following line to their web pages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">&lt;meta http-equiv="X-UA-Compatible" content="chrome=1" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that, the web page rendering would be done by Chrome Frame, whereas your web application would run in Internet Explorer. Unfortunately, Google decided to discontinue supporting the Chrome Frame project as of January 2014. It is recommending to prompt the user of your application to upgrade the web browser, which might not be something users are willing to do. But let&#8217;s hope for the best.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2014-12-20 17:19:02 PST
</div>
</div>
</body>
</html>