<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Asciidoctor 0.1.4">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Appendix A. Advanced Introduction to JavaScript</title>
<style>
@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
@import url(http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic);
/* normalize.css v2.1.1 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }
/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }
/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }
/** Address styling not present in IE 8/9. */
[hidden] { display: none; }
/* ========================================================================== Base ========================================================================== */
/** 1. Prevent system color scheme's background color being used in Firefox, IE, and Opera. 2. Prevent system color scheme's text color being used in Firefox, IE, and Opera. 3. Set default font family to sans-serif. 4. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { background: #fff; /* 1 */ color: #000; /* 2 */ font-family: sans-serif; /* 3 */ -ms-text-size-adjust: 100%; /* 4 */ -webkit-text-size-adjust: 100%; /* 4 */ }
/** Remove default margin. */
body { margin: 0; }
/* ========================================================================== Links ========================================================================== */
/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }
/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }
/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }
/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }
/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }
/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }
/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }
/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }
/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }
/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }
/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }
/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }
/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }
/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }
/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }
/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }
/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }
/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }
/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }
/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }
/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }
/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }
/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }
/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }
/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }
/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }
/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }
/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }
*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
html, body { font-size: 100%; }
body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }
a:hover { cursor: pointer; }
a:focus { outline: none; }
img, object, embed { max-width: 100%; height: auto; }
object, embed { height: 100%; }
img { -ms-interpolation-mode: bicubic; }
#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }
.left { float: left !important; }
.right { float: right !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }
.text-center { text-align: center !important; }
.text-justify { text-align: justify !important; }
.hide { display: none; }
.antialiased, body { -webkit-font-smoothing: antialiased; }
img { display: inline-block; vertical-align: middle; }
textarea { height: auto; min-height: 50px; }
select { width: 100%; }
/* Grid HTML Classes */
.row { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; }
.row:before, .row:after { content: " "; display: table; }
.row:after { clear: both; }
.row.collapse .column, .row.collapse .columns { position: relative; padding-left: 0; padding-right: 0; float: left; }
.row .row { width: auto; margin-left: -0.9375em; margin-right: -0.9375em; margin-top: 0; margin-bottom: 0; max-width: none; *zoom: 1; }
.row .row:before, .row .row:after { content: " "; display: table; }
.row .row:after { clear: both; }
.row .row.collapse { width: auto; margin: 0; max-width: none; *zoom: 1; }
.row .row.collapse:before, .row .row.collapse:after { content: " "; display: table; }
.row .row.collapse:after { clear: both; }
.column, .columns { position: relative; padding-left: 0.9375em; padding-right: 0.9375em; width: 100%; float: left; }
@media only screen { .column, .columns { position: relative; padding-left: 0.9375em; padding-right: 0.9375em; float: left; }
  .small-1 { position: relative; width: 8.33333%; }
  .small-2 { position: relative; width: 16.66667%; }
  .small-3 { position: relative; width: 25%; }
  .small-4 { position: relative; width: 33.33333%; }
  .small-5 { position: relative; width: 41.66667%; }
  .small-6 { position: relative; width: 50%; }
  .small-7 { position: relative; width: 58.33333%; }
  .small-8 { position: relative; width: 66.66667%; }
  .small-9 { position: relative; width: 75%; }
  .small-10 { position: relative; width: 83.33333%; }
  .small-11 { position: relative; width: 91.66667%; }
  .small-12 { position: relative; width: 100%; }
  .small-offset-0 { position: relative; margin-left: 0%; }
  .small-offset-1 { position: relative; margin-left: 8.33333%; }
  .small-offset-2 { position: relative; margin-left: 16.66667%; }
  .small-offset-3 { position: relative; margin-left: 25%; }
  .small-offset-4 { position: relative; margin-left: 33.33333%; }
  .small-offset-5 { position: relative; margin-left: 41.66667%; }
  .small-offset-6 { position: relative; margin-left: 50%; }
  .small-offset-7 { position: relative; margin-left: 58.33333%; }
  .small-offset-8 { position: relative; margin-left: 66.66667%; }
  .small-offset-9 { position: relative; margin-left: 75%; }
  .small-offset-10 { position: relative; margin-left: 83.33333%; }
  [class*="column"] + [class*="column"]:last-child { float: right; }
  [class*="column"] + [class*="column"].end { float: left; }
  .column.small-centered, .columns.small-centered { position: relative; margin-left: auto; margin-right: auto; float: none !important; } }
/* Styles for screens that are atleast 768px; */
@media only screen and (min-width: 768px) { .large-1 { position: relative; width: 8.33333%; }
  .large-2 { position: relative; width: 16.66667%; }
  .large-3 { position: relative; width: 25%; }
  .large-4 { position: relative; width: 33.33333%; }
  .large-5 { position: relative; width: 41.66667%; }
  .large-6 { position: relative; width: 50%; }
  .large-7 { position: relative; width: 58.33333%; }
  .large-8 { position: relative; width: 66.66667%; }
  .large-9 { position: relative; width: 75%; }
  .large-10 { position: relative; width: 83.33333%; }
  .large-11 { position: relative; width: 91.66667%; }
  .large-12 { position: relative; width: 100%; }
  .row .large-offset-0 { position: relative; margin-left: 0%; }
  .row .large-offset-1 { position: relative; margin-left: 8.33333%; }
  .row .large-offset-2 { position: relative; margin-left: 16.66667%; }
  .row .large-offset-3 { position: relative; margin-left: 25%; }
  .row .large-offset-4 { position: relative; margin-left: 33.33333%; }
  .row .large-offset-5 { position: relative; margin-left: 41.66667%; }
  .row .large-offset-6 { position: relative; margin-left: 50%; }
  .row .large-offset-7 { position: relative; margin-left: 58.33333%; }
  .row .large-offset-8 { position: relative; margin-left: 66.66667%; }
  .row .large-offset-9 { position: relative; margin-left: 75%; }
  .row .large-offset-10 { position: relative; margin-left: 83.33333%; }
  .row .large-offset-11 { position: relative; margin-left: 91.66667%; }
  .push-1 { position: relative; left: 8.33333%; right: auto; }
  .pull-1 { position: relative; right: 8.33333%; left: auto; }
  .push-2 { position: relative; left: 16.66667%; right: auto; }
  .pull-2 { position: relative; right: 16.66667%; left: auto; }
  .push-3 { position: relative; left: 25%; right: auto; }
  .pull-3 { position: relative; right: 25%; left: auto; }
  .push-4 { position: relative; left: 33.33333%; right: auto; }
  .pull-4 { position: relative; right: 33.33333%; left: auto; }
  .push-5 { position: relative; left: 41.66667%; right: auto; }
  .pull-5 { position: relative; right: 41.66667%; left: auto; }
  .push-6 { position: relative; left: 50%; right: auto; }
  .pull-6 { position: relative; right: 50%; left: auto; }
  .push-7 { position: relative; left: 58.33333%; right: auto; }
  .pull-7 { position: relative; right: 58.33333%; left: auto; }
  .push-8 { position: relative; left: 66.66667%; right: auto; }
  .pull-8 { position: relative; right: 66.66667%; left: auto; }
  .push-9 { position: relative; left: 75%; right: auto; }
  .pull-9 { position: relative; right: 75%; left: auto; }
  .push-10 { position: relative; left: 83.33333%; right: auto; }
  .pull-10 { position: relative; right: 83.33333%; left: auto; }
  .push-11 { position: relative; left: 91.66667%; right: auto; }
  .pull-11 { position: relative; right: 91.66667%; left: auto; }
  .column.large-centered, .columns.large-centered { position: relative; margin-left: auto; margin-right: auto; float: none !important; }
  .column.large-uncentered, .columns.large-uncentered { margin-left: 0; margin-right: 0; float: left !important; }
  .column.large-uncentered.opposite, .columns.large-uncentered.opposite { float: right !important; } }
/* Image Thumbnails */
.th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); -webkit-transition: all 200ms ease-out; -moz-transition: all 200ms ease-out; transition: all 200ms ease-out; }
.th:hover, .th:focus { -webkit-box-shadow: 0 0 6px 1px rgba(43, 166, 203, 0.5); box-shadow: 0 0 6px 1px rgba(43, 166, 203, 0.5); }
.th.radius { -webkit-border-radius: 3px; border-radius: 3px; }
a.th { display: inline-block; }
button, .button { border-style: solid; border-width: 1px; cursor: pointer; font-family: inherit; font-weight: bold; line-height: 1; margin: 0 0 1.25em; position: relative; text-decoration: none; text-align: center; display: inline-block; padding-top: 0.75em; padding-right: 1.5em; padding-bottom: 0.8125em; padding-left: 1.5em; font-size: 1em; background-color: #2ba6cb; border-color: #2284a1; color: white; }
button:hover, button:focus, .button:hover, .button:focus { background-color: #2284a1; }
button:hover, button:focus, .button:hover, .button:focus { color: white; }
button.secondary, .button.secondary { background-color: #e9e9e9; border-color: #d0d0d0; color: #333333; }
button.secondary:hover, button.secondary:focus, .button.secondary:hover, .button.secondary:focus { background-color: #d0d0d0; }
button.secondary:hover, button.secondary:focus, .button.secondary:hover, .button.secondary:focus { color: #333333; }
button.success, .button.success { background-color: #5da423; border-color: #457a1a; color: white; }
button.success:hover, button.success:focus, .button.success:hover, .button.success:focus { background-color: #457a1a; }
button.success:hover, button.success:focus, .button.success:hover, .button.success:focus { color: white; }
button.alert, .button.alert { background-color: #c60f13; border-color: #970b0e; color: white; }
button.alert:hover, button.alert:focus, .button.alert:hover, .button.alert:focus { background-color: #970b0e; }
button.alert:hover, button.alert:focus, .button.alert:hover, .button.alert:focus { color: white; }
button.large, .button.large { padding-top: 1em; padding-right: 2em; padding-bottom: 1.0625em; padding-left: 2em; font-size: 1.25em; }
button.small, .button.small { padding-top: 0.5625em; padding-right: 1.125em; padding-bottom: 0.625em; padding-left: 1.125em; font-size: 0.8125em; }
button.tiny, .button.tiny { padding-top: 0.4375em; padding-right: 0.875em; padding-bottom: 0.5em; padding-left: 0.875em; font-size: 0.6875em; }
button.expand, .button.expand { padding-right: 0px; padding-left: 0px; width: 100%; }
button.left-align, .button.left-align { text-align: left; text-indent: 0.75em; }
button.right-align, .button.right-align { text-align: right; padding-right: 0.75em; }
button.disabled, button[disabled], .button.disabled, .button[disabled] { background-color: #2ba6cb; border-color: #2284a1; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { background-color: #2284a1; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { color: white; }
button.disabled:hover, button.disabled:focus, button[disabled]:hover, button[disabled]:focus, .button.disabled:hover, .button.disabled:focus, .button[disabled]:hover, .button[disabled]:focus { background-color: #2ba6cb; }
button.disabled.secondary, button[disabled].secondary, .button.disabled.secondary, .button[disabled].secondary { background-color: #e9e9e9; border-color: #d0d0d0; color: #333333; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { background-color: #d0d0d0; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { color: #333333; }
button.disabled.secondary:hover, button.disabled.secondary:focus, button[disabled].secondary:hover, button[disabled].secondary:focus, .button.disabled.secondary:hover, .button.disabled.secondary:focus, .button[disabled].secondary:hover, .button[disabled].secondary:focus { background-color: #e9e9e9; }
button.disabled.success, button[disabled].success, .button.disabled.success, .button[disabled].success { background-color: #5da423; border-color: #457a1a; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { background-color: #457a1a; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { color: white; }
button.disabled.success:hover, button.disabled.success:focus, button[disabled].success:hover, button[disabled].success:focus, .button.disabled.success:hover, .button.disabled.success:focus, .button[disabled].success:hover, .button[disabled].success:focus { background-color: #5da423; }
button.disabled.alert, button[disabled].alert, .button.disabled.alert, .button[disabled].alert { background-color: #c60f13; border-color: #970b0e; color: white; cursor: auto; opacity: 0.6; -webkit-box-shadow: none; box-shadow: none; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { background-color: #970b0e; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { color: white; }
button.disabled.alert:hover, button.disabled.alert:focus, button[disabled].alert:hover, button[disabled].alert:focus, .button.disabled.alert:hover, .button.disabled.alert:focus, .button[disabled].alert:hover, .button[disabled].alert:focus { background-color: #c60f13; }
button, .button { padding-top: 0.8125em; padding-bottom: 0.75em; -webkit-appearance: none; }
button.tiny, .button.tiny { padding-top: 0.5em; padding-bottom: 0.4375em; -webkit-appearance: none; }
button.small, .button.small { padding-top: 0.625em; padding-bottom: 0.5625em; -webkit-appearance: none; }
button.large, .button.large { padding-top: 1.03125em; padding-bottom: 1.03125em; -webkit-appearance: none; }
@media only screen { button, .button { -webkit-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset; box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset; -webkit-transition: background-color 300ms ease-out; -moz-transition: background-color 300ms ease-out; transition: background-color 300ms ease-out; }
  button:active, .button:active { -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2) inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2) inset; }
  button.radius, .button.radius { -webkit-border-radius: 3px; border-radius: 3px; }
  button.round, .button.round { -webkit-border-radius: 1000px; border-radius: 1000px; } }
@media only screen and (min-width: 768px) { button, .button { display: inline-block; } }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }
.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #003b6b; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }
/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }
/* Default Link Styles */
a { color: #00579e; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333333; }
a img { border: none; }
/* Default paragraph styles */
p { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }
/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-weight: normal; font-style: normal; color: #7b2d00; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #ff6b15; line-height: 0; }
h1 { font-size: 2.125em; }
h2 { font-size: 1.6875em; }
h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }
h4 { font-size: 1.125em; }
h5 { font-size: 1.125em; }
h6 { font-size: 1em; }
hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }
/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }
strong, b { font-weight: bold; line-height: inherit; }
small { font-size: 60%; line-height: inherit; }
code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #003426; }
/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; }
ul, ol { margin-left: 1.5em; }
/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }
/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }
/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }
/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #dddddd; cursor: help; }
abbr { text-transform: none; }
/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #e15200; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #e15200; }
blockquote, blockquote p { line-height: 1.6; color: #333333; }
/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }
.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }
@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }
@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: -webkit-linear-gradient(top, #add386, #90b66a); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: white; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #edf2f2; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }
a:hover, a:focus { text-decoration: underline; }
.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }
*:not(pre) > code { font-size: inherit; padding: 3px 2px 1px 2px; white-space: nowrap; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }
pre, pre > code { line-height: 1.6; color: black; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }
kbd.keyseq { color: #333333; }
kbd:not(.keyseq) { display: inline-block; color: black; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }
kbd kbd:first-child { margin-left: 0; }
kbd kbd:last-child { margin-right: 0; }
.menuseq, .menu { color: black; }
#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }
#header { margin-bottom: 2.5em; }
#header > h1 { color: #7b2d00; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #333333; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }
#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }
#toctitle { color: #003b6b; }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }
#content #toctitle { font-weight: bold; font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-size: 1em; padding-left: 0.125em; }
#footer { max-width: 100%; background-color: none; padding: 1.25em; }
#footer-text { color: black; line-height: 1.44; }
.sect1 { padding-bottom: 1.25em; }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }
#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #7b2d00; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #622400; }
.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }
.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }
.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }
.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #333333; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }
.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }
.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #aaaaaa; box-shadow: 0 1px 8px #aaaaaa; }
.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #003b6b; margin-top: 0; line-height: 1.6; }
.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }
.literalblock > .content pre, .listingblock > .content pre { background: #eeeeee; border-width: 1px; border-style: dashed; border-color: #666666; -webkit-border-radius: 0; border-radius: 0; padding: 1.25em 1.5625em 1.125em 1.5625em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.72em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.81em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }
.listingblock > .content { position: relative; }
.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }
.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }
.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }
.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }
table.pyhltable { border: 0; margin-bottom: 0; }
table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }
table.pyhltable td.code { padding-left: .75em; padding-right: 0; }
.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }
.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }
table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }
.quoteblock { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 0.75em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #e15200; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }
table thead th, table tfoot th { font-weight: bold; }
table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }
table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }
table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }
table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }
th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }
th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }
th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }
th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }
th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }
th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }
p.tableblock.header { color: white; font-weight: bold; }
td > div.verse { white-space: pre; }
ol { margin-left: 1.75em; }
ul li ol { margin-left: 1.5em; }
dl dd { margin-left: 1.125em; }
dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }
ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }
ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }
ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }
ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }
ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }
ul.inline { margin: 0 auto 0.375em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }
.unstyled dl dt { font-weight: normal; font-style: normal; }
ol.arabic { list-style-type: decimal; }
ol.decimal { list-style-type: decimal-leading-zero; }
ol.loweralpha { list-style-type: lower-alpha; }
ol.upperalpha { list-style-type: upper-alpha; }
ol.lowerroman { list-style-type: lower-roman; }
ol.upperroman { list-style-type: upper-roman; }
ol.lowergreek { list-style-type: lower-greek; }
.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }
td.hdlist1 { padding-right: .8em; font-weight: bold; }
td.hdlist1, td.hdlist2 { vertical-align: top; }
.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }
.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }
.qanda > ol > li > p > em:only-child { color: #004985; }
.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2); }
.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }
.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }
a.image { text-decoration: none; }
span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }
.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }
div.unbreakable { page-break-inside: avoid; }
.big { font-size: larger; }
.small { font-size: smaller; }
.underline { text-decoration: underline; }
.overline { text-decoration: overline; }
.line-through { text-decoration: line-through; }
.aqua { color: #00bfbf; }
.aqua-background { background-color: #00fafa; }
.black { color: black; }
.black-background { background-color: black; }
.blue { color: #0000bf; }
.blue-background { background-color: #0000fa; }
.fuchsia { color: #bf00bf; }
.fuchsia-background { background-color: #fa00fa; }
.gray { color: #606060; }
.gray-background { background-color: #7d7d7d; }
.green { color: #006000; }
.green-background { background-color: #007d00; }
.lime { color: #00bf00; }
.lime-background { background-color: #00fa00; }
.maroon { color: #600000; }
.maroon-background { background-color: #7d0000; }
.navy { color: #000060; }
.navy-background { background-color: #00007d; }
.olive { color: #606000; }
.olive-background { background-color: #7d7d00; }
.purple { color: #600060; }
.purple-background { background-color: #7d007d; }
.red { color: #bf0000; }
.red-background { background-color: #fa0000; }
.silver { color: #909090; }
.silver-background { background-color: #bcbcbc; }
.teal { color: #006060; }
.teal-background { background-color: #007d7d; }
.white { color: #bfbfbf; }
.white-background { background-color: #fafafa; }
.yellow { color: #bfbf00; }
.yellow-background { background-color: #fafa00; }
span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }
.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #00579e; color: #004176; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }
.conum { display: inline-block; color: white !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
body { font-family: "Droid Serif", Georgia, "Times New Roman", Times, serif; font-size: 16px; color: #111; }
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #dddddd; }
#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }
.sidebarblock { border-color: #aaa; }
code { -webkit-border-radius: 4px; border-radius: 4px; }
p.tableblock.header { color: #6d6e71; }
</style>
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/default.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#appendix_a">Appendix A: Appendix A. Advanced Introduction to JavaScript</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_javascript_a_brief_history">JavaScript: A Brief History</a></li>
<li><a href="#_javascript_variables">JavaScript Variables</a></li>
<li><a href="#_getting_familiar_with_aptana_ide">Getting Familiar with Aptana IDE</a></li>
<li><a href="#_adding_javascript_to_html">Adding JavaScript to HTML</a></li>
<li><a href="#_debugging_javascript_in_web_browsers">Debugging JavaScript in Web Browsers</a></li>
<li><a href="#_javascript_functions_gentle_introduction">JavaScript Functions. Gentle Introduction</a></li>
<li><a href="#_javascript_objects_gentle_introduction">JavaScript Objects. Gentle Introduction</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_object_literals">Object Literals</a></li>
<li><a href="#_constructor_functions">Constructor Functions</a></li>
</ul>
</li>
<li><a href="#_debugging_javascript_in_firebug">Debugging JavaScript in Firebug</a></li>
<li><a href="#_prototypal_inheritance">Prototypal Inheritance</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_avoiding_declaration_redundancy">Avoiding Declaration Redundancy</a></li>
<li><a href="#_method_overriding">Method overriding</a></li>
</ul>
</li>
<li><a href="#_scope_or_who_s_this">Scope or who&#8217;s this?</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_call_and_apply">Call and Apply</a></li>
<li><a href="#_callbacks">Callbacks</a></li>
<li><a href="#_hoisting">Hoisting</a></li>
<li><a href="#_function_properties">Function properties</a></li>
</ul>
</li>
<li><a href="#_closures">Closures</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_a_formal_definition_attempt">A Formal Definition Attempt</a></li>
<li><a href="#_why_do_we_need_closures">Why do we Need Closures?</a></li>
<li><a href="#_closures_as_callbacks">Closures as callbacks</a></li>
</ul>
</li>
<li><a href="#_mixins">Mixins</a></li>
<li><a href="#_javascript_in_the_web_browser">JavaScript in the Web Browser</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_the_document_object_model_dom">The Document Object Model (DOM)</a></li>
<li><a href="#_working_with_dom">Working with DOM</a></li>
<li><a href="#_dom_events">DOM Events</a></li>
</ul>
</li>
<li><a href="#_summary">Summary</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="appendix_a">Appendix A: Appendix A. Advanced Introduction to JavaScript</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>"Atwood&#8217;s Law: any application that can be written in JavaScript, will eventually be written in JavaScript.</em></p>
</div>
<div class="paragraph">
<p>This Appendix is dedicated to the JavaScript programming language. While all chapters of this book show how JavaScript frameworks can greatly minimize the amount of the JavaScript code that you need to write manually, you still need to understand the language itself. We assume that you have some programming experience with any programming, understand the HTML syntax, and are familiar with general principal of communications between Web browsers and Web servers. We&#8217;ve included the word <em>advanced</em> in the title of this Appendix because of these assumptions. We&#8217;ll start with covering basics of the language, but then quickly progress to such advanced topics as <em>prototypal inheritance, callbacks, and closures</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
If you&#8217;re absolute beginner with Web development and had no previous exposure to JavaScript, consider reading one of the fundamental tutorials covering each and every detail of JavaScript. We can recommend you the book "JavaScript: The Definite Guide", Sixth Edition by David Flanagan.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Besides the JavaScript coverage this Appendix  includes a section on the tools (IDEs, debuggers, Web inspectors et al.) that will make your development process more productive.</p>
</div>
<div class="sect2">
<h3 id="_javascript_a_brief_history">JavaScript: A Brief History</h3>
<div class="paragraph">
<p>The JavaScript programming language was designed in 1995 by Brendan Eich, who was working for Netscape Communications Corporation at the time. His goal was to allow developers create more interactive Web pages. Initially the name of this language was Mocha, then LiveScript, and finally Netscape agreed with Sun Microsystems, creator of Java to rename it to JavaScript.</p>
</div>
<div class="paragraph">
<p>A year later, the language was given to an international standards body called ECMA, which formalized the language into <em>ECMAScript standard</em> so that other Web browser vendors could create their implementation of this standard. JavaScript is not the only language created based on the ECMAScript specification - ActionScript is a good example of another popular dialect of ECMAScript.</p>
</div>
<div class="paragraph">
<p>To learn more about the history of JavaScript from the source watch the Brendan Eich’s presentation
<a href="http://www.youtube.com/watch?v=Rj49rmc01Hs">"JavaScript at 17"</a> at O’Reilly’s conference Fluent 2012.</p>
</div>
<div class="paragraph">
<p>Vast majority of today&#8217;s JavaScript code is being executed by the Web browsers, but there are JavaScript engines that can execute JavaScript code independently. For example, <a href="http://code.google.com/p/v8/">Google’s V8</a> JavaScript engine implements ECMAScript 5 and is used not only in the Chrome browser, but can run in a standalone mode and can be embedded in any C++ application. Using the same programming language on the client and the server is the main selling point of node.js, which runs on top of V8. Oracle’s Java Development Kit (JDK) 8 will include the JavaScript engine Nashorn that not only can run on both the server and the client computers, but also allows to embed the fragments of JavaScript into Java programs.</p>
</div>
<div class="paragraph">
<p>In the ninetieth, JavaScript was considered a second class language used mainly for prettifying Web pages. In 2005 the techniques known as AJAX (see Chapter 2) made a significant impact to the way Web pages were built. With AJAX, the specific content inside the Web page could be updated without the need to make a full page refresh. For example, Google&#8217;s gmail that inserts just one line at the top of your input box whenever the new email arrives - it doesn&#8217;t usually re-retrieve the entire content of your Inbox from the server and definitely doesn&#8217;t re-render the Web page.</p>
</div>
<div class="paragraph">
<p>AJAX gave a second birth to JavaScript. But the vendors of Web browsers were not eager to implement the latest specifications of ECMAScript. Browsers’ incompatibility and lack of good development tools  prevented JavaScript from becoming the language of choice for Web applications. Let’s not forget about the ubiquitous Flash Player – a popular VM supported by all desktop Web browsers. Rich Internet Applications written in ActionScript were compiled into the byte code and executed by Flash Player on the user’s machine inside the Web browser.</p>
</div>
<div class="paragraph">
<p>If AJAX saved JavaScript, then rapid proliferation of tablets and smartphones made it really hot. Today&#8217;s mobile devices come equipped with modern Web browsers, and in the mobile world there is no need to make sure that your Web application will work in the 4-year old Internet Explorer 8. Adobe&#8217;s decision to stop supporting Flash Player in the mobile Web browsers is yet another reason to turn to JavaScript if your Web application has to be accessed from smartphones or tablets.</p>
</div>
<div class="paragraph">
<p>ECMASript, 5th Edition has been published in 2009 and is currently supported by all modern Web browsers. If you are interested in discovering if specific features of ECMAScript 5 are supported by a particular Web browser, check the latest version of the <a href="http://kangax.github.com/es5-compat-table/#">ECMAScript 5
compatibility table</a>. At the time of this writing the snapshot of the Chrome Browser v. 22 looks as in <a href="#FIG2-1">ECMAScript 5 Compatibility Sample Chart</a> below:</p>
</div>
<div id="FIG2-1" class="imageblock">
<div class="content">
<img src="images/fig_02_01.jpg" alt="fig 02 01">
</div>
<div class="title">Figure 1. ECMAScript 5 Compatibility Sample Chart</div>
</div>
<div class="paragraph">
<p>JavaScript became the lowest common denominator available on thousands of different devices. Yes, the JavaScript engines are not exactly the same on thousands devices that people use to login to Facebook, but they are pretty close, and using some of the JavaScript frameworks spare you from worrying about their incompatibilities.</p>
</div>
<div class="paragraph">
<p>JavaScript is an interpreted language that arrives to the Web browser as text. The JavaScript engine optimizes and compiles the code before the execution. The JavaScript engine is a part of the Web browser, which will load and execute the JavaScript code embedded or referenced between the HTML tags <code>&lt;script&gt;</code> and <code>&lt;/script&gt;</code>. JavaScript was originally created for Web browsers, which were supposed to display whatever content has successfully arrived. What if an image has not arrived from the server? You’ll see a broken image icon. What if erroneous JavaScript code with syntax errors has arrived to the browser? Well, the engine will try to execute whatever code has arrived. The end users may appreciate such browser&#8217;s forgiveness when at least some content is available, but the software developers should be ready to spend more time debugging (in multiple browsers) the errors that could have been caught by compilers in other programming languages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_javascript_variables">JavaScript Variables</h3>
<div class="paragraph">
<p>JavaScript is a weakly typed language hence the developers don’t have a luxury of strong compiler&#8217;s help that Java or C# developers enjoy.  For those unfamiliar with weakly typed languages, let us  explain. Imagine that if in Java or C# instead of declaring variables of specific data types everything would be of type <code>Object</code>, and you could assign to it any value – a string, a number, or a custom object <code>Person</code>. This would substantially complicate the ability of the compiler to weed out all possible errors. You don’t need to declare variables in JavaScript – just assign a value and the JavaScript engine will figure out the proper type during the execution of your code.For example, the variable named <code>girlfriend</code> will have a data type of <code>String</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>girlfriendName=“Mary”;</pre>
</div>
</div>
<div class="paragraph">
<p>Since we haven’t used the keyword <code>var</code> in front of <code>girlfriend</code>, this variable will have the global scope, which is a big no-no. Creating your global variables in an Web application that often includes multiple libraries from different vendors can easily create situations when the variable&#8217;s value has been accidentally replaced by someone else&#8217;s code. Besides, if the application uses concurrent execution (read about Web Workers in Appendix B) using global variable can lead to race conditions. Pretty soon you&#8217;ll see how to limit the scope of application&#8217;s variables to avoid polluting global space.</p>
</div>
<div class="paragraph">
<p>Variables declared with the <code>var</code> keyword inside functions are have local scope and are not visible from outside of the function. Consider the following function declaration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">function addPersonalInfo(){
   var address ="123 Main Street";      // local String variable
   age=25;                              // global Number variable
   var isMarried == true;                // local boolean variable
   isMarried == "don't remember";        // now it's of String type
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The variables <code>address</code> and <code>isMarried</code> are visible only inside the function <code>addPersonalInfo()</code>. The variable <code>age</code> becomes global because of omission of the keyword <code>var</code>.</p>
</div>
<div class="paragraph">
<p>The variable <code>isMarried</code> changes its type from <code>Boolean</code> to <code>String</code> during the execution of the above script, and JavaScript engine won&#8217;t complain assuming that the programmer knows what she’s doing. So be ready for the run-time surprises and allocate a lot more time for testing than with programs written in  compiled languages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_getting_familiar_with_aptana_ide">Getting Familiar with Aptana IDE</h3>
<div class="paragraph">
<p>Download and install Aptana Studio 3 from <a href="http://aptana.com">http://aptana.com</a>. Start Aptana IDE, then close its initial tab view by clicking on the little X on the tab. Then customize the color theme of this IDE by clicking the rainbow-colored circle on its toolbar. We usually select the theme called Eclipse. After the first start of Aptana you’ll see the message on the left side that reads &#8220;There are no projects in your workspace. To get started, please create or import an existing one.&#8221;</p>
</div>
<div class="paragraph">
<p>If you want to start playing with the code samples that come with this book, click on the button Import Project, select the General | Archive file. Find the zip file you&#8217;d like to use, e.g. chapter2.zip, and press Finish. The project from the selected zip file will be imported into the Aptana&#8217;s <em>workspace</em>, which is nothing more than a folder on the disk where the source code will reside. When you work in Aptana IDE you see a set of <em>views</em> (panels). This set is called <em>perspective</em>. For Web projects Aptana uses Web perspective, which is indicated at the top right corner. Pressing the icon with a little pus sign at the top right allows to open another perspective with its own set of views.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s get started with creating a project from scratch by pressing the button Create Project on the left. You could have also created a new Web Project using the File menu. On the next window you&#8217;ll need to select a wizard, and we&#8217;ll be always working with Web Projects throughout this book. The next window will offer you to select a project template - let&#8217;s stick to the simplest one - Default Project. Name it  MyFirstProject.</p>
</div>
<div class="paragraph">
<p>To add an HTML file to this project select the project (its name becomes highlighted) and then  select the menu File | New From Template | HTML | HTML5 Template. Aptana will offer you new_file.html the name of this file - no need to change it for now. Just press finish and you&#8217;ll see a window similar to the one shown on <a href="#FIG2-2">Aptana IDE with one HTML5 file</a>.</p>
</div>
<div id="FIG2-2" class="imageblock">
<div class="content">
<img src="images/fig_02_02.jpg" alt="fig 02 02">
</div>
<div class="title">Figure 2. Aptana IDE with one HTML5 file</div>
</div>
<div class="paragraph">
<p>Right-click on the new_file.html and select the menu Run as JavaScript Web project. Don&#8217;t get upset that there is no JavaScript code there yet - we&#8217;ll add it pretty soon. Aptana starts its built-in Web server that by default runs on the port 8020 (it&#8217;s configurable in Aptana Preferences). The Web browser opens up and displays the page that looks like the one in <a href="#FIG2-3">Running MyFirstProject</a>. Aptana has used its default template to generate HTML file. The template can be changed to your liking, and you can read about it in Aptana&#8217;s documentation at <a href="http://bitly.com/LRqRdU">http://bitly.com/LRqRdU</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
If you have your index.html open in Aptana&#8217;s editor, you can simply press the green triangle on the toolbar and run this file in the Web browser.
</td>
</tr>
</table>
</div>
<div id="FIG2-3" class="imageblock">
<div class="content">
<img src="images/fig_02_03.jpg" alt="fig 02 03">
</div>
<div class="title">Figure 3. Running MyFirstProject</div>
</div>
<div class="paragraph">
<p>To configure the Web Browser that Aptana should open by default, open its Preferences window and select the Web browser of your choice under the General section. The authors of this book use mainly Google Chrome browser, but in this book we&#8217;ll be giving using Firefox as well just to show you that developers have a choice too. Many examples in this chapter use the Firefox with installed add-on Firebug, so start with making Firefox your default browser in Aptana.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
you can find various HTML5 boilerplate projects on the Web that can be used as a starting point of your project. You don&#8217;t have to select the Aptana&#8217;s HTML5 boilerplate if it doesn&#8217;t fit your needs. For example, you can download a bare minimum boilerplate <a href="http://projects.craftedpixelz.co.uk/shibui/">Shibui</a>
or more comprehensive <a href="http://html5boilerplate.com/">HTML5 Boilerplate</a>. Just download and unzip such a boilerplate project into your Aptana&#8217;s workspace and start adding your code, styles, and other resources.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_adding_javascript_to_html">Adding JavaScript to HTML</h3>
<div class="paragraph">
<p>Software developers either directly include the  JavaScript code to the HTML document by placing it between the tags <code>&lt;script&gt;</code> and <code>&lt;/script&gt;</code> or include a reference to the external location of the code (e.g. a local file name or a URL) in the <code>src</code> attribute of the <code>&lt;script&gt;</code> tag. We usually place the <code>&lt;script&gt;`tags at the end of HTML file. The reason is simple - your JavaScript code may be manipulating with HTML elements, and you want them to exist by the time the script runs. The other way to ensure that the code will run only after the Web page has loaded is by catching window's `load</code> event (you&#8217;ll see such example later in this chapter in the section on browser&#8217;s events). Some JavaScript frameworks may have their own approach to dealing with HTML content and in Chapter 4  you&#8217;ll see that the main HTML file of the Web application written with Ext JS framework has <code>&lt;script&gt;</code> tags followed by the empty <code>&lt;body&gt;</code> tags. But let&#8217;s keep things simple for now.</p>
</div>
<div class="paragraph">
<p>Add the following fragment at the very end (right above the closing <code>&lt;/body&gt;</code> tag) of the new_file.html from <a href="#FIG2-2">Aptana IDE with one HTML5 file</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">&lt;script&gt;
   alert("Hello from JavaScript");
&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the new_file.html in Aptana and you&#8217;ll see the following output in your Web browser:</p>
</div>
<div id="FIG2-4" class="imageblock">
<div class="content">
<img src="images/fig_02_04.jpg" alt="fig 02 04">
</div>
<div class="title">Figure 4. Running MyFirstProject with JavaScript at the bottom</div>
</div>
<div class="paragraph">
<p>Note that the <code>Alert</code> popup box is shown on top of the Web page that already rendered all of its HTML components. Now move the above code up to the end of the <code>&lt;head&gt;</code> section and re-run new_file.html. The picture is different now - the Alert box is shown before the HTML rendering is complete.</p>
</div>
<div id="FIG2-5" class="imageblock">
<div class="content">
<img src="images/fig_02_05.jpg" alt="fig 02 05">
</div>
<div class="title">Figure 5. Running MyFirstProject with JavaScript at the top</div>
</div>
<div class="paragraph">
<p>In this simple example this doesn&#8217;t cause any malfunctioning of the code, but if our JavaScript would need to manipulate with HTML elements, we&#8217;d run into issues of accessing non-existent components. Beside simple <code>Alert</code> box, JavaScript has <code>Confirm</code> and <code>Prompt</code> boxes, which allow asking OK/Cancel type of questions or request some input from the user.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
In a real life you won&#8217;t be deploying your projects under Aptana&#8217;s internal Web server. When you code is tested you can FTP it to a remote server of your choice, e.g. Apache Web Server or IIS. Right-click on your Aptana project and select the menu option Publish. This will allow you to configure the FTP connection to your remote server and publish your working code there as you wish.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_debugging_javascript_in_web_browsers">Debugging JavaScript in Web Browsers</h3>
<div class="paragraph">
<p>The best way to learn any program is to run it step by step through a debugger. While some people appreciate using debuggers offered by the IDE, we prefer to debug using great tools offered by the major Web browsers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Firefox: Firebug add-on</p>
</li>
<li>
<p>Chrome: Developer Tools</p>
</li>
<li>
<p>Internet Explorer: F12 Developer Tools</p>
</li>
<li>
<p>Safari: the menu Develop</p>
</li>
<li>
<p>Opera: Dragonfly</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;ll be doing most of the debugging either in Firebug or Chrome Developer Tools. Both of them provide valuable information about your code and are easy to use. To get Firebug go to <a href="http://www.getfirebug.com">www.getfirebug.com</a> and press the red button Install Firebug and follow the instructions. In Firefox, open the Firebug panel from the menu View.</p>
</div>
<div id="FIG2-6" class="imageblock">
<div class="content">
<img src="images/fig_02_06.jpg" alt="fig 02 06">
</div>
<div class="title">Figure 6. FireBug Console</div>
</div>
<div class="paragraph">
<p>Select the Console option on the Firebug toolbar, <a href="http://getfirebug.com/enable">enable the console</a>  and enter <code>alert("Hello from JavaScript")</code> after the &gt;&gt;&gt; sign and you&#8217;ll see the Alert box. To enter multi-line JavaScript code press the little circle with a caret at the bottom right corner and Firebug will open a panel on the right, where you can enter and run your JavaScript code.</p>
</div>
<div class="paragraph">
<p>This was probably the last example where we used the <code>Alert()</code> popup box for debugging purposes. All JavaScript debuggers support the <code>console.log()</code> for printing debug information.  Consider the following example that illustrate strict equality operator ==. Yes, it&#8217;s three equal signs in a row. This operator evaluates to true if the values are equal and the data types are the same.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var age=25;

var ageStr="25";

if (age==ageStr){
  console.log("The values of age and ageStr are equal");
}

if (age==ageStr){
 console.log("The values of age and ageStr are strictly equal");
} else{
 console.log ("The values of age and ageStr are not strictly equal");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running this code in the Firebug console produces the following output:</p>
</div>
<div id="FIG2-7" class="imageblock">
<div class="content">
<img src="images/fig_02_07.jpg" alt="fig 02 07">
</div>
<div class="title">Figure 7. Using console.log() for the debug output</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also use <code>console.info()</code>, <code>console.debug()</code>, and <code>console.error()</code> so the debuggers may  highlight the output with different colors or mark with different icons.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
For more information about debugging JavaScript refer to the code samples illustrated in <a href="#FIG2-8">Firebug&#8217;s Script panel</a> and <a href="#FIG2-9">Firebug&#8217;s Script panel at a breakpoint</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_javascript_functions_gentle_introduction">JavaScript Functions. Gentle Introduction</h3>
<div class="paragraph">
<p>JavaScript can be called an object-oriented language cause it allows an object to inherit existing  functionality from another object, and you can encapsulate the data and restrict the data access. It&#8217;s done not as simple as in classical object-oriented languages, but it&#8217;s possible.  Now comes the chicken or the egg dilemma. What should be explained first - the syntax of functions or creation of objects? Understanding of objects is needed for some of the function code samples and visa versa. We&#8217;ll start with simple function use cases, but will be switching to objects as needed.</p>
</div>
<div class="paragraph">
<p>Many of the readers can have experience with object-oriented languages like Java or C#, where classes can include <em>methods</em> implementing required functionality. Then these methods can be invoked with or without instantiation of the objects. If a JavaScript object includes functions they are called <em>methods</em>. But JavaScript functions don&#8217;t have to belong to an object. You can just declare a function and invoke it. Just like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">//Function declaration
function calcTax (income, dependents){
   var tax;
   // Do stuff here
   return tax;
}

//Function invocation
calcTax(50000, 2);
var myTax == calcTax(50000,2);</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="icon-warning" title="Warning"></i>
</td>
<td class="content">
Please note that the data types of the function parameters <code>income</code> and <code>dependents</code> are not specified. We can only guess that they are numbers based on their names. If a software developer won&#8217;t bother giving meaningful names to function parameters, the code becomes difficult to read.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After the function <code>calcTax()</code> is invoked and complete, the variable <code>myTax</code> will have the value returned by the function.</p>
</div>
<div class="paragraph">
<p>Another important thing to notice is that our function has a name <code>calcTax</code>. But this is not always the case - JavaScript allows functions to be <em>anonymous</em> - you&#8217;ll see an example of anonymous functions in the function expressions below (note the absence of a name after the keyword <code>function</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
If you see the line of code where the keyword <code>function</code> is preceded by any other character this is not a function declaration, but a function expression.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Consider the following variation of the tax calculation sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">//Function expression
var doTax=function (income, dependents){
	//do stuff here
   return tax;
}

//Function invocation
var myTax=doTax(50000,2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the code above the <code>function</code> keyword is being used in the expression - we assign the anonymous function to the variable <code>doTax</code>. After this assignment just the text of the function is assigned to the variable <code>doTax</code> - the anonymous function is not being invoked just yet. It&#8217;s important to understand that even though the code of this anonymous function ends with <code>return tax;</code> actually, the tax calculation and return of its value is not happening until the <code>doTax()</code> is invoked. Only then the function is evaluated and the variable <code>myTax</code> will get whatever value this function returns.</p>
</div>
<div class="paragraph">
<p>Yet another example of a function expression is when it&#8217;s placed inside the <em>grouping operator</em> - parentheses as shown below. As in an arithmetic expressions, this means that the the content inside the expressions has to be evaluated first, and then used in an expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">(function calcTax (income, dependents){
   // Do stuff here
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The outermost parentheses hide its internal code from the outside world creating a scope or a closed ecosystem, where the function&#8217;s code will operate. Try to add a line invoking this function after the last line in the above code sample, e.g. <code>calcTax(50000,2)</code>, and you&#8217;ll get an error - "calcTax is not defined". There is a way to expose some of the internal content of such a <em>closure</em> and you&#8217;ll see how to do it later in this appendix.</p>
</div>
<div class="paragraph">
<p>If you&#8217;ll take away the outermost parentheses and the closing semicolon, you&#8217;ll get the function declaration, which will be subject to <em>hoisting</em> (we&#8217;ll explain it explained soon). Function expressions are usually a part of a larger expression. For example, if you&#8217;ll add a couple of parentheses at the end of this expression, you&#8217;ll get a <em>self-invoked</em> function. This extra pair of parentheses will cause the function expression located in the first set of parentheses to be executed right away.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">(function calcTax (income, dependents){
   // Do stuff here
})();</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
The topic "Function declaration vs. function expressions" is one of those fuzzy JavaScript areas that can cause unexpected behavior of your code. Angus Croll published <a href="http://javascriptweblog.wordpress.com/2010/07/06/function-declarations-vs-function-expressions/">a well-written article</a> on this subject.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_javascript_objects_gentle_introduction">JavaScript Objects. Gentle Introduction</h3>
<div class="paragraph">
<p>JavaScript objects are simply unordered collections of properties. You can assign new or delete existing properties from the objects during the runtime whenever you please. In classical object oriented languages there are <em>classes</em> and there are <em>objects</em>. However JavaScript doesn&#8217;t have classes.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
The ECMAScript 6 specification will include classes too, but since it&#8217;s a work in progress we won&#8217;t consider them as something useful in the today&#8217;s world. If you&#8217;d like to experiment with the upcoming features of JavaScript, download the <a href="https://tools.google.com/dlpage/chromesxs">Chrome Canary browser</a>, go to <code>chrome:flags</code> and enable experimental JavaScript.  Chrome Canary should be installed on the computer of any HTML5 developers - you can use today those features that will be officially released in Chrome  Developer Tools in about three months.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>In JavaScript you can create objects using one of the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using object literals</p>
</li>
<li>
<p>Using <code>new Object()</code> notation</p>
</li>
<li>
<p>Using <code>Object.create()</code></p>
</li>
<li>
<p>Using <em>constructor functions</em> and a <code>new</code> operator.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Technically, there can be other APIs that implicitly create objects, e.g. JSON.parse(), but let&#8217;s keep things simple.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
In JavaScript everything is an <code>Object</code>. Think of <code>Object</code> as of a root of of the hierarchy of all objects used in your program. All your custom objects are descendants from <code>Object</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_object_literals">Object Literals</h4>
<div class="paragraph">
<p>The easiest way to create a JavaScript object is by using the object literal notation. The code sample below starts with a creation of an empty object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var t == {}             // create an instance of an empty object</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following line of code creates an object with one property <code>salary</code> and assigns the value of 50000 to it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var a == {salary: 50000}; // an instance with one property</code></pre>
</div>
</div>
<div class="paragraph">
<p>Below, the instance of one more object is created and the variable <code>person</code> points at it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">// Store the data about Julia Roberts
var person == { lastName: ”Roberts”,
               firstName: ”Julia”,
                     age: 42
             };</code></pre>
</div>
</div>
<div class="paragraph">
<p>This object has three properties: <code>lastName</code>, <code>firstName</code>, and <code>age</code>. Note that in object literal notation the values of these properties are specify using colon. You can access the properties of this person using the dot notation, e.g. <code>person.LastName</code>. But JavaScript allows yet another way of accessing the object properties by using square bracket syntax, for example <code>person["lastName"]</code>. In the next code sample you&#8217;ll see that using the square brackets is the only way to access the property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript"> var person == {
       "last name": "Roberts",
       firstName: "Julia",
             age: 42};

var herName=person.lastName;          <i class="conum" data-value="1"></i><b>(1)</b>

console.error("Hello " + herName);    <i class="conum" data-value="2"></i><b>(2)</b>

herName=person["last name"];           <i class="conum" data-value="3"></i><b>(3)</b>

person.salutation="Mrs. ";

console.log("Hello "+ person.salutation + person["last name"]); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The object person doesn&#8217;t have a property <code>lastName</code>, but no error is thrown</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This will print "Hello undefined"</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using and alternative way of referring to an object property</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This will print "Hello Mrs. Roberts"</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
It&#8217;s a good idea to keep handy a style guide of any programming language, and we know two of such documents for JavaScript. Google has published their version of JavaScript Style Guide at <a href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml">http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml</a>. A more detailed Airbnb JavaScript Style Guide is available as a github project at <a href="https://github.com/airbnb/javascript">https://github.com/airbnb/javascript</a>. And the github version of the JavaScript style guide is located at <a href="https://github.com/styleguide/javascript">https://github.com/styleguide/javascript</a>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_nesting_object_literals">Nesting Object Literals</h5>
<div class="paragraph">
<p>Objects can contain other objects. If a property of an object literal is also an object, you just need to specify the value of this property in an extra pair of curly braces. For example, you can represent the telephone of a person as an object having two properties: the type and the number. The following code snippet adds a nested object to store a work phone as a <em>nested object</em> inside the person&#8217;s object. Run this code in the Firebug&#8217;s console and it&#8217;ll print "Call Julia at work 212-555-1212".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var p == { lastName: "Roberts",
                firstName: "Julia",
                age: 42,
                phone:{
                      type: "work",
                      numb: "212-555-1212"
                 }
            };
console.log("Call " + p.firstName + " at " + p.phone.type + " " + p.phone.numb );</code></pre>
</div>
</div>
<div class="paragraph">
<p>What if a person has more then one phone? We can change the name of the property <code>phone</code> to <code>phones</code> and instead store an array of objects. JavaScript arrays are surrounded by square brackets, and they are zero based. The following code snippet will print "Call Julia at home 718-211-8987".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var p == { lastName: "Roberts",
                firstName: "Julia",
                age: 42,
                phones:[{
                      type: "work",
                      numb: "212-555-1212"
                 },
                 {
                      type: "home",
                      numb: "799-211-8987"

                 }]
            };
console.log("Call " + p.firstName + " at " + p.phones[1].type + " " + p.phones[1].numb );</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_methods_in_object_literals">Methods in Object Literals</h5>
<div class="paragraph">
<p>Functions defined inside objects are called <em>methods</em>. Defining methods in object literals is similar to defining properties - provide a method name followed by a colon and the function declaration. The code snippet below declares a method <code>makeAppoyntment()</code> to our object literal. Finally, the line <code>p.makeAppointment();</code> invokes this new method, which will print the message on the console that Steven wants to see Julia and will call at so-and-so number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var p == { lastName: "Roberts",
                firstName: "Julia",
                age: 42,
                phones:[{
                      type: "work",
                      numb: "212-555-1212"
                 },
                 {
                      type: "home",
                      numb: "718-211-8987"

                 }],
                makeAppointment: function(){
                    console.log("Steven wants to see  " + this.firstName +
                                 ". He'll call at " + this.phones[0].numb);
                }
            };

p.makeAppointment();</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
Since we already started using arrays, it&#8217;s worth mentioning that arrays can store any objects. You don&#8217;t have to declare the size of the array upfront and can create new arrays as easy as <code>var myArray=[]</code> or <code>var myArray=new Array()</code>. You can even store function declarations as regular strings, but they will be evaluated on the array initialization. For example, during the <code>greetArray</code> initialization the user will see a prompt asking to enter her name, and, when it&#8217;s done, the <code>greetArray</code> will store two strings. The output of the code fragment below can look like  "Hello, Mary".
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var greetArray=[
    "Hello",
    prompt("Enter your name", ”Type your name here")
];

console.log(greetArray.join(","));</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve briefly covered object literals, and you to start using them. In Chapter 2 you&#8217;ll be learning about JSON - a popular data format used as replacement for XML in the JavaScript world. Then you&#8217;ll see how similar are the syntax of JSON and JavaScript object literals. Now we&#8217;ll spend a little bit of time delving into JavaScript functions, and then - back to objects again.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constructor_functions">Constructor Functions</h4>
<div class="paragraph">
<p>JavaScript functions are more then just some named pieces of code that implements certain behavior. They also can become objects themselves by a magic of the <code>new</code> operator. To make things even more intriguing, the function calls can have memories, which will be explained in the section about closures.</p>
</div>
<div class="paragraph">
<p>If a function is meant to be instantiated with the <code>new</code> operator it&#8217;s called a <em>constructor function</em>. If you are familiar with Java or C# you understand the concept of a class constructor that is being executed only once during the instantiation of a class. Now imagine that there is only a constructor without any class declaration that still can be instantiated with the <code>new</code> operator as in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">
function Person(lname, fname, age){
         this.lastName=lname;
         this.firstName=fname;
         this.age=age;
};

// Creating 2 instances of Person
var p1 == new Person(“Roberts”,“Julia”, 42);

var p2 == new Person(“Smith”, “Steven”, 34);
</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code declares the function <code>Person</code> and after that, withe the help of the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new">new operator</a> it creates two instances of the <code>Person</code> object referred by the variables <code>p1</code> and <code>p2</code> accordingly.</p>
</div>
<div class="paragraph">
<p>According to common naming conventions the names of the constructor functions are capitalized.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
The JavaScript language doesn&#8217;t support classes, and a constructor function is the closest concept to the classes of the languages like Java or C#. Chapter 4 is about the Ext JS framework that extends JavaScript and introduces constructs similar to classes and classical inheritance.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_adding_methods_and_properties_to_functions">Adding Methods and Properties to Functions</h5>
<div class="paragraph">
<p>Objects can have methods and properties, right? On the other hand, functions are objects. Hence functions can have methods and properties too. If you declare a function <code>marryMe()</code> inside the constructor function <code>Person</code>, <code>marryMe()</code> becomes a method of <code>Person</code>. This is exactly what we&#8217;ll do next. But this time we&#8217;ll create an HTML file that includes the <code>&lt;script&gt;</code> section referring to the JavaScript code sample located in a separate file.</p>
</div>
<div class="paragraph">
<p>If you want to try it hands-on, create a new file in your Aptana project by selecting the menu File | New | File and give it a name marryme.js. When prompted, accept the suggested default JavaScript template, and key in the following content into this file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">
function Person(lname, fname, age){
         this.lastName=lname;
         this.firstName=fname;
         this.age=age;

         this.marryMe=function(person){
         	console.log("Will you marry me, " + person.firstName);
         };

};

var p1== new Person("Smith", "Steven");
var p2== new Person("Roberts", "Julia");

p1.marryMe(p2);
</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above uses the keyword <code>this</code> that refers to the object where the code will execute. If you are familiar with the meaning of <code>this</code> in Java or C#, it&#8217;s similar, but not exactly the same, and we&#8217;ll illustrate it in the section titled "Who&#8217;s this". The method <code>marryMe()</code> of one <code>Person</code> object takes an instance of another <code>Person</code> object and makes an interesting proposition: "Will you marry me, Julia".</p>
</div>
<div class="paragraph">
<p>This time we won&#8217;t run this code in the Firebug&#8217;s console, but rather will include it in the HTML file.
In Aptana, create a new File | New | File, enter marryme.html as the file name and press the button Finish. Don&#8217;t press the button Next as it&#8217;ll offer you to select from one of the HTML templates, but this would generate lots of HTML content, which is not needed for our code sample. Just type in the following in the newly created empty file marryme.html.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

	&lt;body&gt;
		&lt;h1&gt;Making Proposal&lt;/h1&gt;

		&lt;script src="marryme.js"&gt;&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debugging_javascript_in_firebug">Debugging JavaScript in Firebug</h3>
<div class="paragraph">
<p>In Aptana, right-click on the file marryme.html and select the option Run As | JavaScript Web Application. We continue using Firefox as Aptana&#8217;s default browser, and you&#8217;ll see it open a new Web page that reads "Making Proposals". Open the Firebug using the View menu of Firefox, refresh the page and switch to the Firebug&#8217;s tab Script. You&#8217;ll see the split panel with the JavaScript code from marryme.js on the left.</p>
</div>
<div id="FIG2-8" class="imageblock">
<div class="content">
<img src="images/fig_02_08.jpg" alt="fig 02 08">
</div>
<div class="title">Figure 8. Firebug&#8217;s Script panel</div>
</div>
<div class="paragraph">
<p>Let&#8217;s set a breakpoint inside the method <code>marryMe()</code> by clicking in the Firebug&#8217;s gray area to the left of the line 7. You&#8217;ll see a red circle that will reveal a yellow triangle as soon as your code execution will hit this line. Refresh the content of the browser to re-run the script with a breakpoint. Now the execution stopped at line 7, the right panel contains the runtime information about the objects and variables used by your program.</p>
</div>
<div id="FIG2-9" class="imageblock">
<div class="content">
<img src="images/fig_02_09.jpg" alt="fig 02 09">
</div>
<div class="title">Figure 9. Firebug&#8217;s Script panel at a breakpoint</div>
</div>
<div class="paragraph">
<p>On the top of the left panel you&#8217;ll see standard  debugger buttons with curved arrows (Step Into, Step Over, Step Out) as well as triangular button to continue code execution. The right panel depicts the information related to <code>this</code> and global <code>Window</code> objects. In <a href="#FIG2-9">Firebug&#8217;s Script panel at a breakpoint</a> <code>this</code> represents the instance of the <code>Person</code> object represented by the variable <code>p1</code> (Steven Smith). To see the content of the object, received by the method <code>marryMe()</code> you can add the watch variable by clicking on the text "New watch expression&#8230;" and entering <code>person</code> - the name of the parameter of <code>marryMe()</code>. <a href="#FIG2-10">Firebug&#8217;s Script panel at a breakpoint</a> shows the watch variable <code>person</code> (Julia Roberts) that was used during the invocation of the method <code>marryMe()</code>.</p>
</div>
<div id="FIG2-10" class="imageblock">
<div class="content">
<img src="images/fig_02_10.jpg" alt="fig 02 10">
</div>
<div class="title">Figure 10. Firebug&#8217;s Script panel at a breakpoint</div>
</div>
<div class="paragraph">
<p>Now click on the Firebug&#8217;s Net panel, which shows what goes over the network during communication between the Web browser and Web server. Figure 2-11 shows a screen shot of the Net panel where we clicked on the Headers tab for marryme.html and the Response tab of marryme.js. The code 200 for both files means that they arrived successfully to the browser. It also shows the IP address of the Web server they came from, their sizes, and plenty of other useful information.  Both Script and Net panels of Firebug or any other developers tools are your best friends of any Web developer.</p>
</div>
<div id="FIG2-11" class="imageblock">
<div class="content">
<img src="images/fig_02_11.jpg" alt="fig 02 11">
</div>
<div class="title">Figure 11. Firebug&#8217;s Net panel</div>
</div>
<div class="paragraph">
<p>We like Firebug, but testing and debugging should be done in several Web browsers. Besides Firebug,  we&#8217;ll be using excellent Google Chrome developers tools. Their menus and panels are similar and we won&#8217;t be including such mini-tutorials on using such tools - you can easily learn them on your own.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You can find a tutorial on using Google Chrome Developer Tools at <a href="https://developers.google.com/chrome-developer-tools/">https://developers.google.com/chrome-developer-tools/</a>. The cheatsheet of Chrome developer Tools is located at <a href="http://anti-code.com/devtools-cheatsheet/">http://anti-code.com/devtools-cheatsheet/</a>. Finally, Google offers an online video course titled <a href="http://discover-devtools.codeschool.com/">"Explore and Master Chrome DevTools"</a>.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Notes on Arrays</div>
<div class="paragraph">
<p>A JavaScript array is a grab bag of any objects. You don&#8217;t have to specify in advance the number of elements to store, and there is more than one way to create and initialize array instances. The following code samples are self-explanatory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">
var myArray=[];
    myArray[0]="Mary";
    myArray[2]="John";

// prints undefined John
console.log(myArray[1] + " " + myArray[2]);

var states1 == ["NJ", "NY", "CT", "FL"];

var states == new Array(4);  // size is optional

states[0]="NJ";

states[1]="NY";

states[2]="CT";

states[3]="FL";

// remove one array element
delete states[1];


// prints undefined CT length=4
console.log(states[1] + " " + states[2] + " Array length=" + states.length);

// remove one element starting from index 2
states.splice(2,1);

// prints undefined  FL length=3
console.log(states[1] + " " + states[2] + " Array length=" + states.length);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Removing elements with <code>delete</code> creates gaps in the arrays while using the array&#8217;s method <code>splice()</code> allows to remove or replace the specified range of elements closing gaps.</p>
</div>
<div class="paragraph">
<p>The next code sample illustrates an interesting use case when we assign a string and a function text as array elements to <code>mixedArray</code>.  During array initialization the function <code>promt()</code> will be invoked, the user will be prompted to enter name, and after that, two strings will be store in <code>mixedArray</code>, for example "Hello" and "Mary".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">
var mixedArray=[
    "Hello",
    prompt("Enter your name", ”Type your name here")
];
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_prototypal_inheritance">Prototypal Inheritance</h3>
<div class="paragraph">
<p>JavaScript doesn&#8217;t support classes, at least till the ECMAScript 6 will become a reality. But JavaScript allows you to create objects that inherit properties and methods of other objects. By default, all JavaScript objects are inherited from <code>Object</code>. Each JavaScript construction function has a special property called <code>prototype</code>, which points at this object&#8217;s ancestor. If you want to create an inheritance chain where an instances of constructor function <code>ObjectB</code> <em>extends</em> <code>ObjectA</code> (as in classical object-oriented languages) just write one line of code: <code>ObjectB.prototype=ObjectA;</code>.</p>
</div>
<div id="FIG2-12" class="imageblock">
<div class="content">
<img src="images/fig_02_12.jpg" alt="fig 02 12">
</div>
<div class="title">Figure 12. Prototypal Inheritance</div>
</div>
<div class="paragraph">
<p>Consider two constructor functions <code>Employee</code> and <code>Person</code> shown in the code snippet below.They represent two unrelated objects. But assigning the <code>Person</code> object to the <code>prototype</code> property of <code>Employee</code> creates an inheritance chain, and now the object <code>emp</code> will have all properties defined in both <code>Employee</code> and <code>Person</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">
function Person(name, title){
	this.name=name;
	this.title=title;
	this.subordinates=[];
}

function Employee(name, title){
	this.name=name;
	this.title=title;
}

// All instances of Employee will extend Person
Employee.prototype == new Person();            <i class="conum" data-value="1"></i><b>(1)</b>

var emp == new Employee("Mary", "Specialist"); <i class="conum" data-value="2"></i><b>(2)</b>

console.log(emp);      <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Assigning an ancestor of type person</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Instantiating Employee</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Printing the object referred by <code>emp</code> will output [object Object]. It happens because each object has a method <code>toString()</code>, and if you want it to output useful information - override it. You&#8217;ll see how to do it later in this section.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We want to stress, that the property <code>prototype</code> exists on constructor functions. After creating specific instances of such objects you may see that these instances have another property called <code>proto</code>. At the time of this writing this property is not a standard yet and won&#8217;t be supported in some older browsers, bit ECMAScript 6 will make it official. To illustrate the difference between <code>prototype</code> and <code>proto</code> let&#8217;s add the following piece of code to the above sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">
//Create an instance of Person and add property dependents
var p=new Person();
p.dependents=1;                                 <i class="conum" data-value="1"></i><b>(1)</b>


var emp2=new Employee("Joe", "Father");

//This employee will have property dependents

emp2.__proto__=p;                               <i class="conum" data-value="2"></i><b>(2)</b>

console.log("The number of Employee's dependents " + emp2.dependents); <i class="conum" data-value="3"></i><b>(3)</b>
</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Creating an instance of <code>Person</code> and adding an extra property dependents just for this instance</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Assigning this instance to the <code>__proto__</code> property of one instance</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The code will properly print 1 as a number of dependents of the <code>Employee</code> instance represented by the variable <code>emp2</code>.  The variable <code>emp</code> from the previous code snippet won&#8217;t have the property <code>dependents</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To try it hands-on, open the file WhoIsYourDaddy.html (it&#8217;s included in book code samples) in Aptana. Just for a change, this time we&#8217;ll use Google Chrome Developer Tools by opening the menu View | Developer | Developer Tools. Set the breakpoint at the last line of the JavaScript, refresh the Web page content, and add the watch expressions for the variables <code>p</code>, <code>emp</code>, and <code>emp2</code>. When the JavaScript code engine runs into <code>emp2.dependents</code> it tries to find this property in property on the <code>Employee</code> object. If not found, the engine checks all the objects in the prototypal chain (in our case it&#8217;ll find it in the object <code>p</code>) all the way up to the <code>Object</code> if need be.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
If you need to do some programmatic manipulations with only those properties that are defined on the specific object (not in its ancestors in the prototyal chain) do the check with the method <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty"><code>hasOwnProperty()</code></a>.
</td>
</tr>
</table>
</div>
<div id="FIG2-13" class="imageblock">
<div class="content">
<img src="images/fig_02_13.jpg" alt="fig 02 13">
</div>
<div class="title">Figure 13. The instance-specific <code>__proto__</code> variable</div>
</div>
<div class="paragraph">
<p>Please note the difference in the content of the variables <code>__proto__</code> of the instances represented by <code>emp</code> and <code>emp2</code>. These two employees are inherited from two <em>different</em> objects <code>Person</code>. Isn&#8217;t it scary? Not really.</p>
</div>
<div class="sect3">
<h4 id="_avoiding_declaration_redundancy">Avoiding Declaration Redundancy</h4>
<div class="paragraph">
<p>Prototypical inheritance allows you to inherit one object from another, but it can lead to issues of redundancy and code duplication. If you take a closer look at the screenshot from <a href="#FIG2-13">The instance-specific <code>__proto__</code> variable</a> you&#8217;ll see that the <code>Person</code> and <code>Employee</code> objects have redundant properties <code>name</code> and <code>title</code>. We&#8217;ll deal with this redundancy in the section titled "Call and Apply". But first let&#8217;s introduce and cure the redundancy in method declarations when the prototypal inheritance is used.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s add a method to <code>addSubordinate()</code> to the ancestor object <code>Person</code> that will populate its array <code>subordinates</code>. Who knows, maybe an object <code>Contractor</code> (descendant of a <code>Person</code>) will need to be added in the future, so the ancestor&#8217;s method <code>addSubordinate()</code> can be reused. First, we&#8217;ll do it  the wrong way to illustrate the redundancy problem, and then we&#8217;ll do it right. Consider the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">// Constructor function Person
function Person(name, title){
	this.name=name;
	this.title=title;
	this.subordinates=[];

    // Declaring method inside the constructor function
	this.addSubordinate=function (person){
		this.subordinates.push(person)
	}


}

// Constructor function Employee
function Employee(name, title){
	this.name=name;
	this.title=title;
}

// Changing the inheritance of Employee
Employee.prototype == new Person();

var mgr ==  new Person("Alex", "Director");
var emp1 == new Employee("Mary", "Specialist");
var emp2 == new Employee("Joe", "VP");

mgr.addSubordinate(emp1);
mgr.addSubordinate(emp2);
console.log("mgr.subordinates.length is " + mgr.subordinates.length);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method <code>addSubordinate()</code> here is declared inside the constructor function <code>Person</code>, which becomes an ancestor of the <code>Employee</code>. After instantiation of two <code>Employee</code> objects the method <code>addSubordinate()</code> is duplicated for each instance.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s use Google Chrome Developer Tools profiler to see the sizes of the objects allocated on the Heap memory. But first we&#8217;ll set up two breakpoints - one before, and one after creating our instances as shown on <a href="#FIG2-14">Preparing Breakpoints Take 1.</a>.</p>
</div>
<div id="FIG2-14" class="imageblock">
<div class="content">
<img src="images/fig_02_14.jpg" alt="fig 02 14">
</div>
<div class="title">Figure 14. Preparing Breakpoints Take 1.</div>
</div>
<div class="paragraph">
<p>When the execution of the code will stop at the first breakpoint, we&#8217;ll switch to the Profiler tab and take the first Heap snapshot.  Upon reaching the second breakpoint we&#8217;ll take another Heap snapshot. The dropdown at the status bar allows to view the objects allocated between the snapshots 1 and 2. <a href="#FIG2-15">Objects allocated between snapshots 1 and 2</a> depicts this view of the profiler. Note that the total size (the Shallow Size column) for the <code>Person</code> instances is 132 bytes. <code>Employee</code> instances weigh 104 bytes.</p>
</div>
<div id="FIG2-15" class="imageblock">
<div class="content">
<img src="images/fig_02_15.jpg" alt="fig 02 15">
</div>
<div class="title">Figure 15. Objects allocated between snapshots 1 and 2</div>
</div>
<div class="paragraph">
<p>Now we&#8217;ll change the code to declare the method not inside the <code>Person</code> constructor function, but on it&#8217;s prototype - and this is the right way to declare methods in functions to avoid code duplication.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">// Constructor function Person
function Person(name, title){
	this.name=name;
	this.title=title;
	this.subordinates=[];

}

//Declaring method on the object prototype
Person.prototype.addSubordinate=function(subordinate){
   this.subordinates.push(subordinate);
   return subordinate;
}

// Constructor function Employee
function Employee(name, title){
	this.name=name;
	this.title=title;
}

// Changing the inheritance of Employee
Employee.prototype == new Person();

var mgr ==  new Person("Alex", "Director");
var emp1 == new Employee("Mary", "Specialist");
var emp2 == new Employee("Joe", "VP");

mgr.addSubordinate(emp1);
mgr.addSubordinate(emp2);
console.log("mgr.subordinates.length is " + mgr.subordinates.length);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, we&#8217;ll set up two breakpoints before and after object instantiation as shown in &lt;&lt;&gt;FIG2-16&gt;.</p>
</div>
<div id="FIG2-16" class="imageblock">
<div class="content">
<img src="images/fig_02_16.jpg" alt="fig 02 16">
</div>
<div class="title">Figure 16. Preparing Breakpoints Take 2.</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take two more profiler snapshots upon reaching each of the breakpoint. While the weight of the <code>Employee</code> instances remained the same (104 bytes), the <code>Person</code> instances became lighter: 112 bytes. While 20 bytes may not seem like a big deal, if you&#8217;ll need to create hundreds or thousands of object instances it adds up.</p>
</div>
<div id="FIG2-17" class="imageblock">
<div class="content">
<img src="images/fig_02_17.jpg" alt="fig 02 17">
</div>
<div class="title">Figure 17. Objects allocated between snapshots 3 and 4</div>
</div>
<div class="paragraph">
<p>So if you need to declare a method on the object that will play a role of the ancestor, do it on the prototype level. The only exception to this rule is the case when such method needs to use some object specific variable that&#8217;s different for each instance - in case declare methods inside the constructors (see the section on closures for details).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
All modern Web browsers support the function <code>Object.create()</code>, which creates a new object based on another prototype object creates a new object and sets that new object&#8217;s prototype to be the object passed in. For example, <code>var objectB=Object.create(objectA);</code>.  What if you must support an older browser and need such "create by example" functionality? Of course, you can always create a custom arbitrarily named function with the similar functionality as the latest implementation of <code>Object.create()</code>. But the future-proof approach is to create the missing methods with the same signatures and on the same objects as the latest ECMAScript specification prescribes. In case of <code>Object.create()</code> you can use the implementation <a href="http://javascript.crockford.com/prototypal.html">offered by Douglas Crockford</a>:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">if (typeof Object.create !=== 'function') {
    Object.create == function (o) {
        function F() {}
        F.prototype == o;
        return new F();
    };
}
newObject == Object.create(oldObject);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Such approach of custom implementation of missing pieces according to the latest ECMAScript specifications or W3C drafts is known as <em>polyfills</em>. People who can&#8217;t wait till the browser vendors will implement the newest functionality create cross-browser polyfills and some of them submit their source code to the public domain. You can find a number of polyfills in the git repository of the <a href="https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills">Modernizr project</a>. The Web site <a href="http://caniuse.com">http://caniuse.com/</a> contains the current information about browser&#8217;s support of the latest HTML5, JavaScript, and CSS features.</p>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
In the Ext JS chapter you&#8217;ll see how this frameworks offers its own class system that supports inheritance.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_method_overriding">Method overriding</h4>
<div class="paragraph">
<p>Method overriding allows a subclass to replace (<em>override</em>) the functionality of a method defined in a superclass. Since JavaScript allows declaring methods on an object as well as on its prototype, overriding a method becomes really simple. The following code sample declares the method <code>addSubordinate()</code> on the prototype of the <code>Person</code> object, but then the object <code>p1</code> overrides this method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">function Person(name, title){

  this.name=name;
  this.title=title;
  this.subordinates=[];
}

Person.prototype.addSubordinate=function(person){

   this.subordinates.push(person);
   console.log("I'm in addSubordinate on prototype " + this);
}

var p1=new Person("Joe", "President");

    p1.addSubordinate=function(person){

    this.subordinates.push(person);
    console.log("I'm in addSubordinate in object " + this);
  }

var p2 == new Person("Mary", "Manager")

    p1.addSubordinate(p2);
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the above code prints only one line: "I&#8217;m in addSubordinate in object [object Object]". This proves that the method <code>addSubordinate()</code> on the prototype level is overridden. We can also improve this example a little bit and override the method <code>toString()</code> on the <code>Person</code>. Just add the following fragment to the prior to instantiating <code>p1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">Person.prototype.toString=function(){
   return "name:" + this.name +" title:" + this.title;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the code prints "I&#8217;m in addSubordinate in object name:Joe, title:President". Overriding the method <code>toString()</code> on objects is a common practice as it gives a textual representation of your objects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scope_or_who_s_this">Scope or who&#8217;s this?</h3>
<div class="paragraph">
<p>You are about to read one of the most confusing sections in this book. The confusion is caused by some inconsistencies in JavaScript design and implementations by various browsers. Do you know what will happen if you&#8217;ll remove the keywords <code>this</code> from the <code>toString()</code> method  from previous section? You&#8217;ll get an error - the variable <code>title</code> is not defined. Without the keyword <code>this</code> the JavaScript engine tries to find the variable <code>title</code> in the global namespace. Declaring and initializing the variable <code>title</code> outside of the <code>Person</code> declaration get rid of this error, but this is not what we want to do. Misunderstanding of the current scope can lead to difficult to debug errors.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="icon-caution" title="Caution"></i>
</td>
<td class="content">
Interestingly enough replacing <code>this.name</code> with <code>name</code> doesn&#8217;t generate an error, but rather initializes the variable <code>name</code> with an empty string. Although <code>name</code> is not an officially reserved JavaScript keyword, there are articles in the blogosphere that don&#8217;t recommend using the word <code>name</code> as a variable name. Keep <a href="http://www.javascripter.net/faq/reserved.htm">this list of reserved words</a> handy to avoid running into an unpredictable behavior.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s consider several examples that will illustrate the meaning of <code>this</code> variable in JavaScript. The code sample below defines an object <code>myTaxObject</code> and calls its method <code>doTaxes()</code>. Notice two variables with the same name <code>taxDeduction</code> - one of them has global scope and another belongs to <code>myTaxObject</code>. This little program was written for mafia and will apply some under the table deduction for the people who belong to Cosa Nostra.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var taxDeduction=300;      // global variable

var myTaxObject == {

    taxDeduction: 400,    // object property

    doTaxes: function() {
         this.taxDeduction +== 100;

         var mafiaSpecial== function(){
           console.log( "Will deduct " + this.taxDeduction);
         }

         mafiaSpecial();  // invoking as a function
    }
}

myTaxObject.doTaxes();  //invoking method doTaxes
</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code fragment illustrates the use of <em>nested functions</em>. The object method <code>doTaxes()</code> has a nested function <code>mafiaSpecial()</code>, which is not visible from outside of the <code>myTaxObject</code>, but it can be certainly invoked inside <code>doTaxes()</code>. What number do you think this code will print after the words "Will deduct "? Will it print three, four, or five hundred? Run this code in Firebug, Chrome Developer Tools or any other way and you&#8217;ll see that it&#8217;ll print 300!</p>
</div>
<div class="paragraph">
<p>But this doesn&#8217;t sound right, does it? The problem is that in JavaScript the context where the function executes depends on the way it was invoked. In this case the function <code>mafiaSpecial()</code> was invoked as a function (not a method) without specifying the object it should apply to, and JavaScript makes it operate in the global object, hence the global variable <code>taxDeduction</code> having the value of 300 is being used. So in expression <code>this.taxDeduction</code>  the variable <code>this</code> means global unless the code is operated in the strict mode.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
ECMAScript 5 introduced a restricted version of JavaScript called <em>strict mode</em>, which among other things places stricter requirements to variable declarations and scope identification. Adding "use strict" as the first statement of the method <code>doTax()</code> will make the context <em>undefined</em>, and it&#8217;ll print the error "this is undefined" and not 300. You can read about the strict mode at <a href="http://mzl.la/N4z1QI">Mozilla&#8217;s developers site</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s make a slight change to this example and take to control what <code>this</code> represents. When the object <code>myTaxObject</code> was instantiated its own <code>this</code> reference was created. The following code fragment stores this reference in  additional variable <code>thisOfMyTaxObject</code> changes the game and the expression <code>thisOfMyTaxObject.taxDeduction</code> evaluates to 500.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var taxDeduction=300;      // global variable

var myTaxObject == {

    taxDeduction: 400,    // object property

    doTaxes: function() {
    var thisOfMyTaxObject=this;
         this.taxDeduction +== 100;

         var mafiaSpecial== function(){
           console.log( "Will deduct " + thisOfMyTaxObject.taxDeduction);
         }

         mafiaSpecial();  // invoking as a function
    }
}

myTaxObject.doTaxes();  //invoking method doTaxes</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll see a different way of running a function in the context of the specified object using special functions <code>call()</code> and <code>apply()</code>. But for now consider one more attempt to invoke <code>mafiaSpecial()`shown in the following example that uses `this.mafiaSpecial()</code> notation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var taxDeduction=300;      // global variable

var myTaxObject == {

    taxDeduction: 400,    // object property

    doTaxes: function() {
         this.taxDeduction +== 100;

         var mafiaSpecial== function(){
           console.log( "Will deduct " + this.taxDeduction);
         }

         this.mafiaSpecial();  // trying to apply object's scope
    }
}

myTaxObject.doTaxes();  //invoking method doTaxes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the above code and it&#8217;ll give you the error "TypeError: this.mafiaSpecial is not a function" and rightly so. Take a closer look at the object <code>myTaxObject</code> represented by the variable <code>this</code>. The <code>myTaxObject</code> has only two properties: <code>taxDeduction</code> and <code>doTaxes</code>. The function <code>mafiaSpecial</code> is hidden inside the method <code>doTaxes</code> and can&#8217;t be accessed via <code>this</code>.</p>
</div>
<div class="paragraph">
<p>After learning how to hide a a function inside an object, let&#8217;s see how to do something quite opposite -  allowing an external method to run inside the context of an object.</p>
</div>
<div class="sect3">
<h4 id="_call_and_apply">Call and Apply</h4>
<div class="paragraph">
<p>Visualize the International Space Station, and add to the picture an image of a approaching space shuttle. After attaching to the docking bay of the station the shuttle&#8217;s crew performs some functions on the station (a.k.a. object) and then flies to another object or back to Earth. What it has to do with JavaScript? It can serve as an analogy for creating a JavaScript function that can operate in the scope of any arbitrary object. For this purpose JavaScript offers two special functions: <code>call()</code> or <code>apply()</code>. Both <code>call()</code> and <code>apply()</code> can invoke any function on any object. The only difference between them is that <code>apply()</code> passes  parameters to a function as an array, while <code>call()</code> uses a comma-separated list.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Every function in JavaScript is an instance of the <code>Function</code> object. Both <code>call()</code> and <code>apply()</code> are defined in <code>Function</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, a function <code>calcStudentDeduction(income,numOfStudents)</code> can be invoked in a context of a given object using either call() or apply(). Note that with <code>call()</code> parameters have to be listed explicitly, while with <code>apply</code> parameters are given as an array:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">calcStudentDeduction.call(myTaxObject, 50000, 2);

calcStudentDeduction.apply(myTaxObject, [50000, 2]);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example the instance of <code>myTaxObject</code> can be referred as <code>this</code> from within the function <code>calcStudentDeduction()</code> even though this is a function and not a method. The last example from the previous section can be re-written to invoke <code>mafiaSpecial()</code>. The following code will ensure that <code>mafiaSpecial()</code> has <code>this</code> pointing to &#8216;myTaxObject&#8217; and will print on the console "Will deduct 500".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var taxDeduction=300;      // global variable

var myTaxObject == {

    taxDeduction: 400,

    doTaxes: function() {
         this.taxDeduction +== 100;

         var mafiaSpecial== function(){
           console.log( "Will deduct " + this.taxDeduction);
         }

         mafiaSpecial.call(this);  // passing context to a function
    }
}

myTaxObject.doTaxes();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_callbacks">Callbacks</h4>
<div class="paragraph">
<p>Can you live without using <code>call()</code> and <code>apply()</code>?  Sure you can, but JavaScript allows you to easily create callbacks. The callback mechanism lets you pass the code of one function as a parameter to another function for execution in the latter function&#8217;s context. This is a very useful feature of the language. Imagine an object with a method <code>processData()</code>. Depending on the business logic you can pass to this method (as an argument) different functions that will do actual data processing - these are callbacks.</p>
</div>
<div class="paragraph">
<p>Another example of callbacks is event handlers. If a user clicks on this button here&#8217;s the name of the handler function to call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="Javascript language-Javascript">`myButton.addEventListener("click", myFunctionHandler);`</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s important to understand that <em>you don&#8217;t not immediately call</em> the function <code>myFunctionHandler</code> here - you are just registering it as the function argumrnt. If the user will click on <code>myButton</code> then the code of the callback <code>myFunctionHandler</code> will be given to the object <code>myButton</code> and will be  invoked in the context of the <code>myButton</code> object. The functions <code>call()</code> and <code>apply()</code> exist exactly for this purpose.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider an example when you need to write a function that will take two arguments: an array containing preliminary tax data and a callback function, which will be applied to each element of this array. The following code sample creates <code>myTaxObject</code> that has two properties: <code>taxDeduction</code> and the <code>applyDeduction</code>. The latter is a method with two parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var myTaxObject == {

    taxDeduction: 400, // state-specific  deduction

    // this function takes an array and callback as parameters
    applyDeduction: function(someArray, someCallBackFunction){

        for (var i == 0; i &lt; someArray.length; i++){

            // Invoke the callback
           someCallBackFunction.call(this, someArray[i]);
        }

    }
}

// array
var preliminaryTaxes=[1000, 2000, 3000];

// tax handler function
var taxHandler=function(currentTax){
                   console.log("Hello from callback. Your final tax is " +
                   (currentTax - this.taxDeduction));
                }

// invoking applyDeduction passing an array and callback
myTaxObject.applyDeduction(preliminaryTaxes, taxHandler);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above code invokes <code>applyDeduction()</code> passing it the array <code>preliminaryTaxes</code> and the callback function <code>taxHandler</code> that takes the <code>currentTax</code> and subtracts <code>this.taxDeduction</code>. By the time this callback will be applied to each element of the array the value of <code>this</code> will be known and this code will print the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">Hello from callback. Your final tax is 600
Hello from callback. Your final tax is 1600
Hello from callback. Your final tax is 2600</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may be wondering, why passing the function to another object if we could take an array, subtract 400 from each of its elements and be done with it? The solution with callbacks gives you an ability to make the decision on what function to call during the runtime and call it only when a certain event happens. Callbacks allow you to do <em>asynchronous processing</em>. For example, you make an asynchronous  request to a server and register the callback to be invoked if a result comes back. The code is not blocked and doesn&#8217;t wait until the server response is ready. Here&#8217;s an example from AJAX: <code>request.onreadystatechange=myHandler</code>. You register <code>myHandler</code> callback but not immediately call it. JavaScript functions are objects, so get used to the fact that you can pass them around as you&#8217;d be passing any objects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hoisting">Hoisting</h4>
<div class="paragraph">
<p>A variable scope depends on where it was declared.  You already had a chance to see that a variable declared inside a function with the keyword <code>var</code> is visible only inside this function and any function declared within it. Some programming languages allow to narrow down the scope even further. For example, in Java declaring a variable inside any block of code surrounded with curly braces makes it visible only inside such a block. In JavaScript it works differently. No matter where in the function you declared the variable its declaration will be <em>hoisted</em> to the top of the function, and you can use this variable anywhere inside the function.</p>
</div>
<div class="sect4">
<h5 id="_hoisting_variables">Hoisting Variables</h5>
<div class="paragraph">
<p>The following code snippet will print 5 even though the variable b has been declared inside the if-statement. It&#8217;s declaration has been hoisted to the top:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">function test () {
    var a=1;

    if(a&gt;0) {
        var b == 5;
    }
    console.log(b);

}

test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s make a slight change to the above code to separate the variable declaration and initialization. The following code has to <code>console.log(b)</code> statements. The first one will output <code>undefined</code> and the second will print 5 just as in the previous example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">function test () {
    var a=1;

    console.log(b);  // b is visible, but not initialized

    if(a&gt;0) {
        var b;
    }

    b=5;

    console.log(b);  // b is visible and initialized
}

test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Due to hoisting, JavaScript doesn&#8217;t complain when the first <code>console.log(b)</code> is invoked. It knows about the variable <code>b</code>, but its value is <code>undefined</code> just yet. By the time the second <code>console.log(b)</code> is called, the variable b was initialized with the value of 5. Just remember that hoisting just applies to variable declaration and doesn&#8217;t interferes with your code when it comes to initialization.</p>
</div>
</div>
<div class="sect4">
<h5 id="_hoisting_functions">Hoisting Functions</h5>
<div class="paragraph">
<p>JavaScript function declarations are hoisted too, and this is illustrated in the following code sample.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">function test () {
    var a=1;

    if(a&gt;0) {
        var b;
    }

    b=5;

    printB();

    function printB(){
        console.log(b);
    }
}

test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code will print 5. We can call the function printB() here because its declaration was hoisted to the top. But the situation changes if instead of function declaration we&#8217;ll use the function expression. The following code will give you an error "PrintB is not a function".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">function test () {
    var a=1;

    if(a&gt;0) {
        var b;
    }

    b=5;

    printB();

    var printB == function(){
        console.log(b);
    }

}

test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that it the error doesn&#8217;t complain about <code>printB</code> being undefined cause the variable declaration was hoisted, but since the function expression wasn&#8217;t the JavaScript engine doesn&#8217;t know yet that <code>printB</code> will become a function really soon. Anyway, moving the invocation line <code>printB()</code> to the bottom of the function <code>test()</code> cures this issue.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Function expressions are not being hoisted, but the variables they are assigned to (if any) are being hoisted.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_function_properties">Function properties</h4>
<div class="paragraph">
<p>Functions as any other objects can have properties. You can attach any properties to a <code>Function</code> object and their values can be used by all instances of this object. Static variables in programming languages with the classical inheritance is the closest analogy to function properties in JavaScript.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider an example of a constructor function <code>Tax</code>. An accounting program can create multiple instances if <code>Tax</code> - one per person. Say this program will be used in a Florida neighborhood with predominantly Spanish speaking people. The following code illustrates the case when the method <code>doTax()</code> can be called with or without parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">function Tax(income, dependents){
    this.income=income;              // instance variable
    this.dependents=dependents;      // instance variable

    this.doTax == function calcTax(state, language){
           if(!(state &amp;&amp; language)){     <i class="conum" data-value="1"></i><b>(1)</b>
              console.log("Income: " + this.income + " Dependents: "+ this.dependents
              + " State: " + Tax.defaults.state + " language:" + Tax.defaults.language);
           } else{                       <i class="conum" data-value="2"></i><b>(2)</b>
              console.log("Income: " + this.income + " Dependents: "+ this.dependents
              + " State: " + state + " language:" + language);
           }
    }
}

Tax.defaults={                           <i class="conum" data-value="3"></i><b>(3)</b>
     state:"FL",
     language:"Spanish"
};

// Creating 2 Tax objects
var t1 == new Tax(50000, 3);
    t1.doTax();                          <i class="conum" data-value="4"></i><b>(4)</b>
var t2 == new Tax(68000, 1);
    t2.doTax("NY","English");            <i class="conum" data-value="5"></i><b>(5)</b>
</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>No state and language were given to the method <code>doTax()</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The state and language were provided as <code>doTax()</code> parameters</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Assigning the object with two properties as a <code>defaults</code> property on <code>Tax</code>. The property <code>default</code> is not instance specific, which makes it static.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Invoking <code>doTax()</code> without parameters - use <code>defaults</code></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Invoking <code>doTax()</code> with parameters</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This program will produce the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">Income: 50000 Dependents: 3 State: FL language:Spanish
Income: 68000 Dependents: 1 State: NY language:English</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add as many properties to the constructor function as needed. For example, to count the number of instances of the <code>Tax</code> object just add one more property <code>Tax.counter=0;</code>. Now add to the <code>Tax</code> function something like <code>console.log(Tax.counter++);</code> and you&#8217;ll see that the counter increments on each instance creation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
If multiple instances of a function object need to access certain HTML elements of the DOM,  add references to these elements as function properties so objects can reuse them instead of traversing the DOM (it&#8217;s slow) from each instance.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_closures">Closures</h3>
<div class="sect3">
<h4 id="_a_formal_definition_attempt">A Formal Definition Attempt</h4>
<div class="paragraph">
<p>A <em>closure</em> is one of those terms that are easier explained by examples. Closures have formal definitions, which are not very helpful for the first timers. Here&#8217;s the <a href="http://en.wikipedia.org/wiki/Closure_(computer_science)">definiton of a closure from Wikipedia</a>:</p>
</div>
<div class="paragraph">
<p><em>"In programming languages, a closure (also lexical closure or function closure) is a function or reference to a function together with a referencing environment—a table storing a reference to each of the non-local variables (also called free variables or upvalues) of that function. A closure—unlike a plain function pointer—allows a function to access those non-local variables even when invoked outside its immediate lexical scope."</em></p>
</div>
<div class="paragraph">
<p>It&#8217;s not a very helpful definition, is it? Let&#8217;s try to give a better one. Imagine a function that contains a private variable, and a nested function. Is it possible to invoke the nested function from the outside of the outer one? And if it&#8217;s possible, what this inner function knows about its surroundings?</p>
</div>
<div class="paragraph">
<p>Larry Ullman, gives the following definition in his book "Modern Java Script": "Closure is a function call with memory". We can offer you our version of what a closure is: "Closure is a function call with strings attached".</p>
</div>
</div>
<div class="sect3">
<h4 id="_why_do_we_need_closures">Why do we Need Closures?</h4>
<div class="paragraph">
<p>In classical object-oriented languages you create an object with a certain state and behavior and can pass if to a method of another object for further processing. In JavaScript you can pass even a function to some object&#8217;s method for further processing. But what if a function also need to remember the state (the values of external variables) of the context where the function was defined?</p>
</div>
<div class="paragraph">
<p>Think of a closure as a function that remembers  state - it&#8217;s just a special type of object that can be passed between objects and use certain variables that didn&#8217;t seem to be defined in the function&#8217;s code. But there existed in the context where the  the function was defined.</p>
</div>
<div class="paragraph">
<p>===Closures by Example</p>
</div>
<div class="paragraph">
<p>Now it&#8217;s time for the explanation of these mysterious definitions, and we&#8217;ll do it by example. Consider the following code that is yet another example of implementing tax collection functionality.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">(function (){                // this is an anonymous function expression

    var taxDeduction == 500;  // private context to remember

      //exposed closure
      this.doTaxes=function(income, customerName) {

      	var yourTax;

        if (customerName !== "Tony Soprano"){
          yourTax ==   income*0.05 - taxDeduction;
        } else{
          yourTax ==   mafiaSpecial(income);
        }

         console.log( "   Dear " + customerName + ", your tax is "+ yourTax);
         return yourTax;
      }

      //private function
      function mafiaSpecial(income){
          return income*0.05 - taxDeduction*2;
      }

})();    // Self-invoked function

// The closure remembers its context with taxDeduction=500
doTaxes(100000, "John Smith");
doTaxes(100000, "Tony Soprano");

mafiaSpecial();        // throws an error - this function is private</code></pre>
</div>
</div>
<div class="paragraph">
<p>First, a self-invoking function will create an anonymous instance of an object in the global scope. It contains a private variable <code>taxDeduction</code>, a public method <code>doTaxes()</code>, and a private method <code>mafiaSpecial()</code>. Just by the virtue of declaring <code>doTaxes</code> on <code>this</code> object, this method becomes exposed to the current scope, which is global in this example.</p>
</div>
<div class="paragraph">
<p>After that we call the method <code>doTaxes()</code> twice. Note that the function <code>doTaxes()</code> uses the variable <code>taxDeduction</code> that was never declared there. But when <code>doTaxes</code> was initially declared, the variable <code>taxDeduction</code> with a value of 500 was already there. So the internal function "remembers" the context (the neighborhood) where it was declared and can use it for its calculations.</p>
</div>
<div class="paragraph">
<p>The algorithm of tax calculations makes <code>doTaxes()</code> calls the function <code>mafiaSpecial()</code> if the customer&#8217;s name is "Tony Soprano". The function <code>mafiaSpecial()</code> is not visible from outside, but for insiders like <code>doTaxes()</code> it&#8217;s available. Here&#8217;s what the above code example will print on the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">Dear John Smith, your tax is 4500
Dear Tony Soprano, your tax is 4000
Uncaught ReferenceError: mafiaSpecial is not defined</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#FIG2-18">Closure view in Chrome&#8217;s Developer Tools.</a> shows the screenshot taken when <code>doTaxes()</code> hit the breakpoint inside <code>doTaxes</code> - note the right panel that shows what&#8217;s visible in the Closure scope.</p>
</div>
<div id="FIG2-18" class="imageblock">
<div class="content">
<img src="images/fig_02_18.jpg" alt="fig 02 18">
</div>
<div class="title">Figure 18. Closure view in Chrome&#8217;s Developer Tools.</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
JavaScript doesn&#8217;t give you an explicit way to mark an variable as private. By using closures you can get the same level of data hiding that you get from private variables in other languages. In the example above the variable <code>taxDeduction</code> is local for the object enclosed in the outermost parentheses and can&#8217;t be accessed from outside. But <code>taxDeduction</code> can be visible from the object&#8217;s functions <code>doTaxws</code> and <code>mafiaSpecial</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="#FIG2-19">Closure doTaxes</a> gives yet another visual representation of our above code sample. The self-invoked anonymous function is shown as a cloud that exposes only one thing to the rest of the world: the closure <code>doTaxes</code>.</p>
</div>
<div id="FIG2-19" class="imageblock">
<div class="content">
<img src="images/fig_02_19.jpg" alt="fig 02 19">
</div>
<div class="title">Figure 19. Closure doTaxes</div>
</div>
<div class="paragraph">
<p>Let&#8217;s consider a couple of more cases of returning a closure to the outside world so it can be invoked later. If the previous code sample was exposing the closure by using <code>this.taxes</code> notation, the next two examples will simply return the code of the closure using the <code>return</code> statement. The code below declares a constructor function <code>Person</code>, adds a function <code>doTaxes()</code> to its prototype, and finally creates two instances of the <code>Person</code> calling the method <code>doTaxes()</code> on each of them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">// Constructor function
function Person(name){

	this.name == name;

}

// Declaring a method that returns closure
Person.prototype.doTaxes== function(){

    var taxDeduction == 500;

      //private function
      function mafiaSpecial(income){
          return income*0.05 - taxDeduction*2;
      }

      //the code of this function is returned to the caller
      return function(income) {

      	var yourTax;

        if (this.name !== "Tony Soprano"){
          yourTax ==   income*0.05 - taxDeduction;
        } else{
          yourTax ==   mafiaSpecial(income);
        }

         console.log( "My dear " + this.name + ", your tax is "+ yourTax);
         return yourTax;
      }
}();     // important parentheses!

//Using closure
var p1 == new Person("John Smith");
var result1 == p1.doTaxes(100000);

var p2 == new Person("Tony Soprano");
var result2 == p2.doTaxes(100000);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The calculated taxes in this example are the same as in the previous one: John Smith has to pay $4500, while Tony Soprano only $4000. But we used different technique for exposing the closure. We want to make sure that you didn&#8217;t overlooked the parentheses at the very end of the function expression for <code>doTaxes</code>. These parenthesis force the anonymous function to self-invoke itself, it&#8217;ll run into a <code>return</code> statement and will assign the code of the anonymous inner function that takes parameter <code>income</code> to the property <code>doTaxes</code>. So when the line <code>var result1 == p1.doTaxes(100000);</code> calls the closure the variable <code>result1</code> will have the value 4500. Remove these important parentheses, and the value of <code>result1</code> is not the tax amount, but the the code of the closure itself - the invocation of the closure is not happening.</p>
</div>
<div class="paragraph">
<p>The following code fragment is yet another example of returning the closure that remembers its context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">function prepareTaxes(studentDeductionAmount) {

	return function (income) {           <i class="conum" data-value="1"></i><b>(1)</b>
	   return income*0.05 - studentDeductionAmount;
	};

}

var doTaxes == prepareTaxes(300);         <i class="conum" data-value="2"></i><b>(2)</b>
var yourTaxIs == doTaxes(10000);          <i class="conum" data-value="3"></i><b>(3)</b>
console.log("You tax is " + yourTaxIs);  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When the function prepareTaxes is called, it immediately hits the <code>return</code> statement and returns the code of the closure to the caller.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>After this line is executed, the variable <code>doTaxes</code> has the code of the closure, which remembers that <code>studentDeductionAmount</code> is equal to 300.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This is actual invocation of the closure</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>the console output is "your tax is 200"</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>First, the closure is returned to the caller of <code>prepareTaxes()</code>, and when the closure will be invoked it&#8217;ll remember the values defined in its outer context. After looking at this code you may say that there is nothing declared in the closure&#8217;s outside context! There is - by the time when the closure is created the value of the <code>studentDeductionAmount</code> will be known.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Check the quality of your code with the help of the JavaScript code quality tools like <a href="http://www.jslint.com/">JSLint</a> or <a href="http://www.jshint.com/">JSHint</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_closures_as_callbacks">Closures as callbacks</h4>
<div class="paragraph">
<p>Let&#8217;s revisit the code from the section Callbacks above. That code has shown how to pass an arbitrary function to another one and invoke it there using <code>call()</code>. But if that version of the function <code>taxHandler</code> was not aware of the context it was created in, the version below will. If in classical object-oriented languages you&#8217;d need to pass a method that knows about it&#8217;s context, you&#8217;d need to create an instance of an object that contains the method and the required object-level properties, and then you&#8217;d be passing this wrapper-object to another object for processing. But since the closure remembers its context anyway, we can just pass a closure as an object. Compare the code below with the code from the Callbacks section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var myTaxObject == {

    // this function takes an array and callback as parameters
    applyDeduction: function(someArray, someCallBackFunction){

        for (var i == 0; i &lt; someArray.length; i++){

            // Invoke the callback
           someCallBackFunction.call(this, someArray[i]);
        }

    }
}

// array
var preliminaryTaxes=[1000, 2000, 3000];


var taxHandler == function (taxDeduction){

// tax handler closure
	return function(currentTax){
                   console.log("Hello from callback. Your final tax is " +
                   (currentTax - taxDeduction));
                };
}


// invoking applyDeduction passing an array and callback-closure
myTaxObject.applyDeduction(preliminaryTaxes, taxHandler(200));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last line of the above example calls <code>taxHandler(200)</code>, which creates a closure that&#8217;s being passed as a callback to the method <code>applyDeduction()</code>. Even though this closure is executed in the context of <code>myTaxObject</code>, it remembers that tax deduction is 200.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mixins">Mixins</h3>
<div class="paragraph">
<p>The need to extend capabilities of objects can be fulfilled by inheritance, but this is not the only way of adding behavior to objects. In this section you&#8217;ll see an example of something that would not be possible in the object-oriented languages like Java or C#, which don&#8217;t support multiple inheritance. JavaScript allows taking a piece of code and <em>mix it into any object</em> regardless of what its inheritance chain is. <em>Mixin</em> is a reusable code fragment that an object can borrow without the need to use inheritance. We&#8217;ll illustrate this concept by example.</p>
</div>
<div class="paragraph">
<p>In the next code fragment we&#8217;ll define a function expression and will assign it to a variable named <code>Tax</code>. This is a closure that includes the function <code>calcTax()</code> that knows the values of <code>income</code> and <code>state</code>.  There is also an independent mixin <code>TaxMixin</code> with a couple of functions <code>mafiaSpecial()</code> and <code>drugCartelSpecial()</code>. We want to blend in this mixin into <code>Tax</code>. After this is is done, the Tax object will have its original functionality,i.e. <code>calcTax()</code>, as well as a new "mafia and drug cartel flavors":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">// Defining a function expession
var Tax == function(income, state){
	this.income=income;
	this.state=state;

	this.calcTax=function(){
		var tax=income*0.05;
		console.log("Your calculated tax is " + tax)
		return tax;
	}
};


// Defining a mixin
var TaxMixin == function () {};

TaxMixin.prototype == {

  mafiaSpecial: function(originalTax){
    console.log("Mafia special:" + (originalTax - 1000));
  },

  drugCartelSpecial: function(originalTax){
     console.log("Drug Cartel special:" + (originalTax - 3000));
  }

};

// this function can blend TaxMixin into Tax
function blend( mainDish, spices ) {

  for ( var methodName in spices.prototype ) {
      mainDish.prototype[methodName] == spices.prototype[methodName];
  }
}

// Blend the spices with the main dish
blend( Tax, TaxMixin );

// Create an instant of Tax
var t == new Tax(50000, "NY");

var rawTax == t.calcTax();

// invoke a freshly blended method
t.mafiaSpecial(rawTax);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The function <code>blend()</code> loops through the code of the <code>TaxMixin</code> and copies all its properties into <code>Tax</code>. After the function <code>blend()</code> is finished, you can call on the <code>Tax</code> instance newly acquired methods <code>mafiaSpecial()</code> and <code>drugCartelSpecial()</code>.</p>
</div>
<div class="paragraph">
<p>Mixins can be useful is you want to provide a specific feature to a number of different objects  without changing their inheritance chains. The other use case is if you want to prepare a bunch of small code fragments (think spices) and add any combination of them to the various objects (dishes) as needed. Mixins give you a lot of flexibility in what you can achieve with the minimum code, but they may decrease the readability of your code.</p>
</div>
<div class="paragraph">
<p>If you&#8217;ve read this far, you should have a good understanding of the syntax of the JavaScript language. Studying the code samples provided in this appendix has one extra benefit: now you can apply for a job as a tax accountant in a mafia near you.</p>
</div>
</div>
<div class="sect2">
<h3 id="_javascript_in_the_web_browser">JavaScript in the Web Browser</h3>
<div class="paragraph">
<p>After learning all these facts and techniques about the language you might be eager to see "the real-world use of JavaScript". Slowly but surely a Web browser becomes the leading platform for development of the user interface.  The vast majority today&#8217;s JavaScript programs primarily manipulate HTML elements of Web pages. In this section we&#8217;ll be doing exactly this – applying JavaScript code to modify the content or style of HTML elements.</p>
</div>
<div class="sect3">
<h4 id="_the_document_object_model_dom">The Document Object Model (DOM)</h4>
<div class="paragraph">
<p>DOM stands for Document Object Model. It&#8217;s an object representing the hierarchy of HTML elements of a  Web page. Every element of the HTML document is loaded into DOM. Each DOM element has a reference to its children and siblings. When DOM was invented, the Web pages were simple and static. DOM was not meant to be an object actively accessed by the code. This is the reason that on some of the heavily populated Web pages manipulating of DOM elements can be slow. Most likely DOM is the main target for anyone who&#8217;s trying to optimize the performance of a Web page.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
If your Web page is slow, analyze it with <a href="http://yslow.org/">YSlow</a>, the tool built based on the Yahoo! rules for high performance Web sites. Also, you can minimize and obfuscate your JavaScript code with the help of  <a href="http://javascriptcompressor.com/">JavaScript Compressor</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a Web Browser is receiving the content it  performs the following activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding arriving HTML elements to DOM and laying out the content of the Web pages</p>
</li>
<li>
<p>Rendering of the UI</p>
</li>
<li>
<p>Running JavaScript that was included in the HTML</p>
</li>
<li>
<p>Processing events</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The amount of time spent on each of these activities varies depending the content of the page.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are interested in learning how the browsers work in detail, read an excellent writeup titled "How Browsers Work: Behind The Scenes of Modern Web Browsers" at <a href="http://bit.ly/how-browsers-work">http://bit.ly/how-browsers-work</a>
[<a href="http://bit.ly/how-browsers-work">http://bit.ly/how-browsers-work</a>].
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the operations your application needs to be able to perform inside the Web page:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Programmatically finding the required element by id, type, or a CSS class</p>
</li>
<li>
<p>Changing styles of the elements (show, hide, apply fonts and colors et al.)</p>
</li>
<li>
<p>Processing events that may happen to HTML elements (<code>click</code>, <code>mouseover</code> and the like)</p>
</li>
<li>
<p>Dynamically adding or removing HTML elements from the page or changing their contents</p>
</li>
<li>
<p>Communicating with the server side, e.g. submitting forms or making AJAX requests for some data from the server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you&#8217;ll see some code samples illustrating the use of JavaScript for the operations listed above. Even if you’ll be using one of the popular JavaScript frameworks, your program will be performing similar operations applying the syntax prescribed by your framework of choice. So let&#8217;s learn how it can be done.</p>
</div>
</div>
<div class="sect3">
<h4 id="_working_with_dom">Working with DOM</h4>
<div class="paragraph">
<p>If you want to change the appearance of an HTML page, you need to manipulate with the DOM elements. Older Web applications were preparing the HTML content on the server side. For example, a server-side Java servlet would compose and send to the client HTML whenever the application logic required to change the appearance of the UI. The current trend is different - the client&#8217;s code takes care of the UI rendering, and only the data go back and forth between the client and the server. You&#8217;ll see how this works in more detail in Chapter 2 that explains the use of AJAX and JSON.</p>
</div>
<div class="paragraph">
<p>Earlier in this appendix we were talking about the global namespace where all JavaScript objects live unless they were declared with <code>var</code> inside the functions. If the JavaScript code is running in a Web browser, this global namespace is represented by a special variable <code>window</code>. It&#8217;s an implicit variable and you don&#8217;t have to use it in your code, but whenever we say that a variable is global, we mean that it&#8217;s exists on the <code>window</code> object. For example, the code below will print "123 Main Street" twice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">var address ="123 Main Street";

console.log(address);
console.log(window.address);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>window</code> object has a number of useful properties like <code>cookie</code>, <code>location</code>, <code>parent</code>, <code>document</code> and others.  The variable <code>document</code> points at the root of the DOM hierarchy. Pretty often your  JavaScript code would find an element in the DOM first, and then it could read or modify its content.
<a href="#FIG2-20">Firebug&#8217;s representation of DOM</a> is a snapshot from Firebug showing the fragment of a DOM of a simple Web page mixins.html.</p>
</div>
<div id="FIG2-20" class="imageblock">
<div class="content">
<img src="images/fig_02_20.jpg" alt="fig 02 20">
</div>
<div class="title">Figure 20. Firebug&#8217;s representation of DOM</div>
</div>
<div class="paragraph">
<p>Below are some of the methods that exist on the <code>document</code> object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>document.write(text)</code> – adds the specifies text to the DOM. Careless using of the method <code>write()</code> can result in unpredictable results if after changing the DOM the HTML content is still arriving.</p>
</li>
<li>
<p><code>document.getElementById(id)</code> – get a reference to the HTML element by its unique identifier</p>
</li>
<li>
<p><code>document.getElementsByTagName(tname)</code> - get a reference to one or more elements by tag names, e.g.get a reference to all <code>&lt;div&gt;</code> elements.</p>
</li>
<li>
<p><code>document.getElementsByName(name)</code> -  get a reference to all elements that have requested value in their <code>name</code> attribute.</p>
</li>
<li>
<p><code>document.getElementsByClassName(className)</code> – get a reference to all elements to use specified CSS class(es), like <code>document.getElementsByClassName('red text-left')</code>.</p>
</li>
<li>
<p><code>document.querySelector(cssSelector)</code> – Find the first element that matches provided CSS selector. string. It comes handy if you want to specify more complex queries that just a class name, e.g. <code>document.querySelector("style[type='text-left']");</code>.</p>
</li>
<li>
<p><code>document.querySelectorAll(cssSelector)</code> – Find all elements that match provided CSS selector string.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next code sample contains the HTML <code>&lt;span&gt;</code> element that has an id <code>emp</code>. Initially it contains ellipsis, but when the user enters the name in the input text field, the JavaScript code will find the reference to this <code>&lt;span&gt;</code> element and will replace the ellipsis with the content of the input text field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

	&lt;body&gt;
        &lt;h2&gt;Selecting DOM elements&lt;/h2&gt;

        &lt;p&gt;
        	The employee of the month is &lt;span id="emp"&gt;...&lt;/span&gt;
        &lt;br&gt;
        &lt;input type="button" value="Change the span value"
               onclick="setEmployeeOfTheMonth()"/&gt;
        Enter your name  &lt;input type="text" id="theName" /&gt;
        &lt;/p&gt;

        &lt;script&gt;
           function setEmployeeOfTheMonth(){

        	   var mySpan == document.getElementById("emp");

        	   var empName== document.getElementsByTagName("input")[1];

        	   mySpan.firstChild.nodeValue== empName.value;

        	}
        &lt;/script&gt;

	&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the input field of type <code>button</code>, which includes the <code>onclick</code> property that corresponds to the <code>click</code> event. When the user clicks on the button, the browser dispatched <code>click</code> event, and calls the JavaScript function <code>setEmployeeOfTheMonth()</code>. The latter queries the DOM and finds the reference to the  <code>emp</code> by calling the method <code>getElementBuId()</code>. After that, the method <code>getElementByTagName()</code> is called trying to find all the references to the HTML <code>&lt;input&gt;</code> elements. This methods returns an array cause there could be more than one element with the same tag name on a page, which explains the use of array notation. The first <code>&lt;input&gt;</code> element is a button and the second is the text field we&#8217;re interested in. Remember that arrays in JavaScript have zero-based indexes. <a href="#FIG2-21">Changing the content of the HTML &lt;span&gt; element</a> shows the Web page after the user entered the name <em>Mary</em> and pressed the button.</p>
</div>
<div id="FIG2-21" class="imageblock">
<div class="content">
<img src="images/fig_02_21.jpg" alt="fig 02 21">
</div>
<div class="title">Figure 21. Changing the content of the HTML &lt;span&gt; element</div>
</div>
<div class="paragraph">
<p>While manipulating the content of your Web page you may you may need to traverse the DOM tree. The code example below shows you an HTML document that includes JavaScript that walks the DOM and prints the name of each node. If a node has children, the recursive function <code>walkTheDOM()</code> will visit each child.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

    &lt;body&gt;
     &lt;h1&gt;WalkTheDom.html&lt;/h1&gt;

     &lt;p&gt;
        Enter your name: &lt;input type="text"
                                name="customerName" id="custName" /&gt;
     &lt;/p&gt;

     &lt;input type="button" value="Walk the DOM"
                          onclick="walkTheDOM(document.body, processNode)"/&gt;

     &lt;script&gt;
        	function walkTheDOM(node, processNode){

                   processNode(node)
                    node == node.firstChild;

			      while(node){
			         // call wakTheDOM recursively for each child
			         walkTheDOM(node,processNode);
			         node == node.nextSibling;
			      }
            }

         function processNode(node){
            // the real code for node processing goes here

        	console.log("The current node name is "+  node.nodeName);
         }
      &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our function <code>processNode()</code> just prints the name of the current node, but you could implement any code that your Web application requires.  Run this code in different browsers and check the output on the JavaScript console. <a href="#FIG2-22">Traversing the DOM in Firefox</a> depicts two snapshots taken in the F12 Developer Tools in Internet Explorer (left) and FIrebug running in Firefox (right).</p>
</div>
<div id="FIG2-22" class="imageblock">
<div class="content">
<img src="images/fig_02_22.jpg" alt="fig 02 22">
</div>
<div class="title">Figure 22. Traversing the DOM in Firefox</div>
</div>
<div class="paragraph">
<p>While some of the output is self-explanatory, there is a number of <code>#text</code> nodes that you won&#8217;t find in the code sample above. Unfortunately, Web browsers treat white-spaces in differently - some will ignore them, while others will report them as DOM elements. Accordingly, different browsers insert different number of text nodes in the DOM representing whitespaces found in the HTML document. So you&#8217;ll be better off using one of the JavaScript frameworks for traversing the DOM cross-browser way. For example, JQuery framework&#8217;s API for DOM traversing is listed at <a href="http://bit.ly/WXj2r2">http://bit.ly/WXj2r2</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Styling Web Pages with CSS</div>
<div class="paragraph">
<p>CSS stands for Cascading Style Sheets. During the last 15 years several CSS specifications reached the level of Recommendation by W3C: CSS Level 1, 2, and 2.1. The latest CSS Level 3 (a.k.a. CSS3) adds new features to CSS 2.1 module by module, which are listed at
<a href="http://www.w3.org/Style/CSS/current-work">http://www.w3.org/Style/CSS/current-work</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You can find CSS tutorial as well as tons of other learning resources at <a href="http://www.webplatform.org/">webplatform.org</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can include CSS into a Web page by linking to separate files using the HTML tag <code>&lt;link&gt;</code>, or by in-lining the styles with the tag <code>&lt;style&gt;</code>, or using the <code>style</code> attribute in HTML element (not recommended). For example, if CSS is located in the file <code>mystyles.css</code> in
the folder css add the following tag to HTML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">&lt;link rel="stylesheet" type="text/css" href="css/mystyles.css" media="all"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>&lt;link&gt;</code> tag allows specifying the media where specific css file has to be used. For example, you can have one CSS file for smartphones and another one for tablets. We’ll discuss this in detail in the section on media queries in Chapter 9.</p>
</div>
<div class="paragraph">
<p>You should put this tag in the section of your HTML before any JavaScript code to make sure that they
stiles are loaded before the content of the Web page.</p>
</div>
<div class="paragraph">
<p>Placing the <code>@import</code> attribute inside the <code>&lt;style&gt;</code> tag allows to include styles located elsewhere:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">&lt;style&gt;
   @import url (css/contactus.css)
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>What’s the best way of including CSS in HTML? We recommend using CSS files. Keeping CSS in files separately from HTML and JavaScript makes the code more readable and reusable. You may argue that if your Web site consists of many files, the Web browser will have to make multiple round trips to your server just to load all resources required by the HTML document, which can worsen the responsiveness of your Web application. But usually all files are merged into one before deploying Web application in QA or production servers.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>HTML documents are often prettyfied by using CSS class selectors, and you can switch them  programmatically with JavaScript.  Imagine that a <code>&lt;style&gt;</code> section has the following definition of two class selectors <code>badStyle</code> and <code>niceStile</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="css language-css">   &lt;style&gt;
   	 .badStyle{
      	font-family: Verdana;
      	font-size:small;
      	color:navy;
      	background-color:red;
    }

    .niceStyle{
      	font-family: Verdana;
      	font-size:large;
      	font-style:italic;
      	color:gray;
      	background-color:green;
    }
  &lt;/style&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any of these class selectors can be used by one or more HTML elements, for example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">&lt;div id="header" class="badStyle"&gt;
   &lt;h1&gt;This is my header&lt;/h1&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Imagine that some important event has happened and the appearance the <code>&lt;div&gt;</code> styled as <code>badStyle</code> should programmatically change to &lt;niceStyle&gt;. In this case we need to find the <code>badStyle</code> element(s) first and change their style. The method <code>getElementsByClassName()</code> returns a set of elements that have the specified class name, and since our HTML has only one such element, the JavaScript will use the element zero from such set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">   	  document.getElementsByClassName("badStyle")[0].className="niceStyle";</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next example will illustrate adding a new element to the DOM. On click of a button the code below dynamically creates an instance of type <code>img</code> and then assigns the location of the image to its <code>src</code> element. In a similar way we could have assigned values to any other attributes of the <code>img</code> element like <code>width</code>, <code>height</code>, or <code>alt</code>. The method <code>appendChild()</code> is applied to the &lt;body&gt; container, but it could be any other container that exists on the DOM.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

    &lt;body&gt;
     &lt;h2&gt;Employee of the month&lt;/h2&gt;
        &lt;p&gt;
             &lt;input type="button" value="Show me"
                    onclick="setEmployeeOfTheMonth()"/&gt;
        &lt;/p&gt;

     &lt;script&gt;

         function setEmployeeOfTheMonth(){

           // Create an image and add it to the &lt;body&gt; element
           var empImage=document.createElement("img");
        	   empImage.setAttribute('src','resources/images/employee.jpg');
        	   document.body.appendChild(empImage);
        	}

     &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Some HTML elements like <code>&lt;div&gt;</code> or &lt;span&gt;  contain other elements (children), and if you need to change their content use their property <code>innerHTML</code>. For example, to delete the entire content of the document body just do this: <code>document.body.innerHTML=""</code>. You can also use the method <code>appendChild()</code> as shown in the code sample above.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you run this example and click on the button "Show me" you&#8217;ll see an image of the employee of the month added to the <code>&lt;body&gt;</code> section of the HTML document as shown on <a href="#FIG2-23">After clicking the button "Show me"</a>.</p>
</div>
<div id="FIG2-23" class="imageblock">
<div class="content">
<img src="images/fig_02_23.jpg" alt="fig 02 23">
</div>
<div class="title">Figure 23. After clicking the button "Show me"</div>
</div>
</div>
<div class="sect3">
<h4 id="_dom_events">DOM Events</h4>
<div class="paragraph">
<p>Web browser will  notify your application when some changes or interactions occur. In such cases the browser will dispatch an appropriate event, for example <code>load</code>, <code>unload</code>, <code>mousemove</code>, <code>click</code>, <code>keydown</code> etc. When the Web page finished loading the browser will dispatch the <code>load</code> event. When the user will click on the button on a Web page the <code>click</code> event will be dispatched. A Web developer needs to provide JavaScript code that will react on the events important to the application. The browser events will occur regardless of if you provided the code to handle them or not. It&#8217;s important to understand some terms related to event processing.</p>
</div>
<div class="paragraph">
<p>An <em>event handler (a.k.a. event listener)</em> is a JavaScript code you want to be called as a response to this event. The last code sample from the previous section was processing the <code>click</code> event on the button "Show me" as follows: <code>onclick="setEmployeeOfTheMonth()"</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Each HTML element has a certain number of predefined <em>event attributes</em>, which start with the prefix <code>on</code> followed by the name of the event. For example <code>onclick</code> is an event attribute that you can use for specifying the handler for the <code>click</code> event. You can find out what event attributes are available in the online document titled <a href="http://www.w3.org/TR/DOM-Level-3-Events//">Document Object Model Events</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The preferred way of adding event listener was introduced in the DOM Level 2 specification back in 2000. You should find the HTML element in the DOM, and then assign the event listener to it by calling the method <code>addEventListener()</code> (this is done differently in Internet Explorer below version 9).  For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">document.getElementById("myButton").addEventListener("click", setEmployeeOfTheMonth);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The advantage of using of such programmatic assignment of event listeners is that this can be done for all controls in a in a central place, for example in a JavaScript function that runs immediately after the Web page completes loading. Another advantage is that you can programmatically remove the event listener if it&#8217;s not needed any longer by invoking <code>removeEventListener()</code>. The following example is a re-write of the last example from the previous section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

    &lt;body&gt;
     &lt;h2&gt;Employee of the month&lt;/h2&gt;
        &lt;p&gt;
             &lt;input type="button" value="Show me" id="myButton"/&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/p&gt;

     &lt;script&gt;
         window.onload=function(){         <i class="conum" data-value="2"></i><b>(2)</b>
         	document.getElementById("myButton").addEventListener("click",
           	                                      setEmployeeOfTheMonth);
         }

         function setEmployeeOfTheMonth(){

           // Create an image and add it to the &lt;body&gt; element
           var empImage=document.createElement("img");
        	   empImage.setAttribute('src','resources/images/employee.jpg');
        	   document.body.appendChild(empImage);

        	 document.getElementById("myButton").removeEventListener("click",
           	                                 setEmployeeOfTheMonth); <i class="conum" data-value="3"></i><b>(3)</b>
        	}

     &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Compare this button with the one from the previous section: the event handler is removed, but it has an ID now.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When the Web page completes loading, a <code>load</code> event is dispatched and the function attached to the event attribute <code>onload</code> assigns the event handler for the button <em>click</em> event. Note that we are passing the callback <code>setEmployeeOfTheMonth</code> as the second argument of the <code>addEventListener()</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Removing the event listener after the image of the employee of the month has been added. Without this line each click on the button would add to the Web page yet another copy of the same image.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each event goes through three different phases: <em>Capture, Target, and Bubble</em>. It&#8217;s easier to explain this concept by example. Imagine that a button is located inside the <code>&lt;div&gt;</code>, which is located inside the <code>&lt;body&gt;</code> container. When you click on the button, the event travels to the button through all enclosing containers, and this is the capture phase. You can intercept the event at one of these containers even before it reached the button if need be. For example, your application logic may need to prevent the button from being clicked if certain condition occurs.</p>
</div>
<div class="paragraph">
<p>Then event reaches the button, and it&#8217;s a target phase. After the event is handled by the button&#8217;s <code>click</code> handler, the event bubbles up through the enclosing containers, and this is the bubble phase. you can create listeners and handle this event after the button finished its processing at the target phase. The next code sample is based on the previous one, but it demonstrates the event processing in all three phases.</p>
</div>
<div class="paragraph">
<p>Note that if your event handler function is declared with the event parameter, it&#8217;ll receive the <code>Event</code> object (not in IE 8), which contains a number of useful parameters. For more information refer to the "Document Object Model Events" online.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="javascript language-javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8" /&gt;
	&lt;/head&gt;

    &lt;body&gt;
     &lt;h2&gt;Employee of the month&lt;/h2&gt;
        &lt;div id="myDiv"&gt;
             &lt;input type="button" value="Show me" id="myButton"/&gt;
        &lt;/div&gt;

     &lt;script&gt;
         window.onload=function(){
         	document.getElementById("myButton").addEventListener("click",
           	                                          setEmployeeOfTheMonth);

        	document.getElementById("myDiv").addEventListener("click",
           	                                          processDivBefore, true); <i class="conum" data-value="1"></i><b>(1)</b>
        	document.getElementById("myButton").addEventListener("click",
           	                                          processDivAfter);

         }

         function setEmployeeOfTheMonth(){

           console.log("Got the click event in target phase");

           // Create an image and add it to the &lt;body&gt; element
           var empImage=document.createElement("img");
        	   empImage.setAttribute('src','resources/images/employee.jpg');
        	   document.body.appendChild(empImage);

        	 document.getElementById("myButton").removeEventListener("click",
           	                                              setEmployeeOfTheMonth);
        	}

         function processDivBefore(evt){
         	console.log("Intercepted the click event in capture phase");

         	// Cancel the click event so the button won't get it

         	// if (evt.preventDefault) evt.preventDefault();        <i class="conum" data-value="2"></i><b>(2)</b>
         	// if (evt.stopPropagation) evt.stopPropagation();
         }

         function processDivAfter(){
         	console.log("Got the click event in bubble phase");
         }
     &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We&#8217;ve added two event handler on the <code>&lt;div&gt;</code> level. The first one intercepts the event on the capture phase. When the third argument of <code>addEventListener()</code> is true, this handler will kick in during capture phase.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If you uncomment these two lines, the default behavior if the <code>click</code> event will be cancelled and it won&#8217;t reach the button at all. Unfortunately, browsers may have different method implementing <em>prevent default</em> functionality hence additional if-statements are needed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Running the above example will cause the following output in the JavaScript console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="html language-html">Intercepted the click event in capture phase
Got the click event in target phase
Got the click event in bubble phase</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see another example of using intercepting the event during the capture phase in the Donate Section of Chapter 2.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
The Microsoft&#8217;s Web browsers Internet Explorer 8 and below didn&#8217;t implement the W3C DOM Level 3 event model -  they handled events differently. You can read more on the subject at this MSDN article <a href="http://blogs.msdn.com/b/ie/archive/2010/03/26/dom-level-3-events-support-in-ie9.aspx">http://bit.ly/anZZgZ</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_summary">Summary</h3>
<div class="paragraph">
<p>This appendix covered the JavaScript language constructs that any professional Web developer should know. A smaller portion of this chapter was illustrating how to combine JavaScript, HTML, and CSS. There are lots of online resources and books that cover just the HTML markup and CSS, and you&#8217;ll definitely need to spend more time mastering details of the Web tools like Firebug or Google Developer Tools.</p>
</div>
<div class="paragraph">
<p>Software developers who are coming from strongly-typed compiled languages may have a feeling that their productivity drops with JavaScript. We can recommend several medications for this. FIrst, get familiar with the language called CoffeeScript. As a respected Java developer James Ward put it, "CoffeeScript is <em>the</em> way to write JavaScript". This language is very similar to JavaScript and is very easy to learn if you understand the JavaScript syntax, it supports classes and is compiled into JavaScript. Visit <a href="http://coffeescript.org/">coffescript.org</a> to see the CoffeeScript code snippets and their equivalents in JavaScript.</p>
</div>
<div class="paragraph">
<p>Another interesting language to learn is Microsoft&#8217;s TypeScript (it&#8217;s an open source project). This language is also an extension of JavaScript with added classes, interfaces and inheritance. If also gets compiled into JavaScript and allows developers write strongly-typed code. TypeScript increases productivity of developers because it helps identify lots of error related with incorrect types during the compilation phase.  TypeScript implements many constructs from EcmaScript 6 and can be serve as an example of the JavaScript of the future.</p>
</div>
<div class="paragraph">
<p>Probably the most interesting new programming language is Google&#8217;s <a href="http://www.dartlang.org/">Dart</a>. This is a compiled language with all object-oriented features - classes, objects, abstract classes, inheritance. The compiled code runs inside the VM, and Google supports it in Chrome browser. What about the other browsers? The Web application is deployed as a script that automatically checks if the the browser supports Dart. If it does, the compiled code will be sent to the client, otherwise the Dart code will be automatically compiled into JavaScript, and from the browser perspective nothing but a JavaScrpit engine is required. You can do a server-side programming in Dart too.
JetBrains' WebStorm, our IDE of choice, supports Coffeescript, Dart, and Typescript.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2013-12-04 18:44:33 EST
</div>
</div>
</body>
</html>